!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("SNLibrary",[],t):"object"==typeof exports?exports.SNLibrary=t():e.SNLibrary=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=214)}([function(e,t,n){var r=n(23),o=n(159);e.exports=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,a=[],s=e.length;for(t=r(t,3);++i<s;){var u=e[i];t(u,i,e)&&(n.push(u),a.push(i))}return o(e,a),n}},function(e,t,n){var r=n(86)(n(201));e.exports=r},function(e,t,n){var r=n(95)(n(156));e.exports=r},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){"use strict";(function(e){function r(){return"undefined"!=typeof window?window:void 0!==e?e:null}function o(){return"undefined"!=typeof document}function i(){return"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function a(e,t,n){return e.find((function(e){return e[t]===n}))}n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}))}).call(this,n(56))},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){var t=n(e);return null!=e&&("object"==t||"function"==t)}},function(e,t,n){(function(e){var n,r,o,i;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window,i=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==a(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=36)}([function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(){var e=e||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},u=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i),u=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,c=e.min(4*u,o);if(u){for(var l=0;l<u;l+=i)this._doProcessBlock(r,l);var f=r.splice(0,u);n.sigBytes-=c}return new a.init(f,c)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(o.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math);return e},"object"===u(t)?e.exports=t=s():(o=[],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){e.lib.Cipher||function(t){var n=e,r=n.lib,o=r.Base,i=r.WordArray,a=r.BufferedBlockAlgorithm,s=n.enc,u=(s.Utf8,s.Base64),c=n.algo.EvpKDF,l=r.Cipher=a.extend({cfg:o.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?b:m}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()}),f=(r.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),n.mode={}),p=r.BlockCipherMode=o.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),y=f.CBC=function(){var e=p.extend();function n(e,n,r){var o=this._iv;if(o){var i=o;this._iv=t}else i=this._prevBlock;for(var a=0;a<r;a++)e[n+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize;n.call(this,e,t,o),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+o)}}),e.Decryptor=e.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize,i=e.slice(t,t+o);r.decryptBlock(e,t),n.call(this,e,t,o),this._prevBlock=i}}),e}(),h=(n.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,a=[],s=0;s<r;s+=4)a.push(o);var u=i.create(a,r);e.concat(u)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},d=(r.BlockCipher=l.extend({cfg:l.cfg.extend({mode:y,padding:h}),reset:function(){l.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else r=n.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),r.CipherParams=o.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=i.create([1398893684,1701076831]).concat(n).concat(t);else r=t;return r.toString(u)},parse:function(e){var t=u.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=i.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return d.create({ciphertext:t,salt:r})}},m=r.SerializableCipher=o.extend({cfg:o.extend({format:v}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),a=o.cfg;return d.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),g=(n.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=i.random(8));var o=c.create({keySize:t+n}).compute(e,r),a=i.create(o.words.slice(t),4*n);return o.sigBytes=4*t,d.create({key:o,iv:a,salt:r})}},b=r.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:g}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=m.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=o.iv,m.decrypt.call(this,e,t,o.key,r)}})}()},"object"===u(t)?e.exports=t=s(n(0),n(2)):(o=[n(0),n(2)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r,o,i,a,s;return r=(n=(t=e).lib).Base,o=n.WordArray,a=(i=t.algo).MD5,s=i.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),i=o.create(),a=i.words,s=n.keySize,u=n.iterations;a.length<s;){c&&r.update(c);var c=r.update(e).finalize(t);r.reset();for(var l=1;l<u;l++)c=r.finalize(c),r.reset();i.concat(c)}return i.sigBytes=4*s,i}}),t.EvpKDF=function(e,t,n){return s.create(n).compute(e,t)},e.EvpKDF},"object"===u(t)?e.exports=t=s(n(0),n(7),n(8)):(o=[n(0),n(7),n(8)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n;return n=(t=e).lib.WordArray,t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var a=r.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,r){for(var o=[],i=0,a=0;a<t;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,u=r[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=(s|u)<<24-i%4*8,i++}return n.create(o,i)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},e.enc.Base64},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(t){var n=e,r=n.lib,o=r.WordArray,i=r.Hasher,a=n.algo,s=[];!function(){for(var e=0;e<64;e++)s[e]=4294967296*t.abs(t.sin(e+1))|0}();var u=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],u=e[t+1],y=e[t+2],h=e[t+3],d=e[t+4],v=e[t+5],m=e[t+6],g=e[t+7],b=e[t+8],x=e[t+9],S=e[t+10],k=e[t+11],w=e[t+12],_=e[t+13],R=e[t+14],I=e[t+15],O=i[0],C=i[1],A=i[2],D=i[3];O=c(O,C,A,D,a,7,s[0]),D=c(D,O,C,A,u,12,s[1]),A=c(A,D,O,C,y,17,s[2]),C=c(C,A,D,O,h,22,s[3]),O=c(O,C,A,D,d,7,s[4]),D=c(D,O,C,A,v,12,s[5]),A=c(A,D,O,C,m,17,s[6]),C=c(C,A,D,O,g,22,s[7]),O=c(O,C,A,D,b,7,s[8]),D=c(D,O,C,A,x,12,s[9]),A=c(A,D,O,C,S,17,s[10]),C=c(C,A,D,O,k,22,s[11]),O=c(O,C,A,D,w,7,s[12]),D=c(D,O,C,A,_,12,s[13]),A=c(A,D,O,C,R,17,s[14]),O=l(O,C=c(C,A,D,O,I,22,s[15]),A,D,u,5,s[16]),D=l(D,O,C,A,m,9,s[17]),A=l(A,D,O,C,k,14,s[18]),C=l(C,A,D,O,a,20,s[19]),O=l(O,C,A,D,v,5,s[20]),D=l(D,O,C,A,S,9,s[21]),A=l(A,D,O,C,I,14,s[22]),C=l(C,A,D,O,d,20,s[23]),O=l(O,C,A,D,x,5,s[24]),D=l(D,O,C,A,R,9,s[25]),A=l(A,D,O,C,h,14,s[26]),C=l(C,A,D,O,b,20,s[27]),O=l(O,C,A,D,_,5,s[28]),D=l(D,O,C,A,y,9,s[29]),A=l(A,D,O,C,g,14,s[30]),O=f(O,C=l(C,A,D,O,w,20,s[31]),A,D,v,4,s[32]),D=f(D,O,C,A,b,11,s[33]),A=f(A,D,O,C,k,16,s[34]),C=f(C,A,D,O,R,23,s[35]),O=f(O,C,A,D,u,4,s[36]),D=f(D,O,C,A,d,11,s[37]),A=f(A,D,O,C,g,16,s[38]),C=f(C,A,D,O,S,23,s[39]),O=f(O,C,A,D,_,4,s[40]),D=f(D,O,C,A,a,11,s[41]),A=f(A,D,O,C,h,16,s[42]),C=f(C,A,D,O,m,23,s[43]),O=f(O,C,A,D,x,4,s[44]),D=f(D,O,C,A,w,11,s[45]),A=f(A,D,O,C,I,16,s[46]),O=p(O,C=f(C,A,D,O,y,23,s[47]),A,D,a,6,s[48]),D=p(D,O,C,A,g,10,s[49]),A=p(A,D,O,C,R,15,s[50]),C=p(C,A,D,O,v,21,s[51]),O=p(O,C,A,D,w,6,s[52]),D=p(D,O,C,A,h,10,s[53]),A=p(A,D,O,C,S,15,s[54]),C=p(C,A,D,O,u,21,s[55]),O=p(O,C,A,D,b,6,s[56]),D=p(D,O,C,A,I,10,s[57]),A=p(A,D,O,C,m,15,s[58]),C=p(C,A,D,O,_,21,s[59]),O=p(O,C,A,D,d,6,s[60]),D=p(D,O,C,A,k,10,s[61]),A=p(A,D,O,C,y,15,s[62]),C=p(C,A,D,O,x,21,s[63]),i[0]=i[0]+O|0,i[1]=i[1]+C|0,i[2]=i[2]+A|0,i[3]=i[3]+D|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;n[o>>>5]|=128<<24-o%32;var i=t.floor(r/4294967296),a=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,u=s.words,c=0;c<4;c++){var l=u[c];u[c]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,r,o,i,a){var s=e+(t&n|~t&r)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,n,r,o,i,a){var s=e+(t&r|n&~r)+o+a;return(s<<i|s>>>32-i)+t}function f(e,t,n,r,o,i,a){var s=e+(t^n^r)+o+a;return(s<<i|s>>>32-i)+t}function p(e,t,n,r,o,i,a){var s=e+(n^(t|~r))+o+a;return(s<<i|s>>>32-i)+t}n.MD5=i._createHelper(u),n.HmacMD5=i._createHmacHelper(u)}(Math),e.MD5},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){"use strict";(function(e){function r(){return"undefined"!=typeof window?window:void 0!==e?e:null}function o(){return!("undefined"!=typeof document&&document.documentMode||/Edge/.test(navigator.userAgent))&&r().crypto&&r().crypto.subtle}function i(){return r().crypto?r().crypto.subtle:null}function a(){var e=r(),t=e.crypto||e.msCrypto;if(t){var n=new Uint32Array(4);t.getRandomValues(n);var o=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){o++;var t=n[o>>3]>>o%8*4&15;return("x"==e?t:3&t|8).toString(16)}))}var i=(new Date).getTime();return e.performance&&"function"==typeof e.performance.now&&(i+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"==e?t:3&t|8).toString(16)}))}n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}))}).call(this,n(35))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r,o,i;return n=(t=e).lib,r=n.Base,o=n.WordArray,(i=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),i.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return o.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}}),e},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r,o,i,a,s;return n=(t=e).lib,r=n.WordArray,o=n.Hasher,i=t.algo,a=[],s=i.SHA1=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],u=n[4],c=0;c<80;c++){if(c<16)a[c]=0|e[t+c];else{var l=a[c-3]^a[c-8]^a[c-14]^a[c-16];a[c]=l<<1|l>>>31}var f=(r<<5|r>>>27)+u+a[c];f+=c<20?1518500249+(o&i|~o&s):c<40?1859775393+(o^i^s):c<60?(o&i|o&s|i&s)-1894007588:(o^i^s)-899497514,u=s,s=i,i=o<<30|o>>>2,o=r,r=f}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA1=o._createHelper(s),t.HmacSHA1=o._createHmacHelper(s),e.SHA1},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r;n=(t=e).lib.Base,r=t.enc.Utf8,t.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,o=4*n;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,u=a.words,c=0;c<n;c++)s[c]^=1549556828,u[c]^=909522486;i.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(t){var n=e,r=n.lib,o=r.WordArray,i=r.Hasher,a=n.algo,s=[],u=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)e(r)&&(o<8&&(s[o]=n(t.pow(r,.5))),u[o]=n(t.pow(r,1/3)),o++),r++}();var c=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],f=n[6],p=n[7],y=0;y<64;y++){if(y<16)c[y]=0|e[t+y];else{var h=c[y-15],d=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[y-2],m=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[y]=d+c[y-7]+m+c[y-16]}var g=r&o^r&i^o&i,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),x=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&f)+u[y]+c[y];p=f,f=l,l=s,s=a+x|0,a=i,i=o,o=r,r=x+(b+g)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+f|0,n[7]=n[7]+p|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=t.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=i._createHelper(l),n.HmacSHA256=i._createHmacHelper(l)}(Math),e.SHA256},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib.Hasher,r=t.x64,o=r.Word,i=r.WordArray,a=t.algo;function s(){return o.create.apply(o,arguments)}var u=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var l=a.SHA512=n.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],f=n[6],p=n[7],y=r.high,h=r.low,d=o.high,v=o.low,m=i.high,g=i.low,b=a.high,x=a.low,S=s.high,k=s.low,w=l.high,_=l.low,R=f.high,I=f.low,O=p.high,C=p.low,A=y,D=h,M=d,j=v,P=m,T=g,E=b,F=x,B=S,H=k,L=w,N=_,U=R,K=I,z=O,W=C,q=0;q<80;q++){var J=c[q];if(q<16)var V=J.high=0|e[t+2*q],$=J.low=0|e[t+2*q+1];else{var X=c[q-15],G=X.high,Q=X.low,Y=(G>>>1|Q<<31)^(G>>>8|Q<<24)^G>>>7,Z=(Q>>>1|G<<31)^(Q>>>8|G<<24)^(Q>>>7|G<<25),ee=c[q-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[q-7],ae=ie.high,se=ie.low,ue=c[q-16],ce=ue.high,le=ue.low;V=(V=(V=Y+ae+(($=Z+se)>>>0<Z>>>0?1:0))+re+(($+=oe)>>>0<oe>>>0?1:0))+ce+(($+=le)>>>0<le>>>0?1:0),J.high=V,J.low=$}var fe,pe=B&L^~B&U,ye=H&N^~H&K,he=A&M^A&P^M&P,de=D&j^D&T^j&T,ve=(A>>>28|D<<4)^(A<<30|D>>>2)^(A<<25|D>>>7),me=(D>>>28|A<<4)^(D<<30|A>>>2)^(D<<25|A>>>7),ge=(B>>>14|H<<18)^(B>>>18|H<<14)^(B<<23|H>>>9),be=(H>>>14|B<<18)^(H>>>18|B<<14)^(H<<23|B>>>9),xe=u[q],Se=xe.high,ke=xe.low,we=z+ge+((fe=W+be)>>>0<W>>>0?1:0),_e=me+de;z=U,W=K,U=L,K=N,L=B,N=H,B=E+(we=(we=(we=we+pe+((fe+=ye)>>>0<ye>>>0?1:0))+Se+((fe+=ke)>>>0<ke>>>0?1:0))+V+((fe+=$)>>>0<$>>>0?1:0))+((H=F+fe|0)>>>0<F>>>0?1:0)|0,E=P,F=T,P=M,T=j,M=A,j=D,A=we+(ve+he+(_e>>>0<me>>>0?1:0))+((D=fe+_e|0)>>>0<fe>>>0?1:0)|0}h=r.low=h+D,r.high=y+A+(h>>>0<D>>>0?1:0),v=o.low=v+j,o.high=d+M+(v>>>0<j>>>0?1:0),g=i.low=g+T,i.high=m+P+(g>>>0<T>>>0?1:0),x=a.low=x+F,a.high=b+E+(x>>>0<F>>>0?1:0),k=s.low=k+H,s.high=S+B+(k>>>0<H>>>0?1:0),_=l.low=_+N,l.high=w+L+(_>>>0<N>>>0?1:0),I=f.low=I+K,f.high=R+U+(I>>>0<K>>>0?1:0),C=p.low=C+W,p.high=O+z+(C>>>0<W>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=n._createHelper(l),t.HmacSHA512=n._createHmacHelper(l)}(),e.SHA512},"object"===u(t)?e.exports=t=s(n(0),n(6)):(o=[n(0),n(6)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e},"object"===u(t)?e.exports=t=s(n(0),n(6),n(12),n(13),n(3),n(4),n(7),n(9),n(14),n(10),n(15),n(16),n(17),n(8),n(18),n(2),n(1),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34)):(o=[n(0),n(6),n(12),n(13),n(3),n(4),n(7),n(9),n(14),n(10),n(15),n(16),n(17),n(8),n(18),n(2),n(1),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,n=t.init;(t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,r=[],o=0;o<t;o++)r[o>>>2]|=e[o]<<24-o%4*8;n.call(this,r,t)}else n.apply(this,arguments)}).prototype=t}}(),e.lib.WordArray},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib.WordArray,r=t.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,r=[],o=0;o<t;o++)r[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return n.create(r,2*t)}},r.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return n.create(r,2*t)}}}(),e.enc.Utf16},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r,o,i;return n=(t=e).lib.WordArray,r=t.algo,o=r.SHA256,i=r.SHA224=o.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=4,e}}),t.SHA224=o._createHelper(i),t.HmacSHA224=o._createHmacHelper(i),e.SHA224},"object"===u(t)?e.exports=t=s(n(0),n(9)):(o=[n(0),n(9)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r,o,i,a,s;return n=(t=e).x64,r=n.Word,o=n.WordArray,i=t.algo,a=i.SHA512,s=i.SHA384=a.extend({_doReset:function(){this._hash=new o.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=16,e}}),t.SHA384=a._createHelper(s),t.HmacSHA384=a._createHmacHelper(s),e.SHA384},"object"===u(t)?e.exports=t=s(n(0),n(6),n(10)):(o=[n(0),n(6),n(10)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(t){var n=e,r=n.lib,o=r.WordArray,i=r.Hasher,a=n.x64.Word,s=n.algo,u=[],c=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){u[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,i=0;i<24;i++){for(var s=0,f=0,p=0;p<7;p++){if(1&o){var y=(1<<p)-1;y<32?f^=1<<y:s^=1<<y-32}128&o?o=o<<1^113:o<<=1}l[i]=a.create(s,f)}}();var f=[];!function(){for(var e=0;e<25;e++)f[e]=a.create()}();var p=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,o=0;o<r;o++){var i=e[t+2*o],a=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(C=n[o]).high^=a,C.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var y=0,h=0,d=0;d<5;d++)y^=(C=n[p+5*d]).high,h^=C.low;var v=f[p];v.high=y,v.low=h}for(p=0;p<5;p++){var m=f[(p+4)%5],g=f[(p+1)%5],b=g.high,x=g.low;for(y=m.high^(b<<1|x>>>31),h=m.low^(x<<1|b>>>31),d=0;d<5;d++)(C=n[p+5*d]).high^=y,C.low^=h}for(var S=1;S<25;S++){var k=(C=n[S]).high,w=C.low,_=u[S];_<32?(y=k<<_|w>>>32-_,h=w<<_|k>>>32-_):(y=w<<_-32|k>>>64-_,h=k<<_-32|w>>>64-_);var R=f[c[S]];R.high=y,R.low=h}var I=f[0],O=n[0];for(I.high=O.high,I.low=O.low,p=0;p<5;p++)for(d=0;d<5;d++){var C=n[S=p+5*d],A=f[S],D=f[(p+1)%5+5*d],M=f[(p+2)%5+5*d];C.high=A.high^~D.high&M.high,C.low=A.low^~D.low&M.low}C=n[0];var j=l[s];C.high^=j.high,C.low^=j.low}},_doFinalize:function(){var e=this._data,n=e.words,r=(this._nDataBytes,8*e.sigBytes),i=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(t.ceil((r+1)/i)*i>>>5)-1]|=128,e.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,u=s/8,c=[],l=0;l<u;l++){var f=a[l],p=f.high,y=f.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),y=16711935&(y<<8|y>>>24)|4278255360&(y<<24|y>>>8),c.push(y),c.push(p)}return new o.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});n.SHA3=i._createHelper(p),n.HmacSHA3=i._createHmacHelper(p)}(Math),e.SHA3},"object"===u(t)?e.exports=t=s(n(0),n(6)):(o=[n(0),n(6)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){
/** @preserve
        (c) 2012 by CÃ©dric Mesnil. All rights reserved.
        	Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
        	    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
            - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
        	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
        */
return function(t){var n=e,r=n.lib,o=r.WordArray,i=r.Hasher,a=n.algo,s=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=o.create([0,1518500249,1859775393,2400959708,2840853838]),p=o.create([1352829926,1548603684,1836072691,2053994217,0]),y=a.RIPEMD160=i.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i,a,y,x,S,k,w,_,R,I,O,C=this._hash.words,A=f.words,D=p.words,M=s.words,j=u.words,P=c.words,T=l.words;for(k=i=C[0],w=a=C[1],_=y=C[2],R=x=C[3],I=S=C[4],n=0;n<80;n+=1)O=i+e[t+M[n]]|0,O+=n<16?h(a,y,x)+A[0]:n<32?d(a,y,x)+A[1]:n<48?v(a,y,x)+A[2]:n<64?m(a,y,x)+A[3]:g(a,y,x)+A[4],O=(O=b(O|=0,P[n]))+S|0,i=S,S=x,x=b(y,10),y=a,a=O,O=k+e[t+j[n]]|0,O+=n<16?g(w,_,R)+D[0]:n<32?m(w,_,R)+D[1]:n<48?v(w,_,R)+D[2]:n<64?d(w,_,R)+D[3]:h(w,_,R)+D[4],O=(O=b(O|=0,T[n]))+I|0,k=I,I=R,R=b(_,10),_=w,w=O;O=C[1]+y+R|0,C[1]=C[2]+x+I|0,C[2]=C[3]+S+k|0,C[3]=C[4]+i+w|0,C[4]=C[0]+a+_|0,C[0]=O},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,i=o.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function d(e,t,n){return e&t|~e&n}function v(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function g(e,t,n){return e^(t|~n)}function b(e,t){return e<<t|e>>>32-t}n.RIPEMD160=i._createHelper(y),n.HmacRIPEMD160=i._createHmacHelper(y)}(Math),e.RIPEMD160},"object"===u(t)?e.exports=t=s(n(0)):(o=[n(0)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r,o,i,a,s,u;return r=(n=(t=e).lib).Base,o=n.WordArray,a=(i=t.algo).SHA1,s=i.HMAC,u=i.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:a,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=s.create(n.hasher,e),i=o.create(),a=o.create([1]),u=i.words,c=a.words,l=n.keySize,f=n.iterations;u.length<l;){var p=r.update(t).finalize(a);r.reset();for(var y=p.words,h=y.length,d=p,v=1;v<f;v++){d=r.finalize(d),r.reset();for(var m=d.words,g=0;g<h;g++)y[g]^=m[g]}i.concat(p),c[0]++}return i.sigBytes=4*l,i}}),t.PBKDF2=function(e,t,n){return u.create(n).compute(e,t)},e.PBKDF2},"object"===u(t)?e.exports=t=s(n(0),n(7),n(8)):(o=[n(0),n(7),n(8)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function n(e,t,n,r){var o=this._iv;if(o){var i=o.slice(0);this._iv=void 0}else i=this._prevBlock;r.encryptBlock(i,0);for(var a=0;a<n;a++)e[t+a]^=i[a]}return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize;n.call(this,e,t,o,r),this._prevBlock=e.slice(t,t+o)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize,i=e.slice(t,t+o);n.call(this,e,t,o,r),this._prevBlock=i}}),t}(),e.mode.CFB},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n;return e.mode.CTR=(n=(t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);n.encryptBlock(a,0),i[r-1]=i[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}}),t.Decryptor=n,t),e.mode.CTR},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){
/** @preserve
         * Counter block mode compatible with  Dr Brian Gladman fileenc.c
         * derived from CryptoJS.mode.CTR
         * Jan Hruby jhruby.web@gmail.com
         */
return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function n(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var r=t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=n(e[0]))&&(e[1]=n(e[1]))}(a);var s=a.slice(0);r.encryptBlock(s,0);for(var u=0;u<o;u++)e[t+u]^=s[u]}});return t.Decryptor=r,t}(),e.mode.CTRGladman},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n;return e.mode.OFB=(n=(t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var a=0;a<r;a++)e[t+a]^=i[a]}}),t.Decryptor=n,t),e.mode.OFB},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t;return e.mode.ECB=((t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t),e.mode.ECB},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,o=r-n%r,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e.pad.Iso10126={pad:function(t,n){var r=4*n,o=r-t.sigBytes%r;t.concat(e.lib.WordArray.random(o-1)).concat(e.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},e.pad.ZeroPadding},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){var t,n,r;return n=(t=e).lib.CipherParams,r=t.enc.Hex,t.format.Hex={stringify:function(e){return e.ciphertext.toString(r)},parse:function(e){var t=r.parse(e);return n.create({ciphertext:t})}},e.format.Hex},"object"===u(t)?e.exports=t=s(n(0),n(1)):(o=[n(0),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib.BlockCipher,r=t.algo,o=[],i=[],a=[],s=[],u=[],c=[],l=[],f=[],p=[],y=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var h=r^r<<1^r<<2^r<<3^r<<4;h=h>>>8^255&h^99,o[n]=h,i[h]=n;var d=e[n],v=e[d],m=e[v],g=257*e[h]^16843008*h;a[n]=g<<24|g>>>8,s[n]=g<<16|g>>>16,u[n]=g<<8|g>>>24,c[n]=g,g=16843009*m^65537*v^257*d^16843008*n,l[h]=g<<24|g>>>8,f[h]=g<<16|g>>>16,p[h]=g<<8|g>>>24,y[h]=g,n?(n=d^e[e[e[m^d]]],r^=e[e[r]]):n=r=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],d=r.AES=n.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<r;a++)if(a<n)i[a]=t[a];else{var s=i[a-1];a%n?n>6&&a%n==4&&(s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s]):(s=o[(s=s<<8|s>>>24)>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s],s^=h[a/n|0]<<24),i[a]=i[a-n]^s}for(var u=this._invKeySchedule=[],c=0;c<r;c++)a=r-c,s=c%4?i[a]:i[a-4],u[c]=c<4||a<=4?s:l[o[s>>>24]]^f[o[s>>>16&255]]^p[o[s>>>8&255]]^y[o[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,u,c,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,f,p,y,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],f=e[t+2]^n[2],p=e[t+3]^n[3],y=4,h=1;h<u;h++){var d=r[c>>>24]^o[l>>>16&255]^i[f>>>8&255]^a[255&p]^n[y++],v=r[l>>>24]^o[f>>>16&255]^i[p>>>8&255]^a[255&c]^n[y++],m=r[f>>>24]^o[p>>>16&255]^i[c>>>8&255]^a[255&l]^n[y++],g=r[p>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&f]^n[y++];c=d,l=v,f=m,p=g}d=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[f>>>8&255]<<8|s[255&p])^n[y++],v=(s[l>>>24]<<24|s[f>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[y++],m=(s[f>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[y++],g=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&f])^n[y++],e[t]=d,e[t+1]=v,e[t+2]=m,e[t+3]=g},keySize:8});t.AES=n._createHelper(d)}(),e.AES},"object"===u(t)?e.exports=t=s(n(0),n(3),n(4),n(2),n(1)):(o=[n(0),n(3),n(4),n(2),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib,r=n.WordArray,o=n.BlockCipher,i=t.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=i.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=a[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var o=this._subKeys=[],i=0;i<16;i++){var c=o[i]=[],l=u[i];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+l)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+l)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var f=this._invSubKeys=[];for(n=0;n<16;n++)f[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),p.call(this,1,1431655765);for(var r=0;r<16;r++){for(var o=n[r],i=this._lBlock,a=this._rBlock,s=0,u=0;u<8;u++)s|=c[u][((a^o[u])&l[u])>>>0];this._lBlock=a,this._rBlock=i^s}var f=this._lBlock;this._lBlock=this._rBlock,this._rBlock=f,p.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function y(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}t.DES=o._createHelper(f);var h=i.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=f.createEncryptor(r.create(e.slice(0,2))),this._des2=f.createEncryptor(r.create(e.slice(2,4))),this._des3=f.createEncryptor(r.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=o._createHelper(h)}(),e.TripleDES},"object"===u(t)?e.exports=t=s(n(0),n(3),n(4),n(2),n(1)):(o=[n(0),n(3),n(4),n(2),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib.StreamCipher,r=t.algo,o=r.RC4=n.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],o=0;o<256;o++)r[o]=o;o=0;for(var i=0;o<256;o++){var a=o%n,s=t[a>>>2]>>>24-a%4*8&255;i=(i+r[o]+s)%256;var u=r[o];r[o]=r[i],r[i]=u}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,r=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,r|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,r}t.RC4=n._createHelper(o);var a=r.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});t.RC4Drop=n._createHelper(a)}(),e.RC4},"object"===u(t)?e.exports=t=s(n(0),n(3),n(4),n(2),n(1)):(o=[n(0),n(3),n(4),n(2),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib.StreamCipher,r=t.algo,o=[],i=[],a=[],s=r.Rabbit=n.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)u.call(this);for(n=0;n<8;n++)o[n]^=r[n+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),f=c>>>16|4294901760&l,p=l<<16|65535&c;for(o[0]^=c,o[1]^=f,o[2]^=l,o[3]^=p,o[4]^=c,o[5]^=f,o[6]^=l,o[7]^=p,n=0;n<4;n++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[t+r]^=o[r]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,s=r>>>16,u=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=u^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.Rabbit=n._createHelper(s)}(),e.Rabbit},"object"===u(t)?e.exports=t=s(n(0),n(3),n(4),n(2),n(1)):(o=[n(0),n(3),n(4),n(2),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t,n){var r,o,i,s;function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}s=function(e){return function(){var t=e,n=t.lib.StreamCipher,r=t.algo,o=[],i=[],a=[],s=r.RabbitLegacy=n.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)u.call(this);for(o=0;o<8;o++)r[o]^=n[o+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),f=c>>>16|4294901760&l,p=l<<16|65535&c;for(r[0]^=c,r[1]^=f,r[2]^=l,r[3]^=p,r[4]^=c,r[5]^=f,r[6]^=l,r[7]^=p,o=0;o<4;o++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[t+r]^=o[r]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,s=r>>>16,u=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=u^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.RabbitLegacy=n._createHelper(s)}(),e.RabbitLegacy},"object"===u(t)?e.exports=t=s(n(0),n(3),n(4),n(2),n(1)):(o=[n(0),n(3),n(4),n(2),n(1)],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i))},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,n){"use strict";n.r(t);var r=n(5);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(11),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DefaultPBKDF2Length=768}var t,n;return t=e,(n=[{key:"timingSafeEqual",value:function(e,t){var n=String(e),r=String(t),o=n.length,i=0;o!==r.length&&(r=n,i=1);for(var a=0;a<o;a++)i|=n.charCodeAt(a)^r.charCodeAt(a);return 0===i}},{key:"generateRandomKey",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.lib.WordArray.random(e/8).toString());case 1:case"end":return t.stop()}}))}},{key:"generateItemEncryptionKey",value:function(){var e,t,n,r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=512,t=1,o.next=3,regeneratorRuntime.awrap(this.generateRandomKey(e));case 3:return n=o.sent,o.next=6,regeneratorRuntime.awrap(this.generateRandomKey(e));case 6:return r=o.sent,o.abrupt("return",this.pbkdf2(r,n,t,e));case 8:case"end":return o.stop()}}),null,this)}},{key:"firstHalfOfKey",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.substring(0,e.length/2));case 1:case"end":return t.stop()}}))}},{key:"secondHalfOfKey",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.substring(e.length/2,e.length));case 1:case"end":return t.stop()}}))}},{key:"base64",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r.b)().btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)}))));case 1:case"end":return t.stop()}}))}},{key:"base64Decode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(r.b)().atob(e));case 1:case"end":return t.stop()}}))}},{key:"sha256",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.SHA256(e).toString());case 1:case"end":return t.stop()}}))}},{key:"hmac256",value:function(e,t){var n,r,o;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=i.enc.Hex.parse(t),r=i.enc.Utf8.parse(e),o=i.HmacSHA256(r,n).toString(),a.abrupt("return",o);case 4:case"end":return a.stop()}}))}},{key:"hexStringToArrayBuffer",value:function(e){var t,n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:for(t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return r.abrupt("return",new Uint8Array(t));case 2:case"end":return r.stop()}}))}},{key:"base64ToArrayBuffer",value:function(e){var t,n,r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.base64Decode(e));case 2:for(t=i.sent,n=t.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=t.charCodeAt(o);return i.abrupt("return",r.buffer);case 7:case"end":return i.stop()}}),null,this)}},{key:"arrayBufferToHexString",value:function(e){var t,n,r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:for(t=new Uint8Array(e),n="",o=0;o<t.byteLength;o++)(r=t[o].toString(16)).length<2&&(r="0"+r),n+=r;return i.abrupt("return",n);case 4:case"end":return i.stop()}}))}},{key:"generateSymmetricKeyPair",value:function(){var e,t,n,r,o,i,a,s,u,c,l=arguments;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return e=l.length>0&&void 0!==l[0]?l[0]:{},t=e.password,n=e.pw_salt,r=e.pw_cost,f.next=3,regeneratorRuntime.awrap(this.pbkdf2(t,n,r,this.DefaultPBKDF2Length));case 3:return o=f.sent,i=o.length,a=i/3,s=o.slice(0,a),u=o.slice(a,2*a),c=o.slice(2*a,3*a),f.abrupt("return",[s,u,c]);case 10:case"end":return f.stop()}}),null,this)}}])&&o(t.prototype,n),e}();function u(e){return(u="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=Object(r.c)(),y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,l(t).apply(this,arguments))}var n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(o=[{key:"generateUUIDSync",value:function(){return Object(r.a)()}},{key:"generateUUID",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.a)());case 1:case"end":return e.stop()}}))}},{key:"pbkdf2",value:function(e,t,n,r){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.webCryptoImportKey(e,"PBKDF2",["deriveBits"]));case 2:if(o=i.sent){i.next=6;break}return console.log("Key is null, unable to continue"),i.abrupt("return",null);case 6:return i.abrupt("return",this.webCryptoDeriveBits(o,t,n,r));case 7:case"end":return i.stop()}}),null,this)}},{key:"generateRandomKey",value:function(e){var t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",p.generateKey({name:"AES-CBC",length:e},!0,["encrypt","decrypt"]).then((function(e){return p.exportKey("raw",e).then((function(e){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(t.arrayBufferToHexString(new Uint8Array(e)));case 2:return n=r.sent,r.abrupt("return",n);case 4:case"end":return r.stop()}}))})).catch((function(e){console.error("Error exporting key",e)}))})).catch((function(e){console.error("Error generating key",e)})));case 2:case"end":return n.stop()}}))}},{key:"generateItemEncryptionKey",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.generateRandomKey(256),this.generateRandomKey(256)]).then((function(e){return e.join("")})));case 2:case"end":return e.stop()}}),null,this)}},{key:"aes256CbcDecrypt",value:function(e,t,n){var r,o,i,a=this;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n||(n=new ArrayBuffer(16)),r={name:"AES-CBC",iv:n},s.next=4,regeneratorRuntime.awrap(this.webCryptoImportKey(t,r.name,["decrypt"]));case 4:return o=s.sent,s.next=7,regeneratorRuntime.awrap(this.base64ToArrayBuffer(e));case 7:return i=s.sent,s.abrupt("return",crypto.subtle.decrypt(r,o,i).then((function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(a.arrayBufferToString(e));case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}))})).catch((function(e){console.error("Error decrypting:",e)})));case 9:case"end":return s.stop()}}),null,this)}},{key:"aes256CbcEncrypt",value:function(e,t,n){var r,o,i,a,s;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n||(n=new ArrayBuffer(16)),r={name:"AES-CBC",iv:n},u.next=4,regeneratorRuntime.awrap(this.webCryptoImportKey(t,r.name,["encrypt"]));case 4:return o=u.sent,u.next=7,regeneratorRuntime.awrap(this.stringToArrayBuffer(e));case 7:return i=u.sent,u.next=10,regeneratorRuntime.awrap(crypto.subtle.encrypt(r,o,i));case 10:return a=u.sent,u.next=13,regeneratorRuntime.awrap(this.arrayBufferToBase64(a));case 13:return s=u.sent,u.abrupt("return",s);case 15:case"end":return u.stop()}}),null,this)}},{key:"hmac256",value:function(e,t){var n,r,o,i=this;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.hexStringToArrayBuffer(t));case 2:return n=a.sent,a.next=5,regeneratorRuntime.awrap(this.webCryptoImportKey(n,"HMAC",["sign"],{name:"SHA-256"}));case 5:return r=a.sent,a.next=8,regeneratorRuntime.awrap(this.stringToArrayBuffer(e));case 8:return o=a.sent,a.abrupt("return",crypto.subtle.sign({name:"HMAC"},r,o).then((function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(i.arrayBufferToHexString(e));case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}))})).catch((function(e){console.error("Error computing hmac",e)})));case 10:case"end":return a.stop()}}),null,this)}},{key:"webCryptoImportKey",value:function(e,t,n,r){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if("string"!=typeof e){i.next=6;break}return i.next=3,regeneratorRuntime.awrap(this.stringToArrayBuffer(e));case 3:i.t0=i.sent,i.next=7;break;case 6:i.t0=e;case 7:return o=i.t0,i.abrupt("return",p.importKey("raw",o,{name:t,hash:r},!1,n).then((function(e){return e})).catch((function(e){return console.error(e),null})));case 9:case"end":return i.stop()}}),null,this)}},{key:"webCryptoDeriveBits",value:function(e,t,n,r){var o,i=this;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.stringToArrayBuffer(t));case 2:return a.t0=a.sent,a.t1=n,a.t2={name:"SHA-512"},o={name:"PBKDF2",salt:a.t0,iterations:a.t1,hash:a.t2},a.abrupt("return",p.deriveBits(o,e,r).then((function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(i.arrayBufferToHexString(new Uint8Array(e)));case 2:return t=n.sent,n.abrupt("return",t);case 4:case"end":return n.stop()}}))})).catch((function(e){return console.error(e),null})));case 7:case"end":return a.stop()}}),null,this)}},{key:"stringToArrayBuffer",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=new Blob([e]),o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsArrayBuffer(r)})));case 1:case"end":return t.stop()}}))}},{key:"arrayBufferToString",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=new Blob([e]),o=new FileReader;o.onload=function(e){t(e.target.result)},o.readAsText(r)})));case 1:case"end":return t.stop()}}))}},{key:"arrayBufferToBase64",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=new Blob([e],{type:"application/octet-binary"}),o=new FileReader;o.onload=function(e){var n=e.target.result;t(n.substr(n.indexOf(",")+1))},o.readAsDataURL(r)})));case 1:case"end":return t.stop()}}))}}])&&c(n.prototype,o),t}(s);function h(e){return(h="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=n(11),b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,v(t).apply(this,arguments))}var n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),n=t,(o=[{key:"generateUUIDSync",value:function(){return Object(r.a)()}},{key:"generateUUID",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.a)());case 1:case"end":return e.stop()}}))}},{key:"pbkdf2",value:function(e,t,n,r){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return o={keySize:r/32,hasher:g.algo.SHA512,iterations:n},i.abrupt("return",g.PBKDF2(e,t,o).toString());case 2:case"end":return i.stop()}}))}},{key:"hexStringToArrayBuffer",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",g.enc.Hex.parse(e));case 1:case"end":return t.stop()}}))}},{key:"aes256CbcDecrypt",value:function(e,t,n){var r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r=g.AES.decrypt(e,t,{iv:n,mode:g.mode.CBC,padding:g.pad.Pkcs7}),o.abrupt("return",r.toString(g.enc.Utf8));case 2:case"end":return o.stop()}}))}},{key:"aes256CbcEncrypt",value:function(e,t,n){var r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r=g.AES.encrypt(e,t,{iv:n,mode:g.mode.CBC,padding:g.pad.Pkcs7}),o.abrupt("return",r.toString());case 2:case"end":return o.stop()}}))}}])&&d(n.prototype,o),t}(s);function x(e){return(x="function"==typeof Symbol&&"symbol"==a(Symbol.iterator)?function(e){return a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":a(e)})(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,k(t).apply(this,arguments))}var n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,e),n=t,(r=[{key:"setNativeModules",value:function(e){var t=e.aes,n=e.base64;this.Aes=t,this.base64Instance=n}},{key:"generateUUID",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.Aes.randomUuid());case 2:return e=t.sent,t.abrupt("return",e.toLowerCase());case 4:case"end":return t.stop()}}),null,this)}},{key:"pbkdf2",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.Aes.pbkdf2(e,t,n,r));case 1:case"end":return o.stop()}}),null,this)}},{key:"generateRandomKey",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.Aes.randomKey(e/8));case 1:case"end":return t.stop()}}),null,this)}},{key:"generateRandomEncryptionKey",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.generateRandomKey(512));case 1:case"end":return e.stop()}}),null,this)}},{key:"base64",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.base64Instance.encode(e));case 1:case"end":return t.stop()}}),null,this)}},{key:"base64Decode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.base64Instance.decode(e));case 1:case"end":return t.stop()}}),null,this)}},{key:"sha256",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.Aes.sha256(e));case 1:case"end":return t.stop()}}),null,this)}},{key:"hmac256",value:function(e,t){return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.Aes.hmac256(e,t));case 1:case"end":return n.stop()}}),null,this)}},{key:"aes256CbcDecrypt",value:function(e,t,n){var r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.arrayBufferToHexString(t));case 2:return r=i.sent,i.next=5,regeneratorRuntime.awrap(this.arrayBufferToHexString(n));case 5:return o=i.sent,i.abrupt("return",this.Aes.decrypt(e,r,o));case 7:case"end":return i.stop()}}),null,this)}},{key:"aes256CbcEncrypt",value:function(e,t,n){var r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.arrayBufferToHexString(t));case 2:return r=i.sent,i.next=5,regeneratorRuntime.awrap(this.arrayBufferToHexString(n));case 5:return o=i.sent,i.abrupt("return",this.Aes.encrypt(e,r,o));case 7:case"end":return i.stop()}}),null,this)}}])&&S(n.prototype,r),t}(s);n.d(t,"SNAbstractCrypto",(function(){return s})),n.d(t,"SNWebCrypto",(function(){return y})),n.d(t,"SNCryptoJS",(function(){return b})),n.d(t,"SNReactNativeCrypto",(function(){return _})),n.d(t,"isWebCryptoAvailable",(function(){return r.d}))}])},"object"==a(t)&&"object"==a(e)?e.exports=i():(r=[],void 0===(o="function"==typeof(n=i)?n.apply(t,r):n)||(e.exports=o))}).call(this,n(22)(e))},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(57),i="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,a=o||i||Function("return this")();e.exports=a},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return null!=e&&"object"==n(e)}},function(e,t,n){var r=n(76),o=n(85)((function(e,t,n){r(e,t,n)}));e.exports=o},function(e,t,n){var r=n(38),o=n(44);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){var r=n(108),o=n(113);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(14),o=n(109),i=n(110),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?s:a:u&&u in Object(e)?o(e):i(e)}},function(e,t,n){var r=n(67),o=n(138),i=n(10);e.exports=function(e){return i(e)?r(e):o(e)}},function(e,t,n){var r=n(7).Symbol;e.exports=r},function(e,t,n){var r=n(3),o=n(47),i=n(146),a=n(149);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(a(e))}},function(e,t,n){var r=n(34),o=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},function(e,t,n){var r=n(53),o=n(49);e.exports=function(e,t,n,i){var a=!n;n||(n={});for(var s=-1,u=t.length;++s<u;){var c=t[s],l=i?i(n[c],e[c],c,n,e):void 0;void 0===l&&(l=e[c]),a?o(n,c,l):r(n,c,l)}return n}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=n(e);return!!(t=null==t?r:t)&&("number"==i||"symbol"!=i&&o.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(206);e.exports=function(e){return e&&e.length?r(e):[]}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(96),i=n(144),a=n(48),s=n(3),u=n(153);e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==r(e)?s(e)?i(e[0],e[1]):o(e):u(e)}},function(e,t,n){var r=n(25),o=n(103),i=n(104),a=n(105),s=n(106),u=n(107);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=s,c.prototype.set=u,e.exports=c},function(e,t,n){var r=n(98),o=n(99),i=n(100),a=n(101),s=n(102);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},function(e,t,n){var r=n(18);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(11)(Object,"create");e.exports=r},function(e,t,n){var r=n(122);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(135),o=n(8),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},function(e,t,n){(function(e){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(7),i=n(136),a="object"==r(t)&&t&&!t.nodeType&&t,s=a&&"object"==r(e)&&e&&!e.nodeType&&e,u=s&&s.exports===a?o.Buffer:void 0,c=(u?u.isBuffer:void 0)||i;e.exports=c}).call(this,n(22)(e))},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){var r=n(140),o=n(37),i=n(141),a=n(69),s=n(142),u=n(12),c=n(58),l=c(r),f=c(o),p=c(i),y=c(a),h=c(s),d=u;(r&&"[object DataView]"!=d(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=d(new o)||i&&"[object Promise]"!=d(i.resolve())||a&&"[object Set]"!=d(new a)||s&&"[object WeakMap]"!=d(new s))&&(d=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case p:return"[object Promise]";case y:return"[object Set]";case h:return"[object WeakMap]"}return t}),e.exports=d},function(e,t,n){var r=n(15),o=n(16);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(12),i=n(8),a="[object Symbol]";e.exports=function(e){return"symbol"==r(e)||i(e)&&o(e)==a}},function(e,t,n){var r=n(67),o=n(168),i=n(10);e.exports=function(e){return i(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(20),o=n(175),i=n(75),a=n(15),s=n(17),u=n(190),c=n(91),l=n(90),f=c((function(e,t){var n={};if(null==e)return n;var c=!1;t=r(t,(function(t){return t=a(t,e),c||(c=t.length>1),t})),s(e,l(e),n),c&&(n=o(n,7,u));for(var f=t.length;f--;)i(n,t[f]);return n}));e.exports=f},function(e,t,n){var r=n(11)(n(7),"Map");e.exports=r},function(e,t,n){var r=n(12),o=n(5),i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";e.exports=function(e){if(!o(e))return!1;var t=r(e);return t==a||t==s||t==i||t==u}},function(e,t,n){var r=n(114),o=n(121),i=n(123),a=n(124),s=n(125);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t,n){var r=n(133),o=n(66),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return i.call(e,t)})))}:o;e.exports=s},function(e,t,n){var r=n(137),o=n(31),i=n(45),a=i&&i.isTypedArray,s=a?o(a):r;e.exports=s},function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},function(e,t,n){(function(e){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(57),i="object"==r(t)&&t&&!t.nodeType&&t,a=i&&"object"==r(e)&&e&&!e.nodeType&&e,s=a&&a.exports===i&&o.process,u=function(){try{var e=a&&a.require&&a.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=u}).call(this,n(22)(e))},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(3),i=n(34),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(o(e))return!1;var n=r(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!a.test(e)||null!=t&&e in Object(t))}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(78);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(63);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(68)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(49),o=n(18),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var a=e[t];i.call(e,t)&&o(a,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(73),o=n(203),i=n(204);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,o,n)}},function(e,t,n){var r=n(54),o=n(10),i=n(211),a=n(74),s=n(212),u=Math.max;e.exports=function(e,t,n,c){e=o(e)?e:s(e),n=n&&!c?a(n):0;var l=e.length;return n<0&&(n=u(l+n,0)),i(e)?n<=l&&e.indexOf(t,n)>-1:!!l&&r(e,t,n)>-1}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,n){(function(t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r="object"==(void 0===t?"undefined":n(t))&&t&&t.Object===Object&&t;e.exports=r}).call(this,n(56))},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(126),o=n(8);e.exports=function e(t,n,i,a,s){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,i,a,e,s))}},function(e,t,n){var r=n(61),o=n(129),i=n(62),a=1,s=2;e.exports=function(e,t,n,u,c,l){var f=n&a,p=e.length,y=t.length;if(p!=y&&!(f&&y>p))return!1;var h=l.get(e);if(h&&l.get(t))return h==t;var d=-1,v=!0,m=n&s?new r:void 0;for(l.set(e,t),l.set(t,e);++d<p;){var g=e[d],b=t[d];if(u)var x=f?u(b,g,d,t,e,l):u(g,b,d,e,t,l);if(void 0!==x){if(x)continue;v=!1;break}if(m){if(!o(t,(function(e,t){if(!i(m,t)&&(g===e||c(g,e,n,u,l)))return m.push(t)}))){v=!1;break}}else if(g!==b&&!c(g,b,n,u,l)){v=!1;break}}return l.delete(e),l.delete(t),v}},function(e,t,n){var r=n(39),o=n(127),i=n(128);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,e.exports=a},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(7).Uint8Array;e.exports=r},function(e,t,n){var r=n(65),o=n(42),i=n(13);e.exports=function(e){return r(e,i,o)}},function(e,t,n){var r=n(41),o=n(3);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(134),o=n(29),i=n(3),a=n(30),s=n(19),u=n(43),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),l=!n&&o(e),f=!n&&!l&&a(e),p=!n&&!l&&!f&&u(e),y=n||l||f||p,h=y?r(e.length,String):[],d=h.length;for(var v in e)!t&&!c.call(e,v)||y&&("length"==v||f&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,d))||h.push(v);return h}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(11)(n(7),"Set");e.exports=r},function(e,t,n){var r=n(5);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},function(e,t,n){var r=n(151),o=n(152);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t){e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},function(e,t,n){var r=n(157);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var r=n(15),o=n(160),i=n(161),a=n(16);e.exports=function(e,t){return t=r(t,e),null==(e=i(e,t))||delete e[a(o(t))]}},function(e,t,n){var r=n(24),o=n(77),i=n(79),a=n(164),s=n(5),u=n(35),c=n(84);e.exports=function e(t,n,l,f,p){t!==n&&i(n,(function(i,u){if(p||(p=new r),s(i))a(t,n,u,l,e,f,p);else{var y=f?f(c(t,u),i,u+"",t,n,p):void 0;void 0===y&&(y=i),o(t,u,y)}}),u)}},function(e,t,n){var r=n(49),o=n(18);e.exports=function(e,t,n){(void 0===n||o(e[t],n))&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(11),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(163)();e.exports=r},function(e,t,n){(function(e){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(7),i="object"==r(t)&&t&&!t.nodeType&&t,a=i&&"object"==r(e)&&e&&!e.nodeType&&e,s=a&&a.exports===i?o.Buffer:void 0,u=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=u?u(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(22)(e))},function(e,t,n){var r=n(50);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(165),o=n(52),i=n(46);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},function(e,t,n){var r=n(12),o=n(52),i=n(8),a="[object Object]",s=Function.prototype,u=Object.prototype,c=s.toString,l=u.hasOwnProperty,f=c.call(Object);e.exports=function(e){if(!i(e)||r(e)!=a)return!1;var t=o(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==f}},function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},function(e,t,n){var r=n(86),o=n(174);e.exports=function(e){return r((function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var u=n[r];u&&e(t,u,r,a)}return t}))}},function(e,t,n){var r=n(48),o=n(87),i=n(88);e.exports=function(e,t){return i(o(e,t,r),e+"")}},function(e,t,n){var r=n(170),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),u=Array(s);++a<s;)u[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=n(u),r(e,this,c)}}},function(e,t,n){var r=n(171),o=n(173)(r);e.exports=o},function(e,t,n){var r=n(41),o=n(52),i=n(42),a=n(66),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:a;e.exports=s},function(e,t,n){var r=n(65),o=n(89),i=n(35);e.exports=function(e){return r(e,i,o)}},function(e,t,n){var r=n(191),o=n(87),i=n(88);e.exports=function(e){return i(o(e,void 0,r),e+"")}},function(e,t,n){var r=n(76),o=n(85)((function(e,t,n,o){r(e,t,n,o)}));e.exports=o},function(e,t,n){var r=n(194),o=n(91)((function(e,t){return null==e?{}:r(e,t)}));e.exports=o},function(e,t,n){var r=n(20),o=n(23),i=n(197),a=n(3);e.exports=function(e,t){return(a(e)?r:i)(e,o(t,3))}},function(e,t,n){var r=n(23),o=n(10),i=n(13);e.exports=function(e){return function(t,n,a){var s=Object(t);if(!o(t)){var u=r(n,3);t=i(t),n=function(e){return u(s[e],e,s)}}var c=e(t,n,a);return c>-1?s[u?t[c]:c]:void 0}}},function(e,t,n){var r=n(97),o=n(143),i=n(71);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(24),o=n(59),i=1,a=2;e.exports=function(e,t,n,s){var u=n.length,c=u,l=!s;if(null==e)return!c;for(e=Object(e);u--;){var f=n[u];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++u<c;){var p=(f=n[u])[0],y=e[p],h=f[1];if(l&&f[2]){if(void 0===y&&!(p in e))return!1}else{var d=new r;if(s)var v=s(y,h,p,e,t,d);if(!(void 0===v?o(h,y,i|a,s,d):v))return!1}}return!0}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(26),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():o.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(26);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(26);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(26);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(25);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(25),o=n(37),i=n(39),a=200;e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!o||s.length<a-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(s)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(38),o=n(111),i=n(5),a=n(58),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,f=c.hasOwnProperty,p=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?p:s).test(a(e))}},function(e,t,n){var r=n(14),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,o=n(112),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!i&&i in e}},function(e,t,n){var r=n(7)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(115),o=n(25),i=n(37);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(e,t,n){var r=n(116),o=n(117),i=n(118),a=n(119),s=n(120);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=i,u.prototype.has=a,u.prototype.set=s,e.exports=u},function(e,t,n){var r=n(27);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(27),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return n===o?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(27),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(27),o="__lodash_hash_undefined__";e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?o:t,this}},function(e,t,n){var r=n(28);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){var t=n(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(28);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(28);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(28);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var r=n(24),o=n(60),i=n(130),a=n(132),s=n(32),u=n(3),c=n(30),l=n(43),f=1,p="[object Arguments]",y="[object Array]",h="[object Object]",d=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,m,g){var b=u(e),x=u(t),S=b?y:s(e),k=x?y:s(t),w=(S=S==p?h:S)==h,_=(k=k==p?h:k)==h,R=S==k;if(R&&c(e)){if(!c(t))return!1;b=!0,w=!1}if(R&&!w)return g||(g=new r),b||l(e)?o(e,t,n,v,m,g):i(e,t,S,n,v,m,g);if(!(n&f)){var I=w&&d.call(e,"__wrapped__"),O=_&&d.call(t,"__wrapped__");if(I||O){var C=I?e.value():e,A=O?t.value():t;return g||(g=new r),m(C,A,n,v,g)}}return!!R&&(g||(g=new r),a(e,t,n,v,m,g))}},function(e,t){var n="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,n),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t,n){var r=n(14),o=n(63),i=n(18),a=n(60),s=n(131),u=n(40),c=1,l=2,f="[object Boolean]",p="[object Date]",y="[object Error]",h="[object Map]",d="[object Number]",v="[object RegExp]",m="[object Set]",g="[object String]",b="[object Symbol]",x="[object ArrayBuffer]",S="[object DataView]",k=r?r.prototype:void 0,w=k?k.valueOf:void 0;e.exports=function(e,t,n,r,k,_,R){switch(n){case S:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case x:return!(e.byteLength!=t.byteLength||!_(new o(e),new o(t)));case f:case p:case d:return i(+e,+t);case y:return e.name==t.name&&e.message==t.message;case v:case g:return e==t+"";case h:var I=s;case m:var O=r&c;if(I||(I=u),e.size!=t.size&&!O)return!1;var C=R.get(e);if(C)return C==t;r|=l,R.set(e,t);var A=a(I(e),I(t),r,k,_,R);return R.delete(e),A;case b:if(w)return w.call(e)==w.call(t)}return!1}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t,n){var r=n(64),o=1,i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,a,s,u){var c=n&o,l=r(e),f=l.length;if(f!=r(t).length&&!c)return!1;for(var p=f;p--;){var y=l[p];if(!(c?y in t:i.call(t,y)))return!1}var h=u.get(e);if(h&&u.get(t))return h==t;var d=!0;u.set(e,t),u.set(t,e);for(var v=c;++p<f;){var m=e[y=l[p]],g=t[y];if(a)var b=c?a(g,m,y,t,e,u):a(m,g,y,e,t,u);if(!(void 0===b?m===g||s(m,g,n,a,u):b)){d=!1;break}v||(v="constructor"==y)}if(d&&!v){var x=e.constructor,S=t.constructor;x!=S&&"constructor"in e&&"constructor"in t&&!("function"==typeof x&&x instanceof x&&"function"==typeof S&&S instanceof S)&&(d=!1)}return u.delete(e),u.delete(t),d}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(12),o=n(8),i="[object Arguments]";e.exports=function(e){return o(e)&&r(e)==i}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(12),o=n(44),i=n(8),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[r(e)]}},function(e,t,n){var r=n(46),o=n(139),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t,n){var r=n(68)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(11)(n(7),"DataView");e.exports=r},function(e,t,n){var r=n(11)(n(7),"Promise");e.exports=r},function(e,t,n){var r=n(11)(n(7),"WeakMap");e.exports=r},function(e,t,n){var r=n(70),o=n(13);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,r(a)]}return t}},function(e,t,n){var r=n(59),o=n(145),i=n(72),a=n(47),s=n(70),u=n(71),c=n(16),l=1,f=2;e.exports=function(e,t){return a(e)&&s(t)?u(c(e),t):function(n){var a=o(n,e);return void 0===a&&a===t?i(n,e):r(t,a,l|f)}}},function(e,t,n){var r=n(33);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},function(e,t,n){var r=n(147),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)})),t}));e.exports=a},function(e,t,n){var r=n(148),o=500;e.exports=function(e){var t=r(e,(function(e){return n.size===o&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(39),o="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(o);var n=function n(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(150);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(14),o=n(20),i=n(3),a=n(34),s=1/0,u=r?r.prototype:void 0,c=u?u.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(15),o=n(29),i=n(3),a=n(19),s=n(44),u=n(16);e.exports=function(e,t,n){for(var c=-1,l=(t=r(t,e)).length,f=!1;++c<l;){var p=u(t[c]);if(!(f=null!=e&&n(e,p)))break;e=e[p]}return f||++c!=l?f:!!(l=null==e?0:e.length)&&s(l)&&a(p,l)&&(i(e)||o(e))}},function(e,t,n){var r=n(154),o=n(155),i=n(47),a=n(16);e.exports=function(e){return i(e)?r(a(e)):o(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(33);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(73),o=n(23),i=n(74),a=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var u=null==n?0:i(n);return u<0&&(u=a(s+u,0)),r(e,o(t,3),u)}},function(e,t,n){var r=n(158),o=1/0,i=17976931348623157e292;e.exports=function(e){return e?(e=r(e))===o||e===-o?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(5),o=n(34),i=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return i;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=u.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):s.test(e)?i:+e}},function(e,t,n){var r=n(75),o=n(19),i=Array.prototype.splice;e.exports=function(e,t){for(var n=e?t.length:0,a=n-1;n--;){var s=t[n];if(n==a||s!==u){var u=s;o(s)?i.call(e,s,1):r(e,s)}}return e}},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){var r=n(33),o=n(162);e.exports=function(e,t){return t.length<2?e:r(e,o(t,0,-1))}},function(e,t){e.exports=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}},function(e,t){e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++o];if(!1===n(i[u],u,i))break}return t}}},function(e,t,n){var r=n(77),o=n(80),i=n(81),a=n(51),s=n(82),u=n(29),c=n(3),l=n(166),f=n(30),p=n(38),y=n(5),h=n(83),d=n(43),v=n(84),m=n(167);e.exports=function(e,t,n,g,b,x,S){var k=v(e,n),w=v(t,n),_=S.get(w);if(_)r(e,n,_);else{var R=x?x(k,w,n+"",e,t,S):void 0,I=void 0===R;if(I){var O=c(w),C=!O&&f(w),A=!O&&!C&&d(w);R=w,O||C||A?c(k)?R=k:l(k)?R=a(k):C?(I=!1,R=o(w,!0)):A?(I=!1,R=i(w,!0)):R=[]:h(w)||u(w)?(R=k,u(k)?R=m(k):y(k)&&!p(k)||(R=s(w))):I=!1}I&&(S.set(w,R),b(R,w,g,x,S),S.delete(w)),r(e,n,R)}}},function(e,t,n){var r=n(5),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},function(e,t,n){var r=n(10),o=n(8);e.exports=function(e){return o(e)&&r(e)}},function(e,t,n){var r=n(17),o=n(35);e.exports=function(e){return r(e,o(e))}},function(e,t,n){var r=n(5),o=n(46),i=n(169),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&n.push(s);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(172),o=n(78),i=n(48),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var n=800,r=16,o=Date.now;e.exports=function(e){var t=0,i=0;return function(){var a=o(),s=r-(a-i);if(i=a,s>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(18),i=n(10),a=n(19),s=n(5);e.exports=function(e,t,n){if(!s(n))return!1;var u=r(t);return!!("number"==u?i(n)&&a(t,n.length):"string"==u&&t in n)&&o(n[t],e)}},function(e,t,n){var r=n(24),o=n(176),i=n(53),a=n(177),s=n(178),u=n(80),c=n(51),l=n(179),f=n(180),p=n(64),y=n(90),h=n(32),d=n(181),v=n(182),m=n(82),g=n(3),b=n(30),x=n(186),S=n(5),k=n(188),w=n(13),_=1,R=2,I=4,O="[object Arguments]",C="[object Function]",A="[object GeneratorFunction]",D="[object Object]",M={};M[O]=M["[object Array]"]=M["[object ArrayBuffer]"]=M["[object DataView]"]=M["[object Boolean]"]=M["[object Date]"]=M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Map]"]=M["[object Number]"]=M[D]=M["[object RegExp]"]=M["[object Set]"]=M["[object String]"]=M["[object Symbol]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M["[object Error]"]=M[C]=M["[object WeakMap]"]=!1,e.exports=function e(t,n,j,P,T,E){var F,B=n&_,H=n&R,L=n&I;if(j&&(F=T?j(t,P,T,E):j(t)),void 0!==F)return F;if(!S(t))return t;var N=g(t);if(N){if(F=d(t),!B)return c(t,F)}else{var U=h(t),K=U==C||U==A;if(b(t))return u(t,B);if(U==D||U==O||K&&!T){if(F=H||K?{}:m(t),!B)return H?f(t,s(F,t)):l(t,a(F,t))}else{if(!M[U])return T?t:{};F=v(t,U,B)}}E||(E=new r);var z=E.get(t);if(z)return z;E.set(t,F),k(t)?t.forEach((function(r){F.add(e(r,n,j,r,t,E))})):x(t)&&t.forEach((function(r,o){F.set(o,e(r,n,j,o,t,E))}));var W=L?H?y:p:H?keysIn:w,q=N?void 0:W(t);return o(q||t,(function(r,o){q&&(r=t[o=r]),i(F,o,e(r,n,j,o,t,E))})),F}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){var r=n(17),o=n(13);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(17),o=n(35);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(17),o=n(42);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(17),o=n(89);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(50),o=n(183),i=n(184),a=n(185),s=n(81),u="[object Boolean]",c="[object Date]",l="[object Map]",f="[object Number]",p="[object RegExp]",y="[object Set]",h="[object String]",d="[object Symbol]",v="[object ArrayBuffer]",m="[object DataView]",g="[object Float32Array]",b="[object Float64Array]",x="[object Int8Array]",S="[object Int16Array]",k="[object Int32Array]",w="[object Uint8Array]",_="[object Uint8ClampedArray]",R="[object Uint16Array]",I="[object Uint32Array]";e.exports=function(e,t,n){var O=e.constructor;switch(t){case v:return r(e);case u:case c:return new O(+e);case m:return o(e,n);case g:case b:case x:case S:case k:case w:case _:case R:case I:return s(e,n);case l:return new O;case f:case h:return new O(e);case p:return i(e);case y:return new O;case d:return a(e)}}},function(e,t,n){var r=n(50);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(14),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},function(e,t,n){var r=n(187),o=n(31),i=n(45),a=i&&i.isMap,s=a?o(a):r;e.exports=s},function(e,t,n){var r=n(32),o=n(8),i="[object Map]";e.exports=function(e){return o(e)&&r(e)==i}},function(e,t,n){var r=n(189),o=n(31),i=n(45),a=i&&i.isSet,s=a?o(a):r;e.exports=s},function(e,t,n){var r=n(32),o=n(8),i="[object Set]";e.exports=function(e){return o(e)&&r(e)==i}},function(e,t,n){var r=n(83);e.exports=function(e){return r(e)?void 0:e}},function(e,t,n){var r=n(192);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},function(e,t,n){var r=n(41),o=n(193);e.exports=function e(t,n,i,a,s){var u=-1,c=t.length;for(i||(i=o),s||(s=[]);++u<c;){var l=t[u];n>0&&i(l)?n>1?e(l,n-1,i,a,s):r(s,l):a||(s[s.length]=l)}return s}},function(e,t,n){var r=n(14),o=n(29),i=n(3),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(a&&e&&e[a])}},function(e,t,n){var r=n(195),o=n(72);e.exports=function(e,t){return r(e,t,(function(t,n){return o(e,n)}))}},function(e,t,n){var r=n(33),o=n(196),i=n(15);e.exports=function(e,t,n){for(var a=-1,s=t.length,u={};++a<s;){var c=t[a],l=r(e,c);n(l,c)&&o(u,i(c,e),l)}return u}},function(e,t,n){var r=n(53),o=n(15),i=n(19),a=n(5),s=n(16);e.exports=function(e,t,n,u){if(!a(e))return e;for(var c=-1,l=(t=o(t,e)).length,f=l-1,p=e;null!=p&&++c<l;){var y=s(t[c]),h=n;if(c!=f){var d=p[y];void 0===(h=u?u(d,y,p):void 0)&&(h=a(d)?d:i(t[c+1])?[]:{})}r(p,y,h),p=p[y]}return e}},function(e,t,n){var r=n(198),o=n(10);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}},function(e,t,n){var r=n(199),o=n(200)(r);e.exports=o},function(e,t,n){var r=n(79),o=n(13);e.exports=function(e,t){return e&&r(e,t,o)}},function(e,t,n){var r=n(10);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==o(s[a],a,s););return n}}},function(e,t,n){var r=n(202);e.exports=function(e,t){return e&&e.length&&t&&t.length?r(e,t):e}},function(e,t,n){var r=n(20),o=n(54),i=n(205),a=n(31),s=n(51),u=Array.prototype.splice;e.exports=function(e,t,n,c){var l=c?i:o,f=-1,p=t.length,y=e;for(e===t&&(t=s(t)),n&&(y=r(e,a(n)));++f<p;)for(var h=0,d=t[f],v=n?n(d):d;(h=l(y,v,h,c))>-1;)y!==e&&u.call(y,h,1),u.call(e,h,1);return e}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},function(e,t){e.exports=function(e,t,n,r){for(var o=n-1,i=e.length;++o<i;)if(r(e[o],t))return o;return-1}},function(e,t,n){var r=n(61),o=n(207),i=n(208),a=n(62),s=n(209),u=n(40),c=200;e.exports=function(e,t,n){var l=-1,f=o,p=e.length,y=!0,h=[],d=h;if(n)y=!1,f=i;else if(p>=c){var v=t?null:s(e);if(v)return u(v);y=!1,f=a,d=new r}else d=t?[]:h;e:for(;++l<p;){var m=e[l],g=t?t(m):m;if(m=n||0!==m?m:0,y&&g==g){for(var b=d.length;b--;)if(d[b]===g)continue e;t&&d.push(g),h.push(m)}else f(d,g,n)||(d!==h&&d.push(g),h.push(m))}return h}},function(e,t,n){var r=n(54);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},function(e,t){e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},function(e,t,n){var r=n(69),o=n(210),i=n(40),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=a},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(12),o=n(3),i=n(8),a="[object String]";e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&r(e)==a}},function(e,t,n){var r=n(213),o=n(13);e.exports=function(e){return null==e?[]:r(e,o(e))}},function(e,t,n){var r=n(20);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},function(e,t,n){"use strict";n.r(t);var r=n(6);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.crypto=t}var t,n,r;return t=e,(n=[{key:"decryptText",value:function(){var e,t,n,r,o,i,a,s,u,c,l=arguments;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(e=l.length>0&&void 0!==l[0]?l[0]:{},t=e.ciphertextToAuth,n=e.contentCiphertext,r=e.encryptionKey,o=e.iv,i=e.authHash,a=e.authKey,!(l.length>1?l[1]:void 0)||i){f.next=5;break}return console.error("Auth hash is required."),f.abrupt("return");case 5:if(!i){f.next=12;break}return f.next=8,regeneratorRuntime.awrap(this.crypto.hmac256(t,a));case 8:if(s=f.sent,!1!==this.crypto.timingSafeEqual(i,s)){f.next=12;break}return console.error("Auth hash does not match, returning null."),f.abrupt("return",null);case 12:return f.next=14,regeneratorRuntime.awrap(this.crypto.hexStringToArrayBuffer(r));case 14:return u=f.sent,f.next=17,regeneratorRuntime.awrap(this.crypto.hexStringToArrayBuffer(o||""));case 17:return c=f.sent,f.abrupt("return",this.crypto.aes256CbcDecrypt(n,u,c));case 19:case"end":return f.stop()}}),null,this)}},{key:"encryptText",value:function(e,t,n){var r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.crypto.hexStringToArrayBuffer(t));case 2:return r=i.sent,i.next=5,regeneratorRuntime.awrap(this.crypto.hexStringToArrayBuffer(n||""));case 5:return o=i.sent,i.abrupt("return",this.crypto.aes256CbcEncrypt(e,r,o));case 7:case"end":return i.stop()}}),null,this)}}])&&o(t.prototype,n),r&&o(t,r),e}();function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,c(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),n=t,o=[{key:"pwCost",value:function(){return 3e3}},{key:"versionString",value:function(){return"001"}}],(r=[{key:"generateSalt",value:function(e,t,n,r){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.crypto.sha256([e,"SF",t,n,r].join(":")));case 2:return o=i.sent,i.abrupt("return",o);case 4:case"end":return i.stop()}}),null,this)}},{key:"computeEncryptionKeysForUser",value:function(e,t){var n,r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=t.pw_salt,i.next=3,regeneratorRuntime.awrap(this.crypto.generateSymmetricKeyPair({password:e,pw_salt:n,pw_cost:t.pw_cost}));case 3:return r=i.sent,o={pw:r[0],mk:r[1],ak:r[2]},i.abrupt("return",o);case 6:case"end":return i.stop()}}),null,this)}},{key:"_private_encryptString",value:function(e,t,n,r,o){var i,a;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.encryptText(e,t,null));case 2:return a=n.sent,i=o.version+a,n.abrupt("return",i);case 5:case"end":return n.stop()}}),null,this)}},{key:"encryptItem",value:function(e,t,n){var r,o,i,a,s,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return r={},c.next=3,regeneratorRuntime.awrap(this.crypto.generateItemEncryptionKey());case 3:return o=c.sent,c.next=6,regeneratorRuntime.awrap(this.encryptText(o,t.mk,null));case 6:return r.enc_item_key=c.sent,c.next=9,regeneratorRuntime.awrap(this.crypto.firstHalfOfKey(o));case 9:return i=c.sent,c.next=12,regeneratorRuntime.awrap(this.crypto.secondHalfOfKey(o));case 12:return a=c.sent,c.next=15,regeneratorRuntime.awrap(this._private_encryptString(JSON.stringify(e.createContentJSONFromProperties()),i,a,e.uuid,n));case 15:return s=c.sent,c.next=18,regeneratorRuntime.awrap(this.crypto.hmac256(s,a));case 18:return u=c.sent,r.auth_hash=u,r.content=s,c.abrupt("return",r);case 22:case"end":return c.stop()}}),null,this)}},{key:"encryptionComponentsFromString",value:function(e,t,n){var r=e.substring(0,3);return{contentCiphertext:e.substring(3,e.length),encryptionVersion:r,ciphertextToAuth:e,iv:null,authHash:null,encryptionKey:t,authKey:n}}},{key:"decryptItem",value:function(e,t){var n,r,o,i,a,s,u,c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:if("string"==typeof e.content){l.next=2;break}return l.abrupt("return");case 2:if(!e.content.startsWith("000")){l.next=14;break}return l.prev=3,l.t0=JSON,l.next=7,regeneratorRuntime.awrap(this.crypto.base64Decode(e.content.substring(3,e.content.length)));case 7:l.t1=l.sent,e.content=l.t0.parse.call(l.t0,l.t1),l.next=13;break;case 11:l.prev=11,l.t2=l.catch(3);case 13:return l.abrupt("return");case 14:if(e.enc_item_key){l.next=17;break}return console.log("Missing item encryption key, skipping decryption."),l.abrupt("return");case 17:if(n=e.enc_item_key,r=!0,n="001"+n,r=!1,!(o=this.encryptionComponentsFromString(n,t.mk,t.ak)).uuid||o.uuid===e.uuid){l.next=27;break}return console.error("Item key params UUID does not match item UUID"),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 27:return l.next=29,regeneratorRuntime.awrap(this.decryptText(o,r));case 29:if(i=l.sent){l.next=35;break}return console.log("Error decrypting item",e),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 35:return l.next=37,regeneratorRuntime.awrap(this.crypto.firstHalfOfKey(i));case 37:return a=l.sent,l.next=40,regeneratorRuntime.awrap(this.crypto.secondHalfOfKey(i));case 40:return s=l.sent,u=this.encryptionComponentsFromString(e.content,a,s),l.prev=42,l.t3=JSON,l.next=46,regeneratorRuntime.awrap(this.crypto.base64Decode(u.authParams));case 46:l.t4=l.sent,e.auth_params=l.t3.parse.call(l.t3,l.t4),l.next=52;break;case 50:l.prev=50,l.t5=l.catch(42);case 52:if(!u.uuid||u.uuid===e.uuid){l.next=56;break}return e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 56:return u.authHash||(u.authHash=e.auth_hash),l.next=59,regeneratorRuntime.awrap(this.decryptText(u,!0));case 59:(c=l.sent)?(1==e.errorDecrypting&&(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!1,e.content=c):(e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0);case 61:case"end":return l.stop()}}),null,this,[[3,11],[42,50]])}}])&&s(n.prototype,r),o&&s(n,o),t}(i);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),h(this,d(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),n=t,o=[{key:"pwCost",value:function(){return 3e3}},{key:"versionString",value:function(){return"002"}}],(r=[{key:"generateSalt",value:function(e,t,n,r){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.crypto.sha256([e,"SF",t,n,r].join(":")));case 2:return o=i.sent,i.abrupt("return",o);case 4:case"end":return i.stop()}}),null,this)}},{key:"computeEncryptionKeysForUser",value:function(e,t){var n,r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=t.pw_salt,i.next=3,regeneratorRuntime.awrap(this.crypto.generateSymmetricKeyPair({password:e,pw_salt:n,pw_cost:t.pw_cost}));case 3:return r=i.sent,o={pw:r[0],mk:r[1],ak:r[2]},i.abrupt("return",o);case 6:case"end":return i.stop()}}),null,this)}},{key:"_private_encryptString",value:function(e,t,n,r,o){var i,a,s,u,c,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,regeneratorRuntime.awrap(this.crypto.generateRandomKey(128));case 2:return s=f.sent,f.next=5,regeneratorRuntime.awrap(this.encryptText(e,t,s));case 5:return a=f.sent,u=[o.version,r,s,a].join(":"),f.next=9,regeneratorRuntime.awrap(this.crypto.hmac256(u,n));case 9:return c=f.sent,f.next=12,regeneratorRuntime.awrap(this.crypto.base64(JSON.stringify(o)));case 12:return l=f.sent,i=[o.version,c,r,s,a,l].join(":"),f.abrupt("return",i);case 15:case"end":return f.stop()}}),null,this)}},{key:"encryptItem",value:function(e,t,n){var r,o,i,a,s;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r={},u.next=3,regeneratorRuntime.awrap(this.crypto.generateItemEncryptionKey());case 3:return o=u.sent,u.next=6,regeneratorRuntime.awrap(this._private_encryptString(o,t.mk,t.ak,e.uuid,n));case 6:return r.enc_item_key=u.sent,u.next=9,regeneratorRuntime.awrap(this.crypto.firstHalfOfKey(o));case 9:return i=u.sent,u.next=12,regeneratorRuntime.awrap(this.crypto.secondHalfOfKey(o));case 12:return a=u.sent,u.next=15,regeneratorRuntime.awrap(this._private_encryptString(JSON.stringify(e.createContentJSONFromProperties()),i,a,e.uuid,n));case 15:return s=u.sent,r.content=s,u.abrupt("return",r);case 18:case"end":return u.stop()}}),null,this)}},{key:"encryptionComponentsFromString",value:function(e,t,n){e.substring(0,3);var r=e.split(":");return{encryptionVersion:r[0],authHash:r[1],uuid:r[2],iv:r[3],contentCiphertext:r[4],authParams:r[5],ciphertextToAuth:[r[0],r[2],r[3],r[4]].join(":"),encryptionKey:t,authKey:n}}},{key:"decryptItem",value:function(e,t){var n,r,o,i,a,s,u,c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:if("string"==typeof e.content){l.next=2;break}return l.abrupt("return");case 2:if(!e.content.startsWith("000")){l.next=14;break}return l.prev=3,l.t0=JSON,l.next=7,regeneratorRuntime.awrap(this.crypto.base64Decode(e.content.substring(3,e.content.length)));case 7:l.t1=l.sent,e.content=l.t0.parse.call(l.t0,l.t1),l.next=13;break;case 11:l.prev=11,l.t2=l.catch(3);case 13:return l.abrupt("return");case 14:if(e.enc_item_key){l.next=17;break}return console.log("Missing item encryption key, skipping decryption."),l.abrupt("return");case 17:if(n=e.enc_item_key,r=!0,!(o=this.encryptionComponentsFromString(n,t.mk,t.ak)).uuid||o.uuid===e.uuid){l.next=25;break}return console.error("Item key params UUID does not match item UUID"),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 25:return l.next=27,regeneratorRuntime.awrap(this.decryptText(o,r));case 27:if(i=l.sent){l.next=33;break}return console.log("Error decrypting item",e),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 33:return l.next=35,regeneratorRuntime.awrap(this.crypto.firstHalfOfKey(i));case 35:return a=l.sent,l.next=38,regeneratorRuntime.awrap(this.crypto.secondHalfOfKey(i));case 38:return s=l.sent,u=this.encryptionComponentsFromString(e.content,a,s),l.prev=40,l.t3=JSON,l.next=44,regeneratorRuntime.awrap(this.crypto.base64Decode(u.authParams));case 44:l.t4=l.sent,e.auth_params=l.t3.parse.call(l.t3,l.t4),l.next=50;break;case 48:l.prev=48,l.t5=l.catch(40);case 50:if(!u.uuid||u.uuid===e.uuid){l.next=54;break}return e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 54:return l.next=56,regeneratorRuntime.awrap(this.decryptText(u,!0));case 56:(c=l.sent)?(1==e.errorDecrypting&&(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!1,e.content=c):(e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0);case 58:case"end":return l.stop()}}),null,this,[[3,11],[40,48]])}}])&&y(n.prototype,r),o&&y(n,o),t}(i);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),x(this,S(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,e),n=t,o=[{key:"pwCost",value:function(){return 11e4}},{key:"versionString",value:function(){return"003"}}],(r=[{key:"generateSalt",value:function(e,t,n,r){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.crypto.sha256([e,"SF",t,n,r].join(":")));case 2:return o=i.sent,i.abrupt("return",o);case 4:case"end":return i.stop()}}),null,this)}},{key:"computeEncryptionKeysForUser",value:function(e,t){var n,r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(t.identifier){i.next=3;break}return console.error("authParams is missing identifier."),i.abrupt("return");case 3:return i.next=5,regeneratorRuntime.awrap(this.generateSalt(t.identifier,t.version,t.pw_cost,t.pw_nonce));case 5:return n=i.sent,i.next=8,regeneratorRuntime.awrap(this.crypto.generateSymmetricKeyPair({password:e,pw_salt:n,pw_cost:t.pw_cost}));case 8:return r=i.sent,o={pw:r[0],mk:r[1],ak:r[2]},i.abrupt("return",o);case 11:case"end":return i.stop()}}),null,this)}},{key:"generateInitialKeysAndAuthParamsForUser",value:function(e,t){var n,r,o,i,a,s,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=this.constructor.versionString(),r=this.constructor.pwCost(),c.next=4,regeneratorRuntime.awrap(this.crypto.generateRandomKey(256));case 4:return o=c.sent,c.next=7,regeneratorRuntime.awrap(this.generateSalt(e,n,r,o));case 7:return i=c.sent,c.next=10,regeneratorRuntime.awrap(this.crypto.generateSymmetricKeyPair({password:t,pw_salt:i,pw_cost:r}));case 10:return a=c.sent,s={pw_nonce:o,pw_cost:r,identifier:e,version:n},u={pw:a[0],mk:a[1],ak:a[2]},c.abrupt("return",{keys:u,authParams:s});case 14:case"end":return c.stop()}}),null,this)}},{key:"_private_encryptString",value:function(e,t,n,r,o){var i,a,s,u,c,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,regeneratorRuntime.awrap(this.crypto.generateRandomKey(128));case 2:return s=f.sent,f.next=5,regeneratorRuntime.awrap(this.encryptText(e,t,s));case 5:return a=f.sent,u=[o.version,r,s,a].join(":"),f.next=9,regeneratorRuntime.awrap(this.crypto.hmac256(u,n));case 9:return c=f.sent,f.next=12,regeneratorRuntime.awrap(this.crypto.base64(JSON.stringify(o)));case 12:return l=f.sent,i=[o.version,c,r,s,a,l].join(":"),f.abrupt("return",i);case 15:case"end":return f.stop()}}),null,this)}},{key:"encryptItem",value:function(e,t,n){var r,o,i,a,s;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r={},u.next=3,regeneratorRuntime.awrap(this.crypto.generateItemEncryptionKey());case 3:return o=u.sent,u.next=6,regeneratorRuntime.awrap(this._private_encryptString(o,t.mk,t.ak,e.uuid,n));case 6:return r.enc_item_key=u.sent,u.next=9,regeneratorRuntime.awrap(this.crypto.firstHalfOfKey(o));case 9:return i=u.sent,u.next=12,regeneratorRuntime.awrap(this.crypto.secondHalfOfKey(o));case 12:return a=u.sent,u.next=15,regeneratorRuntime.awrap(this._private_encryptString(JSON.stringify(e.createContentJSONFromProperties()),i,a,e.uuid,n));case 15:return s=u.sent,r.content=s,u.abrupt("return",r);case 18:case"end":return u.stop()}}),null,this)}},{key:"encryptionComponentsFromString",value:function(e,t,n){e.substring(0,3);var r=e.split(":");return{encryptionVersion:r[0],authHash:r[1],uuid:r[2],iv:r[3],contentCiphertext:r[4],authParams:r[5],ciphertextToAuth:[r[0],r[2],r[3],r[4]].join(":"),encryptionKey:t,authKey:n}}},{key:"decryptItem",value:function(e,t){var n,r,o,i,a,s,u,c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:if("string"==typeof e.content){l.next=2;break}return l.abrupt("return");case 2:if(!e.content.startsWith("000")){l.next=14;break}return l.prev=3,l.t0=JSON,l.next=7,regeneratorRuntime.awrap(this.crypto.base64Decode(e.content.substring(3,e.content.length)));case 7:l.t1=l.sent,e.content=l.t0.parse.call(l.t0,l.t1),l.next=13;break;case 11:l.prev=11,l.t2=l.catch(3);case 13:return l.abrupt("return");case 14:if(e.enc_item_key){l.next=17;break}return console.log("Missing item encryption key, skipping decryption."),l.abrupt("return");case 17:if(n=e.enc_item_key,r=!0,!(o=this.encryptionComponentsFromString(n,t.mk,t.ak)).uuid||o.uuid===e.uuid){l.next=25;break}return console.error("Item key params UUID does not match item UUID"),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 25:return l.next=27,regeneratorRuntime.awrap(this.decryptText(o,r));case 27:if(i=l.sent){l.next=33;break}return console.log("Error decrypting item",e),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 33:return l.next=35,regeneratorRuntime.awrap(this.crypto.firstHalfOfKey(i));case 35:return a=l.sent,l.next=38,regeneratorRuntime.awrap(this.crypto.secondHalfOfKey(i));case 38:return s=l.sent,u=this.encryptionComponentsFromString(e.content,a,s),l.prev=40,l.t3=JSON,l.next=44,regeneratorRuntime.awrap(this.crypto.base64Decode(u.authParams));case 44:l.t4=l.sent,e.auth_params=l.t3.parse.call(l.t3,l.t4),l.next=50;break;case 48:l.prev=48,l.t5=l.catch(40);case 50:if(!u.uuid||u.uuid===e.uuid){l.next=54;break}return e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,l.abrupt("return");case 54:return l.next=56,regeneratorRuntime.awrap(this.decryptText(u,!0));case 56:(c=l.sent)?(1==e.errorDecrypting&&(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!1,e.content=c):(e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0);case 58:case"end":return l.stop()}}),null,this,[[3,11],[40,48]])}}])&&b(n.prototype,r),o&&b(n,o),t}(i),_=n(4);function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.operators=[],!t&&Object(_.d)()?Object(r.isWebCryptoAvailable)()?this.crypto=new r.SNWebCrypto:this.crypto=new r.SNCryptoJS:!t&&Object(_.c)()?this.crypto=new r.SNReactNativeCrypto:this.crypto=t}var t,n,o;return t=e,(n=[{key:"version",value:function(){return"003"}},{key:"supportsPasswordDerivationCost",value:function(e){return!(e>5e3)||this.crypto instanceof r.SNWebCrypto||this.crypto instanceof r.SNReactNativeCrypto}},{key:"supportedVersions",value:function(){return["001","002","003"]}},{key:"isVersionNewerThanLibraryVersion",value:function(e){var t=this.version();return parseInt(e)>parseInt(t)}},{key:"isProtocolVersionOutdated",value:function(e){var t={"001":Date.parse("2018-01-01"),"002":Date.parse("2020-01-01")}[e];return!!t&&new Date>t}},{key:"costMinimumForVersion",value:function(e){return{"001":f.pwCost(),"002":m.pwCost(),"003":w.pwCost()}[e]}},{key:"defaultPasswordGenerationCost",value:function(){return this.costMinimumForVersion(this.version())}},{key:"versionForItem",value:function(e){return e.content.substring(0,3)}},{key:"createOperatorForLatestVersion",value:function(){return this.createOperatorForVersion(this.version())}},{key:"createOperatorForVersion",value:function(e){if("001"===e)return new f(this.crypto);if("002"===e)return new m(this.crypto);if("003"===e)return new w(this.crypto);if("000"===e)return this.createOperatorForLatestVersion();throw"Unable to find operator for version ".concat(e)}},{key:"operatorForVersion",value:function(e){var t=e,n=this.operators[t];return n||(n=this.createOperatorForVersion(e),this.operators[t]=n),n}},{key:"defaultOperator",value:function(){return this.operatorForVersion(this.version())}},{key:"computeEncryptionKeysForUser",value:function(e,t){var n,r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=t.version,r=this.operatorForVersion(n),o.abrupt("return",r.computeEncryptionKeysForUser(e,t));case 3:case"end":return o.stop()}}),null,this)}},{key:"generateInitialKeysAndAuthParamsForUser",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.defaultOperator(),r.abrupt("return",n.generateInitialKeysAndAuthParamsForUser(e,t));case 2:case"end":return r.stop()}}),null,this)}},{key:"decryptItem",value:function(e,t){var n,r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this.versionForItem(e),r=this.operatorForVersion(n),o.abrupt("return",r.decryptItem(e,t));case 3:case"end":return o.stop()}}),null,this)}},{key:"encryptItem",value:function(e,t,n){var r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return r=n.version,o=this.operatorForVersion(r),i.abrupt("return",o.encryptItem(e,t,n));case 3:case"end":return i.stop()}}),null,this)}},{key:"decryptMultipleItems",value:function(e,t,n){var r,o=this;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return r=function(e){return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:if(!0!==e.deleted||null!==e.content){r.next=4;break}return r.abrupt("return");case 4:if(!("string"==typeof e.content||e.content instanceof String)){r.next=19;break}return r.prev=6,r.next=9,regeneratorRuntime.awrap(o.decryptItem(e,t));case 9:r.next=19;break;case 11:if(r.prev=11,r.t0=r.catch(6),e.errorDecrypting||(e.errorDecryptingValueChanged=!0),e.errorDecrypting=!0,!n){r.next=17;break}throw r.t0;case 17:return console.error("Error decrypting item",e,r.t0),r.abrupt("return");case 19:case"end":return r.stop()}}),null,null,[[6,11]])},i.abrupt("return",Promise.all(e.map((function(e){return r(e)}))));case 2:case"end":return i.stop()}}))}}])&&R(t.prototype,n),o&&R(t,o),e}(),O=new I,C=n(2),A=n.n(C),D=n(0),M=n.n(D),j=n(3),P=n.n(j),T=n(92),E=n.n(T);function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B,H=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keypath=t,this.operator=n,this.value=r,e.IsRecursiveOperator(this.operator)&&(this.value=this.value.map(e.fromArray))}var t,n,r;return t=e,r=[{key:"fromArray",value:function(t){return new e(t[0],t[1],t[2])}},{key:"ObjectSatisfiesPredicate",value:function(t,n){if(Array.isArray(n)&&(n=this.fromArray(n)),e.IsRecursiveOperator(n.operator)){if("and"===n.operator){var r=!0,o=!1,i=void 0;try{for(var a,s=n.value[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!this.ObjectSatisfiesPredicate(t,u))return!1}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return!0}if("or"===n.operator){var c=!0,l=!1,f=void 0;try{for(var p,y=n.value[Symbol.iterator]();!(c=(p=y.next()).done);c=!0)if(u=p.value,this.ObjectSatisfiesPredicate(t,u))return!0}catch(e){l=!0,f=e}finally{try{c||null==y.return||y.return()}finally{if(l)throw f}}return!1}}var h=n.value;"string"==typeof h&&h.includes(".ago")&&(h=this.DateFromString(h));var d=n.keypath.split(".").reduce((function(e,t){return e&&e[t]}),t),v=[!1,"",null,void 0,NaN];return null==d?"!="==n.operator?!v.includes(n.value):v.includes(n.value):"="==n.operator?Array.isArray(d)?JSON.stringify(d)==JSON.stringify(h):d==h:"!="==n.operator?Array.isArray(d)?JSON.stringify(d)!=JSON.stringify(h):d!==h:"<"==n.operator?d<h:">"==n.operator?d>h:"<="==n.operator?d<=h:">="==n.operator?d>=h:"startsWith"==n.operator?d.startsWith(h):"in"==n.operator?-1!=h.indexOf(d):"includes"==n.operator?this.resolveIncludesPredicate(d,h):"matches"==n.operator&&new RegExp(h).test(d)}},{key:"resolveIncludesPredicate",value:function(t,n){if("string"==typeof n)return t.includes(n);var r;r=Array.isArray(n)?e.fromArray(n):n;var o=!0,i=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;if(this.ObjectSatisfiesPredicate(c,r))return!0}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}return!1}},{key:"ItemSatisfiesPredicate",value:function(t,n){return Array.isArray(n)&&(n=e.fromArray(n)),this.ObjectSatisfiesPredicate(t,n)}},{key:"ItemSatisfiesPredicates",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(!this.ItemSatisfiesPredicate(e,s))return!1}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!0}},{key:"DateFromString",value:function(e){var t=e.split("."),n=t[1],r=new Date,o=parseInt(t[0]);return"days"==n?r.setDate(r.getDate()-o):"hours"==n&&r.setHours(r.getHours()-o),r}},{key:"IsRecursiveOperator",value:function(e){return["and","or"].includes(e)}}],(n=null)&&F(t.prototype,n),r&&F(t,r),e}();function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.content={},this.referencingObjects=[],this.updateFromJSON(t),this.uuid||Object(_.d)()&&(this.uuid=O.crypto.generateUUIDSync()),"object"!==L(this.content)||this.content.references||(this.content.references=[])}var t,n,r;return t=e,r=[{key:"deepMerge",value:function(e,t){return E()(e,t,(function(e,t){if(P()(e))return t})),e}},{key:"AreItemContentsEqual",value:function(t){var n=t.leftContent,r=t.rightContent,o=t.keysToIgnore,i=t.appDataKeysToIgnore,a=function(e,t){if(!e)return e;var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)delete e[i.value]}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return e};return(n=JSON.parse(JSON.stringify(n))).appData&&a(n.appData[e.AppDomain],i),n=a(n,o),(r=JSON.parse(JSON.stringify(r))).appData&&a(r.appData[e.AppDomain],i),r=a(r,o),JSON.stringify(n)===JSON.stringify(r)}}],(n=[{key:"initUUID",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.uuid){e.next=4;break}return e.next=3,regeneratorRuntime.awrap(O.crypto.generateUUID());case 3:this.uuid=e.sent;case 4:case"end":return e.stop()}}),null,this)}},{key:"updateFromJSON",value:function(t){if(t){this.deleted=t.deleted,this.uuid=t.uuid,this.enc_item_key=t.enc_item_key,this.auth_hash=t.auth_hash,this.auth_params=t.auth_params;for(var n=0,r=["errorDecrypting","dirty","dirtyCount","dirtiedDate","dummy"];n<r.length;n++){var o=r[n];void 0!==t[o]&&(this[o]=t[o])}if(this.dirtiedDate&&"string"==typeof this.dirtiedDate&&(this.dirtiedDate=new Date(this.dirtiedDate)),this.content_type||(this.content_type=t.content_type),t.errorDecrypting)this.content=t.content;else try{var i="string"==typeof t.content?JSON.parse(t.content):t.content;e.deepMerge(this.contentObject,i)}catch(e){console.log("Error while updating item from json",e)}t.created_at&&(this.created_at=t.created_at),t.updated_at&&(this.updated_at=t.updated_at),this.created_at?this.created_at=new Date(this.created_at):this.created_at=new Date,this.updated_at?this.updated_at=new Date(this.updated_at):this.updated_at=new Date(0),this._client_updated_at=null,t.content?this.mapContentToLocalProperties(this.contentObject):1==t.deleted&&this.handleDeletedContent()}}},{key:"mapContentToLocalProperties",value:function(e){}},{key:"collapseCustomPropertiesIntoContent",value:function(){this.createContentJSONFromProperties()}},{key:"createContentJSONFromProperties",value:function(){var t=this.structureParams();return e.deepMerge(this.contentObject,t),t}},{key:"structureParams",value:function(){return this.getContentCopy()}},{key:"handleDeletedContent",value:function(){}},{key:"setDirty",value:function(e,t){this.dirty=e,this.dirtyCount||(this.dirtyCount=0),e?this.dirtyCount++:this.dirtyCount=0,this.dirtiedDate=new Date,e&&t?this.client_updated_at=new Date:this.hasRawClientUpdatedAtValue()||(this.client_updated_at=new Date(this.updated_at)),this.collapseCustomPropertiesIntoContent()}},{key:"updateLocalRelationships",value:function(){}},{key:"addItemAsRelationship",value:function(e){if(e.setIsBeingReferencedBy(this),!this.hasRelationshipWithItem(e)){var t=this.content.references||[];t.push({uuid:e.uuid,content_type:e.content_type}),this.content.references=t}}},{key:"removeItemAsRelationship",value:function(e){e.setIsNoLongerBeingReferencedBy(this),this.removeReferenceWithUuid(e.uuid)}},{key:"setIsBeingReferencedBy",value:function(e){A()(this.referencingObjects,{uuid:e.uuid})||this.referencingObjects.push(e)}},{key:"setIsNoLongerBeingReferencedBy",value:function(e){M()(this.referencingObjects,{uuid:e.uuid}),this.hasRelationshipWithItem(e)&&(this.removeReferenceWithUuid(e.uuid),this.setDirty(!0))}},{key:"removeReferenceWithUuid",value:function(e){var t=this.content.references||[];t=t.filter((function(t){return t.uuid!=e})),this.content.references=t}},{key:"hasRelationshipWithItem",value:function(e){return null!=this.content.references.find((function(t){return t.uuid==e.uuid}))}},{key:"isBeingRemovedLocally",value:function(){}},{key:"didFinishSyncing",value:function(){}},{key:"informReferencesOfUUIDChange",value:function(e,t){}},{key:"potentialItemOfInterestHasChangedItsUUID",value:function(e,t,n){if(!this.errorDecrypting){var r=!0,o=!1,i=void 0;try{for(var a,s=this.content.references[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.uuid==t&&(u.uuid=n,this.setDirty(!0))}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}}},{key:"doNotEncrypt",value:function(){return!1}},{key:"setDomainDataItem",value:function(e,t,n){if(n){if(!this.errorDecrypting){this.content.appData||(this.content.appData={});var r=this.content.appData[n];r||(r={}),r[e]=t,this.content.appData[n]=r}}else console.error("SFItem.AppDomain needs to be set.")}},{key:"getDomainDataItem",value:function(e,t){if(t){if(!this.errorDecrypting){this.content.appData||(this.content.appData={});var n=this.content.appData[t];return n?n[e]:null}}else console.error("SFItem.AppDomain needs to be set.")}},{key:"setAppDataItem",value:function(t,n){this.setDomainDataItem(t,n,e.AppDomain)}},{key:"getAppDataItem",value:function(t){return this.getDomainDataItem(t,e.AppDomain)}},{key:"hasRawClientUpdatedAtValue",value:function(){return null!=this.getAppDataItem("client_updated_at")}},{key:"keysToIgnoreWhenCheckingContentEquality",value:function(){return[]}},{key:"appDataKeysToIgnoreWhenCheckingContentEquality",value:function(){return["client_updated_at"]}},{key:"getContentCopy",value:function(){return JSON.parse(JSON.stringify(this.content))}},{key:"isItemContentEqualWith",value:function(t){return e.AreItemContentsEqual({leftContent:this.content,rightContent:t.content,keysToIgnore:this.keysToIgnoreWhenCheckingContentEquality(),appDataKeysToIgnore:this.appDataKeysToIgnoreWhenCheckingContentEquality()})}},{key:"isContentEqualWithNonItemContent",value:function(t){return e.AreItemContentsEqual({leftContent:this.content,rightContent:t,keysToIgnore:this.keysToIgnoreWhenCheckingContentEquality(),appDataKeysToIgnore:this.appDataKeysToIgnoreWhenCheckingContentEquality()})}},{key:"satisfiesPredicate",value:function(e){return H.ItemSatisfiesPredicate(this,e)}},{key:"createdAtString",value:function(){return this.dateToLocalizedString(this.created_at)}},{key:"updatedAtString",value:function(){return this.dateToLocalizedString(this.client_updated_at)}},{key:"updatedAtTimestamp",value:function(){return this.updated_at.getTime()}},{key:"dateToLocalizedString",value:function(e){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){if(!B){var t=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language;B=new Intl.DateTimeFormat(t,{year:"numeric",month:"short",day:"2-digit",weekday:"long",hour:"2-digit",minute:"2-digit"})}return B.format(e)}return e.toDateString()+" "+e.toLocaleTimeString()}},{key:"contentObject",get:function(){if(this.errorDecrypting)return this.content;if(!this.content)return this.content={},this.content;if(null!==this.content&&"object"===L(this.content))return this.content;try{var e=JSON.parse(this.content);return this.content=e,this.content}catch(e){return console.log("Error parsing json",e,this),this.content={},this.content}}},{key:"pinned",get:function(){return this.getAppDataItem("pinned")}},{key:"archived",get:function(){return this.getAppDataItem("archived")}},{key:"locked",get:function(){return this.getAppDataItem("locked")}},{key:"displayName",get:function(){return"Item"}},{key:"client_updated_at",get:function(){if(!this._client_updated_at){var e=this.getAppDataItem("client_updated_at");this._client_updated_at=e?new Date(e):new Date(this.updated_at)}return this._client_updated_at},set:function(e){this._client_updated_at=e,this.setAppDataItem("client_updated_at",e)}}])&&N(t.prototype,n),r&&N(t,r),e}(),K=n(36),z=n.n(K),W=n(9),q=n.n(W),J=n(93),V=n.n(J);function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(t,n,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.item=t,this.keys=n,this.auth_params=r,this.keys&&!this.auth_params)throw"SFItemParams.auth_params must be supplied if supplying keys.";if(this.auth_params&&!this.auth_params.version)throw"SFItemParams.auth_params is missing version"}var t,n,r;return t=e,(n=[{key:"paramsForExportFile",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.forExportFile=!0,!e){n.next=5;break}return n.abrupt("return",this.__params());case 5:return n.next=7,regeneratorRuntime.awrap(this.__params());case 7:return t=n.sent,n.abrupt("return",z()(t,["deleted"]));case 9:case"end":return n.stop()}}),null,this)}},{key:"paramsForExtension",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.paramsForExportFile());case 1:case"end":return e.stop()}}),null,this)}},{key:"paramsForLocalStorage",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.additionalFields=["dirty","dirtiedDate","errorDecrypting"],this.forExportFile=!0,e.abrupt("return",this.__params());case 3:case"end":return e.stop()}}),null,this)}},{key:"paramsForSync",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.__params());case 1:case"end":return e.stop()}}),null,this)}},{key:"__params",value:function(){var e,t,n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e={uuid:this.item.uuid,content_type:this.item.content_type,deleted:this.item.deleted,created_at:this.item.created_at,updated_at:this.item.updated_at},this.item.errorDecrypting){r.next=23;break}if(t=this.item.doNotEncrypt()&&!this.forExportFile,!this.keys||t){r.next=11;break}return r.next=6,regeneratorRuntime.awrap(O.encryptItem(this.item,this.keys,this.auth_params));case 6:n=r.sent,q()(e,n),"001"!==this.auth_params.version&&(e.auth_hash=null),r.next=21;break;case 11:if(!this.forExportFile){r.next=15;break}r.t0=this.item.createContentJSONFromProperties(),r.next=19;break;case 15:return r.next=17,regeneratorRuntime.awrap(O.crypto.base64(JSON.stringify(this.item.createContentJSONFromProperties())));case 17:r.t1=r.sent,r.t0="000"+r.t1;case 19:e.content=r.t0,this.forExportFile||(e.enc_item_key=null,e.auth_hash=null);case 21:r.next=26;break;case 23:e.content=this.item.content,e.enc_item_key=this.item.enc_item_key,e.auth_hash=this.item.auth_hash;case 26:return this.additionalFields&&q()(e,V()(this.item,this.additionalFields)),r.abrupt("return",e);case 28:case"end":return r.stop()}}),null,this)}}])&&$(t.prototype,n),r&&$(t,r),e}();function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e,t,n){return(Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ee(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Y(this,ee(t).call(this,e))).content_type||(n.content_type="Tag"),n.notes||(n.notes=[]),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,e),n=t,o=[{key:"arrayToDisplayString",value:function(e){return e.sort((function(e,t){return e.title>t.title})).map((function(e,t){return"#"+e.title})).join(" ")}}],(r=[{key:"mapContentToLocalProperties",value:function(e){Z(ee(t.prototype),"mapContentToLocalProperties",this).call(this,e),this.title=e.title}},{key:"structureParams",value:function(){var e={title:this.title},n=Z(ee(t.prototype),"structureParams",this).call(this);return Object.assign(n,e),n}},{key:"addItemAsRelationship",value:function(e){"Note"==e.content_type&&(Object(_.a)(this.notes,"uuid",e.uuid)||(this.notes.push(e),e.tags.push(this))),Z(ee(t.prototype),"addItemAsRelationship",this).call(this,e)}},{key:"removeItemAsRelationship",value:function(e){"Note"==e.content_type&&(M()(this.notes,{uuid:e.uuid}),M()(e.tags,{uuid:this.uuid})),Z(ee(t.prototype),"removeItemAsRelationship",this).call(this,e)}},{key:"updateLocalRelationships",value:function(){var e=this.content.references.map((function(e){return e.uuid}));this.notes.slice().forEach(function(t){e.includes(t.uuid)||(M()(t.tags,{uuid:this.uuid}),M()(this.notes,{uuid:t.uuid}),t.setIsNoLongerBeingReferencedBy(this))}.bind(this))}},{key:"isBeingRemovedLocally",value:function(){var e=this;this.notes.forEach((function(t){M()(t.tags,{uuid:e.uuid}),t.setIsNoLongerBeingReferencedBy(e)})),this.notes.length=0,Z(ee(t.prototype),"isBeingRemovedLocally",this).call(this)}},{key:"informReferencesOfUUIDChange",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.notes[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;M()(s.tags,{uuid:e}),s.tags.push(this)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"didFinishSyncing",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.notes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0)r.value.tagDidFinishSyncing(this)}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"isSmartTag",value:function(){return"SN|SmartTag"==this.content_type}},{key:"displayName",get:function(){return"Tag"}}])&&Q(n.prototype,r),o&&Q(n,o),t}(U);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ae(e,t,n){return(ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=se(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ie(this,se(t).call(this,e))).text||(n.text=""),n.tags||(n.tags=[]),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,e),n=t,o=[{key:"filterDummyNotes",value:function(e){return e.filter((function(e){return 0==e.dummy||null==e.dummy}))}}],(r=[{key:"mapContentToLocalProperties",value:function(e){ae(se(t.prototype),"mapContentToLocalProperties",this).call(this,e),this.title=e.title,this.text=e.text}},{key:"structureParams",value:function(){var e={title:this.title,text:this.text},n=ae(se(t.prototype),"structureParams",this).call(this);return Object.assign(n,e),n}},{key:"addItemAsRelationship",value:function(e){"Tag"==e.content_type&&e.addItemAsRelationship(this),ae(se(t.prototype),"addItemAsRelationship",this).call(this,e)}},{key:"setIsBeingReferencedBy",value:function(e){ae(se(t.prototype),"setIsBeingReferencedBy",this).call(this,e),this.clearSavedTagsString()}},{key:"setIsNoLongerBeingReferencedBy",value:function(e){ae(se(t.prototype),"setIsNoLongerBeingReferencedBy",this).call(this,e),this.clearSavedTagsString()}},{key:"isBeingRemovedLocally",value:function(){this.tags.forEach(function(e){M()(e.notes,{uuid:this.uuid})}.bind(this)),ae(se(t.prototype),"isBeingRemovedLocally",this).call(this)}},{key:"informReferencesOfUUIDChange",value:function(e,n){ae(se(t.prototype),"informReferencesOfUUIDChange",this).call(this);var r=!0,o=!1,i=void 0;try{for(var a,s=this.tags[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;M()(u.notes,{uuid:e}),u.notes.push(this)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"tagDidFinishSyncing",value:function(e){this.clearSavedTagsString()}},{key:"safeText",value:function(){return this.text||""}},{key:"safeTitle",value:function(){return this.title||""}},{key:"clearSavedTagsString",value:function(){this.savedTagsString=null}},{key:"tagsString",value:function(){return this.savedTagsString=ne.arrayToDisplayString(this.tags),this.savedTagsString}},{key:"content_type",get:function(){return"Note"}},{key:"displayName",get:function(){return"Note"}}])&&oe(n.prototype,r),o&&oe(n,o),t}(U);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return!t||"object"!==le(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var de=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=pe(this,ye(t).call(this,e))).content_type="SN|SmartTag",n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,e),n=t,o=[{key:"systemSmartTags",value:function(){return[new t({uuid:t.SystemSmartTagIdAllNotes,dummy:!0,content:{title:"All notes",isSystemTag:!0,isAllTag:!0,predicate:new H.fromArray(["content_type","=","Note"])}}),new t({uuid:t.SystemSmartTagIdArchivedNotes,dummy:!0,content:{title:"Archived",isSystemTag:!0,isArchiveTag:!0,predicate:new H.fromArray(["archived","=",!0])}}),new t({uuid:t.SystemSmartTagIdTrashedNotes,dummy:!0,content:{title:"Trash",isSystemTag:!0,isTrashTag:!0,predicate:new H.fromArray(["content.trashed","=",!0])}})]}}],(r=null)&&fe(n.prototype,r),o&&fe(n,o),t}(ne);function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ge(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e,t){return(xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}de.SystemSmartTagIdAllNotes="all-notes",de.SystemSmartTagIdArchivedNotes="archived-notes",de.SystemSmartTagIdTrashedNotes="trashed-notes";var Se=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ge(this,be(t).call(this,e))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xe(e,t)}(t,e),n=t,(r=[{key:"doNotEncrypt",value:function(){return!0}},{key:"content_type",get:function(){return"SF|MFA"}}])&&me(n.prototype,r),o&&me(n,o),t}(U);function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e,t,n){return(Re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ie(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ce=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_e(this,Ie(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,e),n=t,(r=[{key:"mapContentToLocalProperties",value:function(e){Re(Ie(t.prototype),"mapContentToLocalProperties",this).call(this,e),this.url=e.url}},{key:"doNotEncrypt",value:function(){return!0}},{key:"content_type",get:function(){return"SF|Extension"}}])&&we(n.prototype,r),o&&we(n,o),t}(U);function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e,t,n){return(je="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ee=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.window=null,(n=Me(this,Pe(t).call(this,e))).componentData||(n.componentData={}),n.disassociatedItemIds||(n.disassociatedItemIds=[]),n.associatedItemIds||(n.associatedItemIds=[]),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(t,e),n=t,o=[{key:"associativeAreas",value:function(){return["editor-editor"]}}],(r=[{key:"mapContentToLocalProperties",value:function(e){je(Pe(t.prototype),"mapContentToLocalProperties",this).call(this,e),e.hosted_url||(this.legacy_url=e.url),this.local_url=e.local_url,this.hosted_url=e.hosted_url||e.url,this.offlineOnly=e.offlineOnly,e.valid_until&&(this.valid_until=new Date(e.valid_until)),this.name=e.name,this.autoupdateDisabled=e.autoupdateDisabled,this.package_info=e.package_info,this.area=e.area,this.permissions=e.permissions,this.permissions||(this.permissions=[]),this.active=e.active,this.componentData=e.componentData||{},this.disassociatedItemIds=e.disassociatedItemIds||[],this.associatedItemIds=e.associatedItemIds||[]}},{key:"handleDeletedContent",value:function(){je(Pe(t.prototype),"handleDeletedContent",this).call(this),this.active=!1}},{key:"structureParams",value:function(){var e={legacy_url:this.legacy_url,hosted_url:this.hosted_url,local_url:this.local_url,valid_until:this.valid_until,offlineOnly:this.offlineOnly,name:this.name,area:this.area,package_info:this.package_info,permissions:this.permissions,active:this.active,autoupdateDisabled:this.autoupdateDisabled,componentData:this.componentData,disassociatedItemIds:this.disassociatedItemIds,associatedItemIds:this.associatedItemIds},n=je(Pe(t.prototype),"structureParams",this).call(this);return Object.assign(n,e),n}},{key:"isEditor",value:function(){return"editor-editor"==this.area}},{key:"isTheme",value:function(){return"SN|Theme"==this.content_type||"themes"==this.area}},{key:"isDefaultEditor",value:function(){return 1==this.getAppDataItem("defaultEditor")}},{key:"setLastSize",value:function(e){this.setAppDataItem("lastSize",e)}},{key:"getLastSize",value:function(){return this.getAppDataItem("lastSize")}},{key:"acceptsThemes",value:function(){return!(this.content.package_info&&"acceptsThemes"in this.content.package_info)||this.content.package_info.acceptsThemes}},{key:"getClientDataKey",value:function(){return this.legacy_url?this.legacy_url:this.uuid}},{key:"hasValidHostedUrl",value:function(){return this.hosted_url||this.legacy_url}},{key:"keysToIgnoreWhenCheckingContentEquality",value:function(){return["active","disassociatedItemIds","associatedItemIds"].concat(je(Pe(t.prototype),"keysToIgnoreWhenCheckingContentEquality",this).call(this))}},{key:"isAssociative",value:function(){return Component.associativeAreas().includes(this.area)}},{key:"associateWithItem",value:function(e){this.associatedItemIds.push(e.uuid)}},{key:"isExplicitlyEnabledForItem",value:function(e){return-1!==this.associatedItemIds.indexOf(e.uuid)}},{key:"isExplicitlyDisabledForItem",value:function(e){return-1!==this.disassociatedItemIds.indexOf(e.uuid)}},{key:"content_type",get:function(){return"SN|Component"}}])&&De(n.prototype,r),o&&De(n,o),t}(U),Fe=n(94),Be=n.n(Fe),He=n(1),Le=n.n(He);function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ke(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ze(e,t,n){return(ze="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=We(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qe(e,t){return(qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Je=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ke(this,We(t).call(this,e))).notes||(n.notes=[]),n.data||(n.data={}),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(t,e),n=t,(r=[{key:"mapContentToLocalProperties",value:function(e){ze(We(t.prototype),"mapContentToLocalProperties",this).call(this,e),this.url=e.url,this.name=e.name,this.data=e.data||{},this.default=e.default,this.systemEditor=e.systemEditor}},{key:"structureParams",value:function(){var e={url:this.url,name:this.name,data:this.data,default:this.default,systemEditor:this.systemEditor},n=ze(We(t.prototype),"structureParams",this).call(this);return Object.assign(n,e),n}},{key:"referenceParams",value:function(){return Be()(this.notes,(function(e){return{uuid:e.uuid,content_type:e.content_type}}))}},{key:"addItemAsRelationship",value:function(e){"Note"==e.content_type&&(A()(this.notes,e)||this.notes.push(e)),ze(We(t.prototype),"addItemAsRelationship",this).call(this,e)}},{key:"removeItemAsRelationship",value:function(e){"Note"==e.content_type&&Le()(this.notes,e),ze(We(t.prototype),"removeItemAsRelationship",this).call(this,e)}},{key:"removeAndDirtyAllRelationships",value:function(){ze(We(t.prototype),"removeAndDirtyAllRelationships",this).call(this),this.notes=[]}},{key:"removeReferencesNotPresentIn",value:function(e){ze(We(t.prototype),"removeReferencesNotPresentIn",this).call(this,e);var n=e.map((function(e){return e.uuid}));this.notes.forEach(function(e){n.includes(e.uuid)||M()(this.notes,{uuid:e.uuid})}.bind(this))}},{key:"potentialItemOfInterestHasChangedItsUUID",value:function(e,t,n){"Note"===e.content_type&&A()(this.notes,{uuid:t})&&(M()(this.notes,{uuid:t}),this.notes.push(e))}},{key:"setData",value:function(e,t){return!(JSON.stringify(this.data[e])===JSON.stringify(t)||(this.data[e]=t,0))}},{key:"dataForKey",value:function(e){return this.data[e]||{}}},{key:"content_type",get:function(){return"SN|Editor"}}])&&Ue(n.prototype,r),o&&Ue(n,o),t}(U);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ge(e,t,n){return(Ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var et=function e(t){Ze(this,e),q()(this,t),this.running=!1,this.error=!1,this.lastExecuted&&(this.lastExecuted=new Date(this.lastExecuted))},tt=function(e){function t(e){var n;return Ze(this,t),n=Xe(this,Qe(t).call(this,e)),e.actions&&(n.actions=e.actions.map((function(e){return new et(e)}))),n.actions||(n.actions=[]),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,e),n=t,(r=[{key:"actionsWithContextForItem",value:function(e){return this.actions.filter((function(t){return t.context==e.content_type||"Item"==t.context}))}},{key:"mapContentToLocalProperties",value:function(e){Ge(Qe(t.prototype),"mapContentToLocalProperties",this).call(this,e),this.description=e.description,this.url=e.url,this.name=e.name,this.package_info=e.package_info,this.supported_types=e.supported_types,e.actions&&(this.actions=e.actions.map((function(e){return new et(e)})))}},{key:"structureParams",value:function(){var e={name:this.name,url:this.url,package_info:this.package_info,description:this.description,actions:this.actions.map((function(e){return z()(e,["subrows","subactions"])})),supported_types:this.supported_types},n=Ge(Qe(t.prototype),"structureParams",this).call(this);return Object.assign(n,e),n}},{key:"content_type",get:function(){return"Extension"}}])&&$e(n.prototype,r),o&&$e(n,o),t}(U);function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t){return!t||"object"!==nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var st=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ot(this,it(t).call(this,e))).area="themes",n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(t,e),n=t,(r=[{key:"isLayerable",value:function(){return this.package_info&&this.package_info.layerable}},{key:"setMobileRules",value:function(e){this.setAppDataItem("mobileRules",e)}},{key:"getMobileRules",value:function(){return this.getAppDataItem("mobileRules")||{constants:{},rules:{}}}},{key:"hasMobileRules",value:function(){return this.getAppDataItem("mobileRules")}},{key:"setNotAvailOnMobile",value:function(e){this.setAppDataItem("notAvailableOnMobile",e)}},{key:"getNotAvailOnMobile",value:function(){return this.getAppDataItem("notAvailableOnMobile")}},{key:"setMobileActive",value:function(e){this.setAppDataItem("mobileActive",e)}},{key:"isMobileActive",value:function(){return this.getAppDataItem("mobileActive")}},{key:"content_type",get:function(){return"SN|Theme"}},{key:"displayName",get:function(){return"Theme"}}])&&rt(n.prototype,r),o&&rt(n,o),t}(Ee);function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t){return!t||"object"!==ut(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ft(e,t,n){return(ft="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ht=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lt(this,pt(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(t,e),n=t,(r=[{key:"mapContentToLocalProperties",value:function(e){ft(pt(t.prototype),"mapContentToLocalProperties",this).call(this,e),this.storage=e.storage}},{key:"content_type",get:function(){return"SN|EncryptedStorage"}}])&&ct(n.prototype,r),o&&ct(n,o),t}(U),dt=n(21),vt=n.n(dt),mt=n(55),gt=n.n(mt);function bt(e){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xt(e,t){return!t||"object"!==bt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t,n){return t&&kt(e.prototype,t),n&&kt(e,n),e}function _t(e,t){return(_t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=xt(this,St(t).call(this,e))).content.desktopPrivileges||(n.content.desktopPrivileges={}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_t(e,t)}(t,e),wt(t,null,[{key:"contentType",value:function(){return"SN|Privileges"}}]),wt(t,[{key:"setCredentialsForAction",value:function(e,t){this.content.desktopPrivileges[e]=t}},{key:"getCredentialsForAction",value:function(e){return this.content.desktopPrivileges[e]||[]}},{key:"toggleCredentialForAction",value:function(e,t){this.isCredentialRequiredForAction(e,t)?this.removeCredentialForAction(e,t):this.addCredentialForAction(e,t)}},{key:"removeCredentialForAction",value:function(e,t){Le()(this.content.desktopPrivileges[e],t)}},{key:"addCredentialForAction",value:function(e,t){var n=this.getCredentialsForAction(e);n.push(t),this.setCredentialsForAction(e,n)}},{key:"isCredentialRequiredForAction",value:function(e,t){return this.getCredentialsForAction(e).includes(t)}}]),t}(U);function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ct=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.MappingSourceRemoteRetrieved="MappingSourceRemoteRetrieved",e.MappingSourceRemoteSaved="MappingSourceRemoteSaved",e.MappingSourceLocalSaved="MappingSourceLocalSaved",e.MappingSourceLocalRetrieved="MappingSourceLocalRetrieved",e.MappingSourceLocalDirtied="MappingSourceLocalDirtied",e.MappingSourceComponentRetrieved="MappingSourceComponentRetrieved",e.MappingSourceDesktopInstalled="MappingSourceDesktopInstalled",e.MappingSourceRemoteActionRetrieved="MappingSourceRemoteActionRetrieved",e.MappingSourceFileImport="MappingSourceFileImport",e.ContentTypeClassMapping={Note:ce,Tag:ne,"SN|SmartTag":de,Extension:tt,"SN|Editor":Je,"SN|Theme":st,"SN|Component":Ee,"SF|Extension":Ce,"SF|MFA":Se,"SN|Privileges":Rt},e.isMappingSourceRetrieved=function(t){return[e.MappingSourceRemoteRetrieved,e.MappingSourceComponentRetrieved,e.MappingSourceRemoteActionRetrieved].includes(t)},this.$timeout=t||setTimeout.bind(window),this.itemSyncObservers=[],this.items=[],this.itemsHash={},this.missedReferences={},this.uuidChangeObservers=[]}var t,n,r;return t=e,(n=[{key:"handleSignout",value:function(){this.items.length=0,this.itemsHash={},this.missedReferences={}}},{key:"addModelUuidChangeObserver",value:function(e,t){this.uuidChangeObservers.push({id:e,callback:t})}},{key:"notifyObserversOfUuidChange",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.uuidChangeObservers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;try{s.callback(e,t)}catch(e){console.error("Notify observers of uuid change exception:",e)}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"alternateUUIDForItem",value:function(t){var n,r,o,i,a,s,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=this.createItem(t),c.next=3,regeneratorRuntime.awrap(O.crypto.generateUUID());case 3:for(n.uuid=c.sent,n.informReferencesOfUUIDChange(t.uuid,n.uuid),this.informModelsOfUUIDChangeForItem(n,t.uuid,n.uuid),r=!0,o=!1,i=void 0,c.prev=9,a=t.referencingObjects[Symbol.iterator]();!(r=(s=a.next()).done);r=!0)(u=s.value).setIsNoLongerBeingReferencedBy(t),t.setIsNoLongerBeingReferencedBy(u),u.addItemAsRelationship(n);c.next=17;break;case 13:c.prev=13,c.t0=c.catch(9),o=!0,i=c.t0;case 17:c.prev=17,c.prev=18,r||null==a.return||a.return();case 20:if(c.prev=20,!o){c.next=23;break}throw i;case 23:return c.finish(20);case 24:return c.finish(17);case 25:return this.setItemsDirty(t.referencingObjects,!0),this.resolveReferencesForItem(n),this.loggingEnabled&&console.log(t.uuid,"--\x3e",n.uuid),t.deleted=!0,t.content.references=[],this.setItemDirty(t,!1,!1,e.MappingSourceLocalSaved),c.next=33,regeneratorRuntime.awrap(this.mapResponseItemsToLocalModels([t],e.MappingSourceLocalSaved));case 33:return this.addItem(n),this.setItemDirty(n,!0,!0,e.MappingSourceLocalSaved),this.notifyObserversOfUuidChange(t,n),c.abrupt("return",n);case 37:case"end":return c.stop()}}),null,this,[[9,13,17,25],[18,,20,24]])}},{key:"informModelsOfUUIDChangeForItem",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,s=this.items[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.potentialItemOfInterestHasChangedItsUUID(e,t,n)}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}},{key:"didSyncModelsOffline",value:function(t){this.notifySyncObserversOfModels(t,e.MappingSourceLocalSaved)}},{key:"mapResponseItemsToLocalModels",value:function(e,t,n){return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.mapResponseItemsToLocalModelsWithOptions({items:e,source:t,sourceKey:n}));case 1:case"end":return r.stop()}}),null,this)}},{key:"mapResponseItemsToLocalModelsOmittingFields",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.mapResponseItemsToLocalModelsWithOptions({items:e,omitFields:t,source:n,sourceKey:r}));case 1:case"end":return o.stop()}}),null,this)}},{key:"mapResponseItemsToLocalModelsWithOptions",value:function(e){var t,n,r,o,i,a,s,u,c,l,f,p,y,h,d,v,m,g,b,x,S,k,w,_,R,I,O,C,A,D,M,j,P,T,E,F,B,H,L;return regeneratorRuntime.async((function(N){for(;;)switch(N.prev=N.next){case 0:t=e.items,n=e.omitFields,r=e.source,o=e.sourceKey,e.options,i=[],a=[],s=[],u=!0,c=!1,l=void 0,N.prev=5,f=t[Symbol.iterator]();case 7:if(u=(p=f.next()).done){N.next=58;break}if(y=p.value){N.next=11;break}return N.abrupt("continue",55);case 11:if(h=!y.content&&!y.errorDecrypting,y.content_type&&y.uuid&&!h||y.deleted){N.next=16;break}return console.error("Server response item is corrupt:",y),N.abrupt("continue",55);case 16:if(!Array.isArray(n)){N.next=36;break}for(d=!0,v=!1,m=void 0,N.prev=20,g=n[Symbol.iterator]();!(d=(b=g.next()).done);d=!0)x=b.value,delete y[x];N.next=28;break;case 24:N.prev=24,N.t0=N.catch(20),v=!0,m=N.t0;case 28:N.prev=28,N.prev=29,d||null==g.return||g.return();case 31:if(N.prev=31,!v){N.next=34;break}throw m;case 34:return N.finish(31);case 35:return N.finish(28);case 36:if((S=this.findItem(y.uuid))&&(S.updateFromJSON(y),S.dummy=!1),k=y.content_type||S&&S.content_type,!this.acceptableContentTypes||this.acceptableContentTypes.includes(k)){N.next=42;break}return N.abrupt("continue",55);case 42:if(w=!1,1!=y.deleted){N.next=50;break}if(!y.dirty){N.next=48;break}w=!0,N.next=50;break;case 48:return S&&(i.push(S),s.push(S),this.removeItemLocally(S)),N.abrupt("continue",55);case 50:S||(S=this.createItem(y)),this.addItem(S,w),S.errorDecrypting||s.push(S),i.push(S),a.push(y);case 55:u=!0,N.next=7;break;case 58:N.next=64;break;case 60:N.prev=60,N.t1=N.catch(5),c=!0,l=N.t1;case 64:N.prev=64,N.prev=65,u||null==f.return||f.return();case 67:if(N.prev=67,!c){N.next=70;break}throw l;case 70:return N.finish(67);case 71:return N.finish(64);case 72:for(_=!0,R=!1,I=void 0,N.prev=75,O=a.entries()[Symbol.iterator]();!(_=(C=O.next()).done);_=!0)A=It(C.value,2),D=A[0],M=A[1],j=i[D],M.content&&this.resolveReferencesForItem(j),j.didFinishSyncing();N.next=83;break;case 79:N.prev=79,N.t2=N.catch(75),R=!0,I=N.t2;case 83:N.prev=83,N.prev=84,_||null==O.return||O.return();case 86:if(N.prev=86,!R){N.next=89;break}throw I;case 89:return N.finish(86);case 90:return N.finish(83);case 91:for(P=this.popMissedReferenceStructsForObjects(a),T=!0,E=!1,F=void 0,N.prev=95,B=function(){var e=L.value,t=i.find((function(t){return t.uuid==e.reference_uuid}));t&&e.for_item.addItemAsRelationship(t)},H=P[Symbol.iterator]();!(T=(L=H.next()).done);T=!0)B();N.next=104;break;case 100:N.prev=100,N.t3=N.catch(95),E=!0,F=N.t3;case 104:N.prev=104,N.prev=105,T||null==H.return||H.return();case 107:if(N.prev=107,!E){N.next=110;break}throw F;case 110:return N.finish(107);case 111:return N.finish(104);case 112:return N.next=114,regeneratorRuntime.awrap(this.notifySyncObserversOfModels(s,r,o));case 114:return N.abrupt("return",i);case 115:case"end":return N.stop()}}),null,this,[[5,60,64,72],[20,24,28,36],[29,,31,35],[65,,67,71],[75,79,83,91],[84,,86,90],[95,100,104,112],[105,,107,111]])}},{key:"missedReferenceBuildKey",value:function(e,t){return"".concat(e,":").concat(t)}},{key:"popMissedReferenceStructsForObjects",value:function(e){if(!e||0==e.length)return[];for(var t=[],n=[],r=e.map((function(e){return e.uuid})),o=r[0].length,i=0,a=Object.keys(this.missedReferences);i<a.length;i++){var s=a[i];r.includes(s.substring(0,o))&&(t.push(this.missedReferences[s]),n.push(s))}for(var u=0,c=n;u<c.length;u++){var l=c[u];delete this.missedReferences[l]}return t}},{key:"resolveReferencesForItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.errorDecrypting){var n=e.contentObject;if(e.updateLocalRelationships(),n.references){var r=n.references.slice(),o=r.map((function(e){return e.uuid})),i=!0,a=this.findItems(o,i),s=!0,u=!1,c=void 0;try{for(var l,f=a.entries()[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var p=It(l.value,2),y=p[0],h=p[1];if(h)e.addItemAsRelationship(h),t&&this.setItemDirty(h,!0);else{var d=o[y],v=this.missedReferenceBuildKey(d,e.uuid);if(!this.missedReferences[v]){var m={reference_uuid:d,for_item:e};this.missedReferences[v]=m}}}}catch(e){u=!0,c=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}}}},{key:"notifySyncObserversOfModels",value:function(e,t,n){var r,o,i,a,s,u,c,l=this;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:r=this.itemSyncObservers.sort((function(e,t){return e.priority<t.priority?-1:1})),o=!0,i=!1,a=void 0,f.prev=4,s=function(){var r,o,i,a,s,u,f,p,y,h;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:for(r=c.value,o=r.types.includes("*")?e:e.filter((function(e){return r.types.includes(e.content_type)})),i=[],a=[],s=!0,u=!1,f=void 0,d.prev=6,p=o[Symbol.iterator]();!(s=(y=p.next()).done);s=!0)(h=y.value).deleted?a.push(h):i.push(h);d.next=14;break;case 10:d.prev=10,d.t0=d.catch(6),u=!0,f=d.t0;case 14:d.prev=14,d.prev=15,s||null==p.return||p.return();case 17:if(d.prev=17,!u){d.next=20;break}throw f;case 20:return d.finish(17);case 21:return d.finish(14);case 22:if(!(o.length>0)){d.next=25;break}return d.next=25,regeneratorRuntime.awrap(l._callSyncObserverCallbackWithTimeout(r,o,i,a,t,n));case 25:case"end":return d.stop()}}),null,null,[[6,10,14,22],[15,,17,21]])},u=r[Symbol.iterator]();case 7:if(o=(c=u.next()).done){f.next=13;break}return f.next=10,regeneratorRuntime.awrap(s());case 10:o=!0,f.next=7;break;case 13:f.next=19;break;case 15:f.prev=15,f.t0=f.catch(4),i=!0,a=f.t0;case 19:f.prev=19,f.prev=20,o||null==u.return||u.return();case 22:if(f.prev=22,!i){f.next=25;break}throw a;case 25:return f.finish(22);case 26:return f.finish(19);case 27:case"end":return f.stop()}}),null,this,[[4,15,19,27],[20,,22,26]])}},{key:"_callSyncObserverCallbackWithTimeout",value:function(e,t,n,r,o,i){var a=this;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,u){a.$timeout((function(){try{e.callback(t,n,r,o,i)}catch(e){console.error("Sync observer exception",e)}finally{s()}}))})));case 1:case"end":return s.stop()}}))}},{key:"setItemDirty",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.setItemsDirty([e],t,n,r,o)}},{key:"setItemsDirty",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;f.setDirty(n,r)}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}this.notifySyncObserversOfModels(t,o||e.MappingSourceLocalDirtied,i)}},{key:"createItem",value:function(t){var n=e.ContentTypeClassMapping&&e.ContentTypeClassMapping[t.content_type];return n||(n=U),new n(t)}},{key:"createDuplicateItemFromResponseItem",value:function(e){var t,n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if("function"!=typeof e.setDirty){r.next=3;break}return console.error("Attempting to create conflicted copy of non-response item."),r.abrupt("return",null);case 3:return t=JSON.parse(JSON.stringify(e)),r.next=6,regeneratorRuntime.awrap(O.crypto.generateUUID());case 6:return t.uuid=r.sent,n=this.createItem(t),r.abrupt("return",n);case 9:case"end":return r.stop()}}),null,this)}},{key:"duplicateItemAndAddAsConflict",value:function(e){return this.duplicateItemWithCustomContentAndAddAsConflict({content:e.content,duplicateOf:e})}},{key:"duplicateItemWithCustomContentAndAddAsConflict",value:function(e){var t=e.content,n=e.duplicateOf,r=this.duplicateItemWithCustomContent({content:t,duplicateOf:n});return this.addDuplicatedItemAsConflict({duplicate:r,duplicateOf:n}),r}},{key:"addDuplicatedItemAsConflict",value:function(e){var t=e.duplicate,n=e.duplicateOf;this.addDuplicatedItem(t,n),t.content.conflict_of=n.uuid}},{key:"duplicateItemWithCustomContent",value:function(e){var t=e.content,n=e.duplicateOf,r=new n.constructor({content:t});return r.created_at=n.created_at,r.content_type||(r.content_type=n.content_type),r}},{key:"duplicateItemAndAdd",value:function(e){var t=this.duplicateItemWithoutAdding(e);return this.addDuplicatedItem(t,e),t}},{key:"duplicateItemWithoutAdding",value:function(e){var t=new e.constructor({content:e.content});return t.created_at=e.created_at,t.content_type||(t.content_type=e.content_type),t}},{key:"addDuplicatedItem",value:function(e,t){this.addItem(e);var n=!0,r=!1,o=void 0;try{for(var i,a=t.referencingObjects[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.addItemAsRelationship(e),this.setItemDirty(s,!0)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}this.resolveReferencesForItem(e),this.setItemDirty(e,!0)}},{key:"addItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.addItems([e],t)}},{key:"addItems",value:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.forEach((function(e){t.itemsHash[e.uuid]||(t.itemsHash[e.uuid]=e,t.items.push(e))}))}},{key:"addItemSyncObserver",value:function(e,t,n){this.addItemSyncObserverWithPriority({id:e,types:t,callback:n,priority:1})}},{key:"addItemSyncObserverWithPriority",value:function(e){var t=e.id,n=e.priority,r=e.types,o=e.callback;Array.isArray(r)||(r=[r]),this.itemSyncObservers.push({id:t,types:r,priority:n,callback:o})}},{key:"removeItemSyncObserver",value:function(e){M()(this.itemSyncObservers,A()(this.itemSyncObservers,{id:e}))}},{key:"getDirtyItems",value:function(){return this.items.filter((function(e){return 1==e.dirty&&!e.dummy&&(!e.errorDecrypting||e.deleted)}))}},{key:"clearDirtyItems",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)o.value.setDirty(!1)}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"removeAndDirtyAllRelationshipsForItem",value:function(e){if(!e.errorDecrypting){var t=!0,n=!1,r=void 0;try{for(var o,i=e.content.references[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=this.findItem(a.uuid);s&&(e.removeItemAsRelationship(s),s.hasRelationshipWithItem(e)&&(s.removeItemAsRelationship(e),this.setItemDirty(s,!0)))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}var u=!0,c=!1,l=void 0;try{for(var f,p=e.referencingObjects[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var y=f.value;y.removeItemAsRelationship(e),this.setItemDirty(y,!0)}}catch(e){c=!0,l=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw l}}e.referencingObjects=[]}},{key:"setAllItemsDirty",value:function(){var e=this.allItems;this.setItemsDirty(e,!0)}},{key:"setItemToBeDeleted",value:function(e){e.deleted=!0,e.dummy||this.setItemDirty(e,!0),this.removeAndDirtyAllRelationshipsForItem(e)}},{key:"removeItemLocally",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:M()(this.items,{uuid:e.uuid}),delete this.itemsHash[e.uuid],e.isBeingRemovedLocally();case 3:case"end":return t.stop()}}),null,this)}},{key:"allItemsMatchingTypes",value:function(e){return this.allItems.filter((function(t){return(gt()(e,t.content_type)||gt()(e,"*"))&&!t.dummy}))}},{key:"invalidItems",value:function(){return this.allItems.filter((function(e){return e.errorDecrypting}))}},{key:"validItemsForContentType",value:function(e){return this.allItems.filter((function(t){return t.content_type==e&&!t.errorDecrypting}))}},{key:"findItem",value:function(e){return this.itemsHash[e]}},{key:"findItems",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=this.itemsHash[u];(c||t)&&n.push(c)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}},{key:"itemsMatchingPredicate",value:function(e){return this.itemsMatchingPredicates([e])}},{key:"itemsMatchingPredicates",value:function(e){return this.filterItemsWithPredicates(this.allItems,e)}},{key:"filterItemsWithPredicates",value:function(e,t){return e.filter((function(e){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(!e.satisfiesPredicate(s))return!1}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!0}))}},{key:"importItems",value:function(t){var n,r,o,i,a,s,u,c,l,f,p,y,h,d,v,m,g,b,x,S,k,w,_,R,I,O,C;return regeneratorRuntime.async((function(A){for(;;)switch(A.prev=A.next){case 0:n=[],r={},o=!0,i=!1,a=void 0,A.prev=5,s=t[Symbol.iterator]();case 7:if(o=(u=s.next()).done){A.next=18;break}if(c=u.value,l=this.findItem(c.uuid)){A.next=13;break}return r[c.uuid]={},A.abrupt("continue",15);case 13:f=this.duplicateItemWithoutAdding(l),r[c.uuid]={frozenValue:f,itemRef:l};case 15:o=!0,A.next=7;break;case 18:A.next=24;break;case 20:A.prev=20,A.t0=A.catch(5),i=!0,a=A.t0;case 24:A.prev=24,A.prev=25,o||null==s.return||s.return();case 27:if(A.prev=27,!i){A.next=30;break}throw a;case 30:return A.finish(27);case 31:return A.finish(24);case 32:p=!0,y=!1,h=void 0,A.prev=35,d=t[Symbol.iterator]();case 37:if(p=(v=d.next()).done){A.next=52;break}if(m=v.value,g=r[m.uuid],b=g.frozenValue,x=g.itemRef,!b||x.errorDecrypting){A.next=47;break}return A.next=43,regeneratorRuntime.awrap(this.createDuplicateItemFromResponseItem(m));case 43:S=A.sent,m.deleted||b.isItemContentEqualWith(S)||(this.addDuplicatedItemAsConflict({duplicate:S,duplicateOf:x}),n.push(S)),A.next=49;break;case 47:n.push(m),x&&x.errorDecrypting&&(x.errorDecrypting=!1);case 49:p=!0,A.next=37;break;case 52:A.next=58;break;case 54:A.prev=54,A.t1=A.catch(35),y=!0,h=A.t1;case 58:A.prev=58,A.prev=59,p||null==d.return||d.return();case 61:if(A.prev=61,!y){A.next=64;break}throw h;case 64:return A.finish(61);case 65:return A.finish(58);case 66:return A.next=68,regeneratorRuntime.awrap(this.mapResponseItemsToLocalModels(n,e.MappingSourceFileImport));case 68:for(k=A.sent,w=!0,_=!1,R=void 0,A.prev=72,I=k[Symbol.iterator]();!(w=(O=I.next()).done);w=!0)C=O.value,this.setItemDirty(C,!0,!1),C.deleted=!1;A.next=80;break;case 76:A.prev=76,A.t2=A.catch(72),_=!0,R=A.t2;case 80:A.prev=80,A.prev=81,w||null==I.return||I.return();case 83:if(A.prev=83,!_){A.next=86;break}throw R;case 86:return A.finish(83);case 87:return A.finish(80);case 88:return A.abrupt("return",k);case 89:case"end":return A.stop()}}),null,this,[[5,20,24,32],[25,,27,31],[35,54,58,66],[59,,61,65],[72,76,80,88],[81,,83,87]])}},{key:"getAllItemsJSONData",value:function(e,t,n){return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.getJSONDataForItems(this.allItems,e,t,n));case 1:case"end":return r.stop()}}),null,this)}},{key:"getJSONDataForItems",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Promise.all(e.map((function(e){return new X(e,t,n).paramsForExportFile()}))).then((function(e){if(r&&0==e.length)return null;var o={items:e};return t&&(o.auth_params=n),JSON.stringify(o,null,2)})));case 1:case"end":return o.stop()}}))}},{key:"computeDataIntegrityHash",value:function(){var e,t,n,r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,e=this.allNondummyItems.sort((function(e,t){return t.updated_at-e.updated_at})),t=e.map((function(e){return e.updatedAtTimestamp()})),n=t.join(","),o.next=6,regeneratorRuntime.awrap(O.crypto.sha256(n));case 6:return r=o.sent,o.abrupt("return",r);case 10:return o.prev=10,o.t0=o.catch(0),console.error("Error computing data integrity hash",o.t0),o.abrupt("return",null);case 14:case"end":return o.stop()}}),null,this,[[0,10]])}},{key:"allItems",get:function(){return this.items.slice()}},{key:"allNondummyItems",get:function(){return this.items.filter((function(e){return!e.dummy}))}}])&&Ot(t.prototype,n),r&&Ot(t,r),e}();function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Dt=function(){function e(t){var n=t.modelManager,r=t.syncManager,o=t.desktopManager,i=t.nativeExtManager,a=t.alertManager,s=t.$uiRunner,u=t.$timeout,c=t.environment,l=t.platform;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.ClientDataDomain="org.standardnotes.sn.components",this.$uiRunner=s||function(e){e()},this.$timeout=u||setTimeout.bind(window),this.modelManager=n,this.syncManager=r,this.desktopManager=o,this.nativeExtManager=i,this.alertManager=a,this.streamObservers=[],this.contextStreamObservers=[],this.activeComponents=[],this.environment=c,this.platform=l,this.isDesktop="desktop"==this.environment,this.isMobile="mobile"==this.environment,"mobile"!=c&&this.configureForNonMobileUsage(),this.configureForGeneralUsage(),this.permissionDialogs=[],this.handlers=[]}var t,n,r;return t=e,(n=[{key:"configureForGeneralUsage",value:function(){var e=this;this.modelManager.addItemSyncObserver("component-manager","*",(function(t,n,r,o,i){var a=t.filter((function(e){return"SN|Component"===e.content_type||"SN|Theme"==e.content_type}));a.length>0&&o!=Ct.MappingSourceRemoteSaved&&e.isDesktop&&e.desktopManager.syncComponentsInstallation(a);var s=!0,u=!1,c=void 0;try{for(var l,f=a[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var p=l.value,y=A()(e.activeComponents,{uuid:p.uuid});!p.active||p.deleted||y?!p.active&&y&&e.deactivateComponent(p):e.activateComponent(p)}}catch(e){u=!0,c=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}var h=!0,d=!1,v=void 0;try{for(var m,g=function(){var n=m.value;if(i&&i==n.component.uuid)return"continue";var r=t.filter((function(e){return-1!==n.contentTypes.indexOf(e.content_type)}));if(0==r.length)return"continue";var o=[{name:"stream-items",content_types:n.contentTypes.sort()}];e.runWithPermissions(n.component,o,(function(){e.sendItemsInReply(n.component,r,n.originalMessage)}))},b=e.streamObservers[Symbol.iterator]();!(h=(m=b.next()).done);h=!0)g()}catch(e){d=!0,v=e}finally{try{h||null==b.return||b.return()}finally{if(d)throw v}}var x=[{name:"stream-context-item"}],S=!0,k=!1,w=void 0;try{for(var _,R=function(){var n=_.value;if(i&&i==n.component.uuid)return"continue";var r=!0,a=!1,s=void 0;try{for(var u,c=e.handlers[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var l=u.value;(l.areas.includes(n.component.area)||l.areas.includes("*"))&&l.contextRequestHandler&&(O=l.contextRequestHandler(n.component))&&(C=A()(t,{uuid:O.uuid}))&&e.runWithPermissions(n.component,x,(function(){e.sendContextItemInReply(n.component,C,n.originalMessage,o)}))}}catch(e){a=!0,s=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw s}}},I=e.contextStreamObservers[Symbol.iterator]();!(S=(_=I.next()).done);S=!0){var O,C;R()}}catch(e){k=!0,w=e}finally{try{S||null==I.return||I.return()}finally{if(k)throw w}}}))}},{key:"configureForNonMobileUsage",value:function(){var e=this,t=function(t){var n=!0,r=!1,o=void 0;try{for(var i,a=e.activeComponents[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(document.activeElement==e.iframeForComponent(s)){e.$timeout((function(){e.focusChangedForComponent(s)}));break}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}};window.addEventListener?window.addEventListener("focus",t,!0):window.attachEvent("onfocusout",t),window.addEventListener?window.addEventListener("blur",t,!0):window.attachEvent("onblur",t),this.desktopManager.registerUpdateObserver((function(t){t.active&&t.isTheme()&&e.postActiveThemesToAllComponents()})),window.addEventListener("message",(function(t){e.loggingEnabled&&console.log("Web app: received message",t),t.data.sessionKey&&e.handleMessage(e.componentForSessionKey(t.data.sessionKey),t.data)}),!1)}},{key:"postActiveThemesToAllComponents",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.components[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;!i.isTheme()&&i.active&&i.window&&this.postActiveThemesToComponent(i)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"getActiveThemes",value:function(){return this.componentsForArea("themes").filter((function(e){return e.active}))}},{key:"urlsForActiveThemes",value:function(){var e=this;return this.getActiveThemes().map((function(t){return e.urlForComponent(t)}))}},{key:"postActiveThemesToComponent",value:function(e){var t={themes:this.urlsForActiveThemes()};this.sendMessageToComponent(e,{action:"themes",data:t})}},{key:"contextItemDidChangeInArea",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.handlers[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(!1!==a.areas.includes(e)||a.areas.includes("*")){var s=this.contextStreamObservers.filter((function(t){return t.component.area===e})),u=!0,c=!1,l=void 0;try{for(var f,p=s[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var y=f.value;if(a.contextRequestHandler){var h=a.contextRequestHandler(y.component);h&&this.sendContextItemInReply(y.component,h,y.originalMessage)}}}catch(e){c=!0,l=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw l}}}}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"setComponentHidden",value:function(e,t){if(t)e.hidden=!0;else if(e.hidden){e.hidden=!1;var n=A()(this.contextStreamObservers,{identifier:e.uuid});n&&this.handleStreamContextItemMessage(e,n.originalMessage);var r=A()(this.streamObservers,{identifier:e.uuid});r&&this.handleStreamItemsMessage(e,r.originalMessage)}}},{key:"jsonForItem",value:function(t,n,r){var o={uuid:t.uuid,content_type:t.content_type,created_at:t.created_at,updated_at:t.updated_at,deleted:t.deleted};return o.content=t.createContentJSONFromProperties(),o.clientData=t.getDomainDataItem(n.getClientDataKey(),e.ClientDataDomain)||{},!r||r!=Ct.MappingSourceRemoteSaved&&r!=Ct.MappingSourceLocalSaved||(o.isMetadataUpdate=!0),this.removePrivatePropertiesFromResponseItems([o],n,{type:"outgoing"}),o}},{key:"sendItemsInReply",value:function(e,t,n,r){var o=this;this.loggingEnabled&&console.log("Web|componentManager|sendItemsInReply",e,t,n);var i={items:{}},a=t.map((function(t){return o.jsonForItem(t,e,r)}));i.items=a,this.replyToMessage(e,n,i)}},{key:"sendContextItemInReply",value:function(e,t,n,r){this.loggingEnabled&&console.log("Web|componentManager|sendContextItemInReply",e,t,n);var o={item:this.jsonForItem(t,e,r)};this.replyToMessage(e,n,o)}},{key:"replyToMessage",value:function(e,t,n){var r={action:"reply",original:t,data:n};this.sendMessageToComponent(e,r)}},{key:"sendMessageToComponent",value:function(e,t){if(!e.hidden||["component-registered","themes"].includes(t.action)){this.loggingEnabled&&console.log("Web|sendMessageToComponent",e,t);var n=this.urlForComponent(e);n.startsWith("http")||n.startsWith("file")||(n=window.location.href+n),e.window||this.alertManager.alert({text:"Standard Notes is trying to communicate with ".concat(e.name,", but an error is occurring. Please restart this extension and try again.")}),this.isMobile&&(t=JSON.stringify(t)),e.window.postMessage(t,n)}else this.loggingEnabled&&console.log("Component disabled for current item, not sending any messages.",e.name)}},{key:"componentsForArea",value:function(e){return this.components.filter((function(t){return t.area===e}))}},{key:"urlForComponent",value:function(e){if(e.offlineOnly&&!this.isDesktop)return null;if(e.offlineOnly||this.isDesktop&&e.local_url)return e.local_url&&e.local_url.replace("sn://",this.desktopManager.getExtServerHost());var t=e.hosted_url||e.legacy_url;if(this.isMobile){var n="ios"==this.platform?"localhost":"10.0.2.2";t=t.replace("localhost",n).replace("sn.local",n)}return t}},{key:"componentForUrl",value:function(e){return this.components.filter((function(t){return t.hosted_url===e||t.legacy_url===e}))[0]}},{key:"componentForSessionKey",value:function(e){var t=A()(this.components,{sessionKey:e});if(!t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.handlers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.componentForSessionKeyHandler&&(t=s.componentForSessionKeyHandler(e)))break}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}return t}},{key:"handleMessage",value:function(e,t){var n=this;if(!e)return console.log("Component not defined for message, returning",t),void this.alertManager.alert({text:"An extension is trying to communicate with Standard Notes, but there is an error establishing a bridge. Please restart the app and try again."});if(e.readonly&&["save-items","associate-item","deassociate-item","create-item","create-items","delete-items","set-component-data"].includes(t.action))this.alertManager.alert({text:"The extension ".concat(e.name," is trying to save, but it is in a locked state and cannot accept changes.")});else{if("stream-items"===t.action)this.handleStreamItemsMessage(e,t);else if("stream-context-item"===t.action)this.handleStreamContextItemMessage(e,t);else if("set-component-data"===t.action)this.handleSetComponentDataMessage(e,t);else if("delete-items"===t.action)this.handleDeleteItemsMessage(e,t);else if("create-items"===t.action||"create-item"===t.action)this.handleCreateItemsMessage(e,t);else if("save-items"===t.action)this.handleSaveItemsMessage(e,t);else if("toggle-activate-component"===t.action){var r=this.modelManager.findItem(t.data.uuid);this.handleToggleComponentMessage(e,r,t)}else"request-permissions"===t.action?this.handleRequestPermissionsMessage(e,t):"install-local-component"===t.action?this.handleInstallLocalComponentMessage(e,t):"duplicate-item"===t.action&&this.handleDuplicateItemMessage(e,t);var o=!0,i=!1,a=void 0;try{for(var s,u=function(){var r=s.value;r.actionHandler&&(r.areas.includes(e.area)||r.areas.includes("*"))&&n.$timeout((function(){r.actionHandler(e,t.action,t.data)}))},c=this.handlers[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)u()}catch(e){i=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}}}},{key:"removePrivatePropertiesFromResponseItems",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("incoming"==n.type){var r=["updated_at"],o=!0,i=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;if("function"!=typeof c.setDirty){var l=!0,f=!1,p=void 0;try{for(var y,h=r[Symbol.iterator]();!(l=(y=h.next()).done);l=!0){var d=y.value;delete c[d]}}catch(e){f=!0,p=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw p}}}else console.error("Attempting to pass object. Use JSON.")}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}}if(!(t&&this.nativeExtManager&&this.nativeExtManager.isSystemExtension(t))){var v=["autoupdateDisabled","permissions","active"];n&&n.includeUrls&&(v=v.concat(["url","hosted_url","local_url"]));var m=!0,g=!1,b=void 0;try{for(var x,S=e[Symbol.iterator]();!(m=(x=S.next()).done);m=!0){var k=x.value;if("function"!=typeof k.setDirty){var w=!0,_=!1,R=void 0;try{for(var I,O=v[Symbol.iterator]();!(w=(I=O.next()).done);w=!0){var C=I.value;delete k.content[C]}}catch(e){_=!0,R=e}finally{try{w||null==O.return||O.return()}finally{if(_)throw R}}}else console.error("Attempting to pass object. Use JSON.")}}catch(e){g=!0,b=e}finally{try{m||null==S.return||S.return()}finally{if(g)throw b}}}}},{key:"handleStreamItemsMessage",value:function(e,t){var n=this,r=[{name:"stream-items",content_types:t.data.content_types.sort()}];this.runWithPermissions(e,r,(function(){A()(n.streamObservers,{identifier:e.uuid})||n.streamObservers.push({identifier:e.uuid,component:e,originalMessage:t,contentTypes:t.data.content_types});var r=[],o=!0,i=!1,a=void 0;try{for(var s,u=t.data.content_types[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;r=r.concat(n.modelManager.validItemsForContentType(c))}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}n.sendItemsInReply(e,r,t)}))}},{key:"handleStreamContextItemMessage",value:function(e,t){var n=this;this.runWithPermissions(e,[{name:"stream-context-item"}],(function(){A()(n.contextStreamObservers,{identifier:e.uuid})||n.contextStreamObservers.push({identifier:e.uuid,component:e,originalMessage:t});var r=!0,o=!1,i=void 0;try{for(var a,s=n.handlersForArea(e.area)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.contextRequestHandler){var c=u.contextRequestHandler(e);c&&n.sendContextItemInReply(e,c,t)}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}))}},{key:"isItemIdWithinComponentContextJurisdiction",value:function(e,t){return this.itemIdsInContextJurisdictionForComponent(t).includes(e)}},{key:"itemIdsInContextJurisdictionForComponent",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=this.handlersForArea(e.area)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.contextRequestHandler){var u=s.contextRequestHandler(e);u&&t.push(u.uuid)}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}},{key:"handlersForArea",value:function(e){return this.handlers.filter((function(t){return t.areas.includes(e)}))}},{key:"handleSaveItemsMessage",value:function(t,n){var r,o,i,a,s,u,c,l,f,p,y,h=this;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:r=n.data.items,o=[],i=this.itemIdsInContextJurisdictionForComponent(t),a=r.slice(),s=!0,u=!1,c=void 0,d.prev=7,l=r.slice()[Symbol.iterator]();case 9:if(s=(f=l.next()).done){d.next=18;break}if(p=f.value,!i.includes(p.uuid)){d.next=15;break}return o.push({name:"stream-context-item"}),Le()(a,p),d.abrupt("break",18);case 15:s=!0,d.next=9;break;case 18:d.next=24;break;case 20:d.prev=20,d.t0=d.catch(7),u=!0,c=d.t0;case 24:d.prev=24,d.prev=25,s||null==l.return||l.return();case 27:if(d.prev=27,!u){d.next=30;break}throw c;case 30:return d.finish(27);case 31:return d.finish(24);case 32:a.length>0&&(y=vt()(a.map((function(e){return e.content_type}))).sort(),o.push({name:"stream-items",content_types:y})),this.runWithPermissions(t,o,(function(){var o,i,a,s,u,c,l,f,p,y,d,v,m,g,b,x,S,k,w;return regeneratorRuntime.async((function(_){for(;;)switch(_.prev=_.next){case 0:for(h.removePrivatePropertiesFromResponseItems(r,t,{includeUrls:!0,type:"incoming"}),o=r.map((function(e){return e.uuid})),i=h.modelManager.findItems(o),a=0,s=!0,u=!1,c=void 0,_.prev=7,l=i[Symbol.iterator]();!(s=(f=l.next()).done);s=!0)(p=f.value).locked&&(M()(r,{uuid:p.uuid}),a++);_.next=15;break;case 11:_.prev=11,_.t0=_.catch(7),u=!0,c=_.t0;case 15:_.prev=15,_.prev=16,s||null==l.return||l.return();case 18:if(_.prev=18,!u){_.next=21;break}throw c;case 21:return _.finish(18);case 22:return _.finish(15);case 23:return a>0&&(y=1==a?"item":"items",d=1==a?"is":"are",h.alertManager.alert({title:"Items Locked",text:"".concat(a," ").concat(y," you are attempting to save ").concat(d," locked and cannot be edited.")})),_.next=26,regeneratorRuntime.awrap(h.modelManager.mapResponseItemsToLocalModels(r,Ct.MappingSourceComponentRetrieved,t.uuid));case 26:v=_.sent,m=!0,g=!1,b=void 0,_.prev=30,x=r[Symbol.iterator]();case 32:if(m=(S=x.next()).done){_.next=42;break}if(k=S.value,w=A()(v,{uuid:k.uuid})){_.next=38;break}return h.alertManager.alert({text:"The extension ".concat(t.name," is trying to save an item with type ").concat(k.content_type,", but that item does not exist. Please restart this extension and try again.")}),_.abrupt("continue",39);case 38:w.locked||(k.clientData&&w.setDomainDataItem(t.getClientDataKey(),k.clientData,e.ClientDataDomain),h.modelManager.setItemDirty(w,!0,!0,Ct.MappingSourceComponentRetrieved,t.uuid));case 39:m=!0,_.next=32;break;case 42:_.next=48;break;case 44:_.prev=44,_.t1=_.catch(30),g=!0,b=_.t1;case 48:_.prev=48,_.prev=49,m||null==x.return||x.return();case 51:if(_.prev=51,!g){_.next=54;break}throw b;case 54:return _.finish(51);case 55:return _.finish(48);case 56:h.syncManager.sync().then((function(e){var r=Object.assign({},n);r.action=e&&e.error?"save-error":"save-success",h.replyToMessage(t,n,{error:e&&e.error}),h.handleMessage(t,r)}));case 57:case"end":return _.stop()}}),null,null,[[7,11,15,23],[16,,18,22],[30,44,48,56],[49,,51,55]])}));case 34:case"end":return d.stop()}}),null,this,[[7,20,24,32],[25,,27,31]])}},{key:"handleDuplicateItemMessage",value:function(e,t){var n=this,r=t.data.item,o=this.modelManager.findItem(r.uuid),i=[{name:"stream-items",content_types:[o.content_type]}];this.runWithPermissions(e,i,(function(){var r=n.modelManager.duplicateItemAndAdd(o);n.syncManager.sync(),n.replyToMessage(e,t,{item:n.jsonForItem(r,e)})}))}},{key:"handleCreateItemsMessage",value:function(t,n){var r=this,o=n.data.item?[n.data.item]:n.data.items,i=[{name:"stream-items",content_types:vt()(o.map((function(e){return e.content_type})))}];this.runWithPermissions(t,i,(function(){r.removePrivatePropertiesFromResponseItems(o,t,{type:"incoming"});var i=[],a=!0,s=!1,u=void 0;try{for(var c,l=o[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value,p=r.modelManager.createItem(f);f.clientData&&p.setDomainDataItem(t.getClientDataKey(),f.clientData,e.ClientDataDomain),r.modelManager.addItem(p),r.modelManager.resolveReferencesForItem(p,!0),r.modelManager.setItemDirty(p,!0),i.push(p)}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}r.syncManager.sync();var y="create-item"==n.action?{item:r.jsonForItem(i[0],t)}:{items:i.map((function(e){return r.jsonForItem(e,t)}))};r.replyToMessage(t,n,y)}))}},{key:"handleDeleteItemsMessage",value:function(e,t){var n=this,r=[{name:"stream-items",content_types:vt()(t.data.items.map((function(e){return e.content_type}))).sort()}];this.runWithPermissions(e,r,(function(){var r,o,i,a,s,u,c,l,f,p,y;return regeneratorRuntime.async((function(h){for(;;)switch(h.prev=h.next){case 0:return r=t.data.items,o=1==r.length?"item":"items",i=null,a=!0,h.next=6,regeneratorRuntime.awrap(n.alertManager.confirm({text:"Are you sure you want to delete ".concat(r.length," ").concat(o,"?")}).catch((function(){a=!1})));case 6:if(!a){h.next=42;break}s=!0,u=!1,c=void 0,h.prev=10,l=r[Symbol.iterator]();case 12:if(s=(f=l.next()).done){h.next=24;break}if(p=f.value,y=n.modelManager.findItem(p.uuid)){h.next=18;break}return n.alertManager.alert({text:"The item you are trying to delete cannot be found."}),h.abrupt("continue",21);case 18:["SN|Component","SN|Theme"].includes(y.content_type)&&n.deactivateComponent(y,!0),n.modelManager.setItemToBeDeleted(y),n.modelManager.notifySyncObserversOfModels([y],Ct.MappingSourceRemoteSaved);case 21:s=!0,h.next=12;break;case 24:h.next=30;break;case 26:h.prev=26,h.t0=h.catch(10),u=!0,c=h.t0;case 30:h.prev=30,h.prev=31,s||null==l.return||l.return();case 33:if(h.prev=33,!u){h.next=36;break}throw c;case 36:return h.finish(33);case 37:return h.finish(30);case 38:n.syncManager.sync(),i={deleted:!0},h.next=43;break;case 42:i={deleted:!1};case 43:n.replyToMessage(e,t,i);case 44:case"end":return h.stop()}}),null,null,[[10,26,30,38],[31,,33,37]])}))}},{key:"handleRequestPermissionsMessage",value:function(e,t){var n=this;this.runWithPermissions(e,t.data.permissions,(function(){n.replyToMessage(e,t,{approved:!0})}))}},{key:"handleSetComponentDataMessage",value:function(e,t){var n=this;this.runWithPermissions(e,[],(function(){e.componentData=t.data.componentData,n.modelManager.setItemDirty(e,!0),n.syncManager.sync()}))}},{key:"handleToggleComponentMessage",value:function(e,t,n){this.toggleComponent(t)}},{key:"toggleComponent",value:function(e){var t=this;if("modal"==e.area)this.openModalComponent(e);else if(e.active)this.deactivateComponent(e);else if("SN|Theme"==e.content_type){var n=this.getActiveThemes();this.activateComponent(e),e.isLayerable()||setTimeout((function(){var e=!0,r=!1,o=void 0;try{for(var i,a=n[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var s=i.value;s&&!s.isLayerable()&&t.deactivateComponent(s)}}catch(e){r=!0,o=e}finally{try{e||null==a.return||a.return()}finally{if(r)throw o}}}),10)}else this.activateComponent(e)}},{key:"handleInstallLocalComponentMessage",value:function(e,t){if(!this.nativeExtManager||this.nativeExtManager.isSystemExtension(e)){var n=this.modelManager.findItem(t.data.uuid);this.desktopManager.installComponent(n)}}},{key:"runWithPermissions",value:function(e,t,n){e.permissions||(e.permissions=[]),t=JSON.parse(JSON.stringify(t));var r=e.permissions,o=!0,i=!1,a=void 0;try{for(var s,u=function(){var e=s.value,n=r.find((function(t){return t.name==e.name}));if(!n)return"continue";var o=e.content_types;if(!o)return Le()(t,e),"continue";var i=!0,a=!1,u=void 0;try{for(var c,l=n.content_types[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;Le()(o,f)}}catch(e){a=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw u}}0==o.length&&Le()(t,e)},c=t.slice()[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)u()}catch(e){i=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}t.length>0?this.promptForPermissions(e,t,(function(e){e&&n()})):n()}},{key:"promptForPermissions",value:function(e,t,n){var r=this,o={};o.component=e,o.permissions=t,o.permissionsString=this.permissionsStringForPermissions(t,e),o.actionBlock=n,o.callback=function(n){if(n){var i=!0,a=!1,s=void 0;try{for(var u,c=function(){var t=u.value,n=e.permissions.find((function(e){return e.name==t.name}));if(n){var r=n.content_types||[];n.content_types=vt()(r.concat(t.content_types))}else e.permissions.push(t)},l=t[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)c()}catch(e){a=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}r.modelManager.setItemDirty(e,!0),r.syncManager.sync()}r.permissionDialogs=r.permissionDialogs.filter((function(r){return r==o?(r.actionBlock&&r.actionBlock(n),!1):!!(r.component!=e||r.permissions!=t&&(i=t,r.permissions.some((function(e){return!i.find((function(t){return JSON.stringify(t)===JSON.stringify(e)}))}))))||(n&&r.actionBlock&&r.actionBlock(n),!1);var i})),r.permissionDialogs.length>0&&r.presentPermissionsDialog(r.permissionDialogs[0])};var i=A()(this.permissionDialogs,{component:e});this.permissionDialogs.push(o),i?console.log("Existing dialog, not presenting."):this.presentPermissionsDialog(o)}},{key:"presentPermissionsDialog",value:function(e){console.error("Must override")}},{key:"openModalComponent",value:function(e){console.error("Must override")}},{key:"registerHandler",value:function(e){this.handlers.push(e)}},{key:"deregisterHandler",value:function(e){var t=A()(this.handlers,{identifier:e});t?this.handlers.splice(this.handlers.indexOf(t),1):console.log("Attempting to deregister non-existing handler")}},{key:"registerComponentWindow",value:function(e,t){return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.window===t&&this.loggingEnabled&&console.log("Web|componentManager","attempting to re-register same component window."),this.loggingEnabled&&console.log("Web|componentManager|registerComponentWindow",e),e.window=t,n.next=5,regeneratorRuntime.awrap(O.crypto.generateUUID());case 5:e.sessionKey=n.sent,this.sendMessageToComponent(e,{action:"component-registered",sessionKey:e.sessionKey,componentData:e.componentData,data:{uuid:e.uuid,environment:this.environment,platform:this.platform,activeThemeUrls:this.urlsForActiveThemes()}}),this.postActiveThemesToComponent(e),this.desktopManager&&this.desktopManager.notifyComponentActivation(e);case 9:case"end":return n.stop()}}),null,this)}},{key:"activateComponent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=1!=e.active;e.active=!0;var o=!0,i=!1,a=void 0;try{for(var s,u=function(){var n=s.value;(n.areas.includes(e.area)||n.areas.includes("*"))&&t.$uiRunner((function(){n.activationHandler&&n.activationHandler(e)}))},c=this.handlers[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)u()}catch(e){i=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}r&&!n&&(this.modelManager.setItemDirty(e,!0),this.syncManager.sync()),this.activeComponents.includes(e)||this.activeComponents.push(e),"themes"==e.area&&this.postActiveThemesToAllComponents()}},{key:"deactivateComponent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0!=e.active;e.active=!1,e.sessionKey=null;var o=!0,i=!1,a=void 0;try{for(var s,u=function(){var n=s.value;(n.areas.includes(e.area)||n.areas.includes("*"))&&t.$uiRunner((function(){n.activationHandler&&n.activationHandler(e)}))},c=this.handlers[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)u()}catch(e){i=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}r&&!n&&(this.modelManager.setItemDirty(e,!0),this.syncManager.sync()),Le()(this.activeComponents,e),this.streamObservers=this.streamObservers.filter((function(t){return t.component!==e})),this.contextStreamObservers=this.contextStreamObservers.filter((function(t){return t.component!==e})),"themes"==e.area&&this.postActiveThemesToAllComponents()}},{key:"reloadComponent",value:function(e){var t,n,r,o,i,a,s=this;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:for(e.active=!1,t=!0,n=!1,r=void 0,u.prev=4,o=function(){var t=a.value;(t.areas.includes(e.area)||t.areas.includes("*"))&&s.$uiRunner((function(){t.activationHandler&&t.activationHandler(e)}))},i=this.handlers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)o();u.next=13;break;case 9:u.prev=9,u.t0=u.catch(4),n=!0,r=u.t0;case 13:u.prev=13,u.prev=14,t||null==i.return||i.return();case 16:if(u.prev=16,!n){u.next=19;break}throw r;case 19:return u.finish(16);case 20:return u.finish(13);case 21:return this.streamObservers=this.streamObservers.filter((function(t){return t.component!==e})),this.contextStreamObservers=this.contextStreamObservers.filter((function(t){return t.component!==e})),"themes"==e.area&&this.postActiveThemesToAllComponents(),u.abrupt("return",new Promise((function(t,n){s.$timeout((function(){e.active=!0;var n=!0,r=!1,o=void 0;try{for(var i,a=s.handlers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;(u.areas.includes(e.area)||u.areas.includes("*"))&&s.$uiRunner((function(){u.activationHandler&&u.activationHandler(e),t()}))}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}s.activeComponents.includes(e)||s.activeComponents.push(e),"themes"==e.area&&s.postActiveThemesToAllComponents(),t()}))})));case 25:case"end":return u.stop()}}),null,this,[[4,9,13,21],[14,,16,20]])}},{key:"deleteComponent",value:function(e){this.modelManager.setItemToBeDeleted(e),this.syncManager.sync()}},{key:"isComponentActive",value:function(e){return e.active}},{key:"iframeForComponent",value:function(e){for(var t=0,n=Array.from(document.getElementsByTagName("iframe"));t<n.length;t++){var r=n[t];if(r.dataset.componentId===e.uuid)return r}}},{key:"focusChangedForComponent",value:function(e){var t=document.activeElement==this.iframeForComponent(e),n=!0,r=!1,o=void 0;try{for(var i,a=this.handlers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.focusHandler&&s.focusHandler(e,t)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"handleSetSizeEvent",value:function(e,t){var n=function(e,n){var r="string"==typeof n.width?n.width:"".concat(t.width,"px"),o="string"==typeof n.height?n.height:"".concat(t.height,"px");e&&e.setAttribute("style","width:".concat(r,"; height:").concat(o,";"))};if("rooms"==e.area||"modal"==e.area){var r="rooms"==e.area?"inner":"outer",o=document.getElementById("component-content-".concat(r,"-").concat(e.uuid));o&&n(o,t)}else{var i=this.iframeForComponent(e);if(!i)return;if(n(i,t),"editor-stack"==e.area){var a=i.parentElement;a&&n(a,t)}}}},{key:"editorForNote",value:function(e){var t=this.componentsForArea("editor-editor"),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.isExplicitlyEnabledForItem(e))return s}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}if(this.isMobile){if(!e.content.mobilePrefersPlainEditor)return this.getDefaultEditor()}else if(!e.getAppDataItem("prefersPlainEditor"))return t.filter((function(e){return e.isDefaultEditor()}))[0]}},{key:"permissionsStringForPermissions",value:function(e,t){var n=this,r="",o=e.length,i=function(e,t){return e>0?e==t-1?2==t?" and ":", and ":", ":""};return e.forEach((function(e,a){if("stream-items"===e.name){for(var s=e.content_types.map((function(e){var t=n.modelManager.humanReadableDisplayForContentType(e);return t?t+"s":"items of type "+e})),u="",c=0;c<s.length;c++){var l=s[c];u+=i(c,s.length+o-a-1),u+=l}r+=i(a,o),r+=u,s.length>=2&&a<o-1&&(r+=", ")}else"stream-context-item"===e.name&&(r+=i(a,o),r+={"editor-stack":"working note","note-tags":"working note","editor-editor":"working note"}[t.area])})),r+"."}},{key:"components",get:function(){return this.modelManager.allItemsMatchingTypes(["SN|Component","SN|Theme"])}}])&&At(t.prototype,n),r&&At(t,r),e}();function Mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var jt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.item=U.deepMerge({},t),this.defaultContentKeyToDiffOn="text",this.textCharDiffLength=0,"string"==typeof this.item.updated_at&&(this.item.updated_at=new Date(this.item.updated_at))}var t,n,r;return t=e,(n=[{key:"setPreviousEntry",value:function(e){this.hasPreviousEntry=null!=e,this.item.content[this.defaultContentKeyToDiffOn]&&(this.textCharDiffLength=e?this.item.content[this.defaultContentKeyToDiffOn].length-e.item.content[this.defaultContentKeyToDiffOn].length:this.item.content[this.defaultContentKeyToDiffOn].length)}},{key:"operationVector",value:function(){return null!=this.textCharDiffLength?this.hasPreviousEntry&&0!=this.textCharDiffLength?this.textCharDiffLength<0?-1:1:0:1}},{key:"deltaSize",value:function(){return null!=this.textCharDiffLength?Math.abs(this.textCharDiffLength):1}},{key:"isSameAsEntry",value:function(e){if(!e)return!1;var t=new U(this.item),n=new U(e.item);return t.isItemContentEqualWith(n)}}])&&Mt(t.prototype,n),r&&Mt(t,r),e}();function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Tt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.entries||(this.entries=[]),t.entries){var n=!0,r=!1,o=void 0;try{for(var i,a=t.entries[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,u=this.createEntryForItem(s.item);u.setPreviousEntry(this.getLastEntry()),this.entries.push(u)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}var t,n,r;return t=e,(n=[{key:"createEntryForItem",value:function(t){var n=e.HistoryEntryClassMapping&&e.HistoryEntryClassMapping[t.content_type];return n||(n=jt),new n(t)}},{key:"getLastEntry",value:function(){return this.entries[this.entries.length-1]}},{key:"addHistoryEntryForItem",value:function(e){var t=this.createEntryForItem(e),n=this.getLastEntry();if(t.setPreviousEntry(n),!t.isSameAsEntry(n))return this.entries.push(t),t}},{key:"clear",value:function(){this.entries.length=0}},{key:"optimize",value:function(){var t=this,n=[],r=function(t){return t.deltaSize()>e.LargeEntryDeltaThreshold},o=function(e,o,i){if(i?n.push(e):-1!==(o=n.indexOf(e))&&n.splice(o,1),i&&r(e)&&-1==e.operationVector()){var a=t.entries[o-1];a&&n.push(a)}};this.entries.forEach((function(e,n){if(0==n||n==t.entries.length-1)o(e,n,!0);else{var i=r(e);o(e,n,i)}})),this.entries=this.entries.filter((function(e,t){return-1!==n.indexOf(e)}))}}])&&Pt(t.prototype,n),r&&Pt(t,r),e}();function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bt(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ht(e){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lt(e,t){return(Lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Tt.LargeEntryDeltaThreshold=15;var Nt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Bt(this,Ht(t).call(this,e))).content.itemUUIDToItemHistoryMapping||(n.content.itemUUIDToItemHistoryMapping={}),Object.keys(n.content.itemUUIDToItemHistoryMapping).forEach((function(e){var t=n.content.itemUUIDToItemHistoryMapping[e];n.content.itemUUIDToItemHistoryMapping[e]=new Tt(t)})),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lt(e,t)}(t,e),n=t,(r=[{key:"addEntryForItem",value:function(e){return this.historyForItem(e).addHistoryEntryForItem(e)}},{key:"historyForItem",value:function(e){var t=this.content.itemUUIDToItemHistoryMapping[e.uuid];return t||(t=this.content.itemUUIDToItemHistoryMapping[e.uuid]=new Tt),t}},{key:"clearItemHistory",value:function(e){this.historyForItem(e).clear()}},{key:"clearAllHistory",value:function(){this.content.itemUUIDToItemHistoryMapping={}}},{key:"optimizeHistoryForItem",value:function(e){var n=this.historyForItem(e);n.entries.length>t.LargeItemEntryAmountThreshold&&n.optimize()}}])&&Ft(n.prototype,r),o&&Ft(n,o),t}(U);function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kt(e,t,n){return t&&Ut(e.prototype,t),n&&Ut(e,n),e}Nt.LargeItemEntryAmountThreshold=60;var zt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$timeout=t||setTimeout.bind(Object(_.b)())}return Kt(e,null,[{key:"getApiVersion",value:function(){return"20190520"}}]),Kt(e,[{key:"setJWTRequestHandler",value:function(e){this.jwtRequestHandler=e}},{key:"setAuthHeadersForRequest",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.jwtRequestHandler());case 2:(t=n.sent)&&e.setRequestHeader("Authorization","Bearer "+t);case 4:case"end":return n.stop()}}),null,this)}},{key:"postAbsolute",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.httpRequest("post",e,t,n,r));case 1:case"end":return o.stop()}}),null,this)}},{key:"postAuthenticatedAbsolute",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.httpRequest("post",e,t,n,r,!0));case 1:case"end":return o.stop()}}),null,this)}},{key:"patchAbsolute",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.httpRequest("patch",e,t,n,r));case 1:case"end":return o.stop()}}),null,this)}},{key:"getAbsolute",value:function(e,t,n,r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.httpRequest("get",e,t,n,r));case 1:case"end":return o.stop()}}),null,this)}},{key:"httpRequest",value:function(e,t,n,r,o){var i,a=this,s=arguments;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return i=s.length>5&&void 0!==s[5]&&s[5],u.abrupt("return",new Promise((function(s,u){var c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:if((c=new XMLHttpRequest).onreadystatechange=function(){if(4==c.readyState){var e=c.responseText;if(e)try{e=JSON.parse(e)}catch(e){}c.status>=200&&c.status<=299?a.$timeout((function(){r(e),s(e)})):(console.error("Request error:",e),a.$timeout((function(){o(e,c.status),u(e)})))}},"get"==e&&Object.keys(n).length>0&&(t=a.urlForUrlAndParams(t,n)),c.open(e,t,!0),c.setRequestHeader("Content-type","application/json"),!i){l.next=8;break}return l.next=8,regeneratorRuntime.awrap(a.setAuthHeadersForRequest(c));case 8:"post"==e||"patch"==e?c.send(JSON.stringify(n)):c.send();case 9:case"end":return l.stop()}}))})));case 2:case"end":return u.stop()}}))}},{key:"urlForUrlAndParams",value:function(e,t){var n=Object.keys(t).map((function(e){return e+"="+encodeURIComponent(t[e])})).join("&");return e.includes("?")?e+"&"+n:e+"?"+n}}]),e}();function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"setItem",value:function(e,t){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"getItem",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"removeItem",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"clear",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"getAllModels",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"saveModel",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.saveModels([e]));case 1:case"end":return t.stop()}}),null,this)}},{key:"saveModels",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"deleteModel",value:function(e){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"clearAllModels",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}))}},{key:"clearAllData",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.clear(),this.clearAllModels()]));case 1:case"end":return e.stop()}}),null,this)}}])&&Wt(t.prototype,n),r&&Wt(t,r),e}();function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Vt=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.KeyRequestLoadLocal="KeyRequestLoadLocal",e.KeyRequestSaveLocal="KeyRequestSaveLocal",e.KeyRequestLoadSaveAccount="KeyRequestLoadSaveAccount",this.httpManager=r,this.modelManager=t,this.storageManager=n,this.$interval=i||setInterval.bind(window),this.$timeout=o||setTimeout.bind(window),this.syncStatus={},this.syncStatusObservers=[],this.eventHandlers=[],this.PerSyncItemUploadLimit=150,this.ServerItemDownloadLimit=150,this.MajorDataChangeThreshold=15,this.MaxDiscordanceBeforeOutOfSync=5,this.syncDiscordance=0,this.outOfSync=!1,this.contentTypeLoadPriority=["SN|UserPreferences","SN|Privileges","SN|Component","SN|Theme"]}var t,n,r;return t=e,(n=[{key:"handleServerIntegrityHash",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&0!=e.length){n.next=2;break}return n.abrupt("return",!0);case 2:return n.next=4,regeneratorRuntime.awrap(this.modelManager.computeDataIntegrityHash());case 4:if(t=n.sent){n.next=7;break}return n.abrupt("return",!0);case 7:if(t===e){n.next=13;break}return this.syncDiscordance++,this.syncDiscordance>=this.MaxDiscordanceBeforeOutOfSync&&(this.outOfSync||(this.outOfSync=!0,this.notifyEvent("enter-out-of-sync"))),n.abrupt("return",!1);case 13:return this.outOfSync&&(this.outOfSync=!1,this.notifyEvent("exit-out-of-sync")),this.syncDiscordance=0,n.abrupt("return",!0);case 16:case"end":return n.stop()}}),null,this)}},{key:"isOutOfSync",value:function(){return this.outOfSync}},{key:"getServerURL",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.storageManager.getItem("server"));case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=window._default_sf_server;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),null,this)}},{key:"getSyncURL",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.getServerURL());case 2:return e.t0=e.sent,e.abrupt("return",e.t0+"/items/sync");case 4:case"end":return e.stop()}}),null,this)}},{key:"registerSyncStatusObserver",value:function(e){var t={key:new Date,callback:e};return this.syncStatusObservers.push(t),t}},{key:"removeSyncStatusObserver",value:function(e){Le()(this.syncStatusObservers,e)}},{key:"syncStatusDidChange",value:function(){var e=this;this.syncStatusObservers.forEach((function(t){t.callback(e.syncStatus)}))}},{key:"addEventHandler",value:function(e){return this.eventHandlers.push(e),e}},{key:"removeEventHandler",value:function(e){Le()(this.eventHandlers,e)}},{key:"notifyEvent",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.eventHandlers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)(0,i.value)(e,t||{})}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"setKeyRequestHandler",value:function(e){this.keyRequestHandler=e}},{key:"getActiveKeyInfo",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.keyRequestHandler(e));case 1:case"end":return t.stop()}}),null,this)}},{key:"initialDataLoaded",value:function(){return!0===this._initialDataLoaded}},{key:"_sortLocalItems",value:function(e){var t=this;return e.sort((function(e,n){var r=new Date(n.updated_at)-new Date(e.updated_at),o=t.contentTypeLoadPriority,i=0,a=0;return o&&(i=o.indexOf(e.content_type),a=o.indexOf(n.content_type),-1==i&&(i=o.length),-1==a&&(a=o.length)),i==a?r:i<a?-1:1}))}},{key:"loadLocalItems",value:function(){var t,n,r,o,i,a=this,s=arguments;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},n=t.incrementalCallback,r=t.batchSize,!(o=t.options)||!o.simulateHighLatency){u.next=5;break}return i=o.simulatedLatency||1e3,u.next=5,regeneratorRuntime.awrap(this._awaitSleep(i));case 5:if(!this.loadLocalDataPromise){u.next=7;break}return u.abrupt("return",this.loadLocalDataPromise);case 7:return r||(r=100),this.loadLocalDataPromise=this.storageManager.getAllModels().then((function(t){var o=(t=(t=a._sortLocalItems(t)).filter((function(e){var t=a.modelManager.findItem(e.uuid);return!t||new Date(e.dirtiedDate)>t.dirtiedDate}))).length,i=0,s=[];return function u(){var c,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return c=t.slice(i,i+r),f.next=3,regeneratorRuntime.awrap(a.handleItemsResponse(c,null,Ct.MappingSourceLocalRetrieved,e.KeyRequestLoadLocal));case 3:if(l=f.sent,s.push(l),!((i+=c.length)<o)){f.next=10;break}return f.abrupt("return",new Promise((function(e,t){a.$timeout((function(){a.notifyEvent("local-data-incremental-load"),n&&n(i,o),u().then(e)}))})));case 10:a._initialDataLoaded=!0,a.notifyEvent("local-data-loaded");case 12:case"end":return f.stop()}}))}()})),u.abrupt("return",this.loadLocalDataPromise);case 10:case"end":return u.stop()}}),null,this)}},{key:"writeItemsToLocalStorage",value:function(t,n){var r=this;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(0!=t.length){o.next=2;break}return o.abrupt("return");case 2:return o.abrupt("return",new Promise((function(o,i){var a,s,u,c,l,f,p,y,h,d;return regeneratorRuntime.async((function(v){for(;;)switch(v.prev=v.next){case 0:for(a=[],s=[],u=!0,c=!1,l=void 0,v.prev=4,f=t[Symbol.iterator]();!(u=(p=f.next()).done);u=!0)!0!==(y=p.value).deleted||y.dirty?a.push(y):s.push(y);v.next=12;break;case 8:v.prev=8,v.t0=v.catch(4),c=!0,l=v.t0;case 12:v.prev=12,v.prev=13,u||null==f.return||f.return();case 15:if(v.prev=15,!c){v.next=18;break}throw l;case 18:return v.finish(15);case 19:return v.finish(12);case 20:if(!(s.length>0)){v.next=23;break}return v.next=23,regeneratorRuntime.awrap(Promise.all(s.map((function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.storageManager.deleteModel(e));case 1:case"end":return t.stop()}}))}))));case 23:return v.next=25,regeneratorRuntime.awrap(r.getActiveKeyInfo(e.KeyRequestSaveLocal));case 25:if(h=v.sent,!(a.length>0)){v.next=33;break}return v.next=29,regeneratorRuntime.awrap(Promise.all(a.map((function(e){var t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new X(e,h.keys,h.auth_params),r.next=3,regeneratorRuntime.awrap(t.paramsForLocalStorage());case 3:return t=r.sent,n&&delete t.dirty,r.abrupt("return",t);case 6:case"end":return r.stop()}}))}))).catch((function(e){return i(e)})));case 29:return d=v.sent,v.next=32,regeneratorRuntime.awrap(r.storageManager.saveModels(d).catch((function(e){console.error("Error writing items",e),r.syncStatus.localError=e,r.syncStatusDidChange(),i()})));case 32:r.syncStatus.localError&&(r.syncStatus.localError=null,r.syncStatusDidChange());case 33:o();case 34:case"end":return v.stop()}}),null,null,[[4,8,12,20],[13,,15,19]])})));case 3:case"end":return o.stop()}}))}},{key:"syncOffline",value:function(e){var t,n,r,o,i,a=this;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:for(t=!0,n=!1,r=void 0,s.prev=3,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)i.value.updated_at=new Date;s.next=11;break;case 7:s.prev=7,s.t0=s.catch(3),n=!0,r=s.t0;case 11:s.prev=11,s.prev=12,t||null==o.return||o.return();case 14:if(s.prev=14,!n){s.next=17;break}throw r;case 17:return s.finish(14);case 18:return s.finish(11);case 19:return s.abrupt("return",this.writeItemsToLocalStorage(e,!0).then((function(t){var n=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;u.deleted&&a.modelManager.removeItemLocally(u)}}catch(e){r=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return a.modelManager.clearDirtyItems(e),a.modelManager.didSyncModelsOffline(e),a.notifyEvent("sync:completed",{savedItems:e}),{saved_items:e}})));case 20:case"end":return s.stop()}}),null,this,[[3,7,11,19],[12,,14,18]])}},{key:"markAllItemsDirtyAndSaveOffline",value:function(e){var t,n,r,o,i,a,s,u,c,l,f,p,y;return regeneratorRuntime.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(!e){h.next=28;break}t=this.modelManager.allNondummyItems.filter((function(e){return!e.errorDecrypting})).slice(),n=!0,r=!1,o=void 0,h.prev=5,i=t[Symbol.iterator]();case 7:if(n=(a=i.next()).done){h.next=14;break}return s=a.value,h.next=11,regeneratorRuntime.awrap(this.modelManager.alternateUUIDForItem(s));case 11:n=!0,h.next=7;break;case 14:h.next=20;break;case 16:h.prev=16,h.t0=h.catch(5),r=!0,o=h.t0;case 20:h.prev=20,h.prev=21,n||null==i.return||i.return();case 23:if(h.prev=23,!r){h.next=26;break}throw o;case 26:return h.finish(23);case 27:return h.finish(20);case 28:for(u=this.modelManager.allNondummyItems,c=!0,l=!1,f=void 0,h.prev=32,p=u[Symbol.iterator]();!(c=(y=p.next()).done);c=!0)y.value.setDirty(!0);h.next=40;break;case 36:h.prev=36,h.t1=h.catch(32),l=!0,f=h.t1;case 40:h.prev=40,h.prev=41,c||null==p.return||p.return();case 43:if(h.prev=43,!l){h.next=46;break}throw f;case 46:return h.finish(43);case 47:return h.finish(40);case 48:return h.abrupt("return",this.writeItemsToLocalStorage(u,!1));case 49:case"end":return h.stop()}}),null,this,[[5,16,20,28],[21,,23,27],[32,36,40,48],[41,,43,47]])}},{key:"setSyncToken",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this._syncToken=e,t.next=3,regeneratorRuntime.awrap(this.storageManager.setItem("syncToken",e));case 3:case"end":return t.stop()}}),null,this)}},{key:"getSyncToken",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._syncToken){e.next=4;break}return e.next=3,regeneratorRuntime.awrap(this.storageManager.getItem("syncToken"));case 3:this._syncToken=e.sent;case 4:return e.abrupt("return",this._syncToken);case 5:case"end":return e.stop()}}),null,this)}},{key:"setCursorToken",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._cursorToken=e,!e){t.next=6;break}return t.next=4,regeneratorRuntime.awrap(this.storageManager.setItem("cursorToken",e));case 4:t.next=8;break;case 6:return t.next=8,regeneratorRuntime.awrap(this.storageManager.removeItem("cursorToken"));case 8:case"end":return t.stop()}}),null,this)}},{key:"getCursorToken",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cursorToken){e.next=4;break}return e.next=3,regeneratorRuntime.awrap(this.storageManager.getItem("cursorToken"));case 3:this._cursorToken=e.sent;case 4:return e.abrupt("return",this._cursorToken);case 5:case"end":return e.stop()}}),null,this)}},{key:"clearQueuedCallbacks",value:function(){this._queuedCallbacks=[]}},{key:"callQueuedCallbacks",value:function(e){var t=this.queuedCallbacks;if(t.length){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)(0,i.value)(e)}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}this.clearQueuedCallbacks()}}},{key:"beginCheckingIfSyncIsTakingTooLong",value:function(){this.syncStatus.checker&&this.stopCheckingIfSyncIsTakingTooLong(),this.syncStatus.checker=this.$interval(function(){(new Date-this.syncStatus.syncStart)/1e3>5&&(this.notifyEvent("sync:taking-too-long"),this.stopCheckingIfSyncIsTakingTooLong())}.bind(this),500)}},{key:"stopCheckingIfSyncIsTakingTooLong",value:function(){this.$interval.hasOwnProperty("cancel")?this.$interval.cancel(this.syncStatus.checker):clearInterval(this.syncStatus.checker),this.syncStatus.checker=null}},{key:"lockSyncing",value:function(){this.syncLocked=!0}},{key:"unlockSyncing",value:function(){this.syncLocked=!1}},{key:"sync",value:function(){var t,n=this,r=arguments;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},!this.syncLocked){o.next=4;break}return console.log("Sync Locked, Returning;"),o.abrupt("return");case 4:return o.abrupt("return",new Promise((function(r,o){var i,a,s,u,c,l,f,p,y,h,d,v,m,g;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t||(t={}),i=n.modelManager.getDirtyItems(),a=i.filter((function(e){return!n.lastDirtyItemsSave||e.dirtiedDate>n.lastDirtyItemsSave})),o.next=5,regeneratorRuntime.awrap(n.getActiveKeyInfo(e.KeyRequestLoadSaveAccount));case 5:if(s=o.sent,u=n.syncStatus.syncOpInProgress,c=n.initialDataLoaded(),!u&&c){o.next=16;break}return n.performSyncAgainOnCompletion=!0,n.lastDirtyItemsSave=new Date,o.next=13,regeneratorRuntime.awrap(n.writeItemsToLocalStorage(a,!1));case 13:return u&&(n.queuedCallbacks.push(r),n.loggingEnabled&&console.warn("Attempting to sync while existing sync is in progress.")),c||(n.loggingEnabled&&console.warn("(1) Attempting to perform online sync before local data has loaded"),r()),o.abrupt("return");case 16:if(n.syncStatus.syncOpInProgress=!0,!s.offline){o.next=19;break}return o.abrupt("return",n.syncOffline(i).then((function(e){n.syncStatus.syncOpInProgress=!1,r(e)})).catch((function(e){n.notifyEvent("sync-exception",e)})));case 19:if(n.initialDataLoaded()){o.next=22;break}return console.error("Attempting to perform online sync before local data has loaded"),o.abrupt("return");case 22:return n.loggingEnabled&&console.log("Syncing online user."),l=n.syncStatus.needsMoreSync,n.syncStatus.syncStart=new Date,n.beginCheckingIfSyncIsTakingTooLong(),f=n.PerSyncItemUploadLimit,(p=i.slice(0,f)).length<i.length?n.syncStatus.needsMoreSync=!0:n.syncStatus.needsMoreSync=!1,l||(n.syncStatus.total=i.length,n.syncStatus.current=0),n.syncStatus.current>n.syncStatus.total&&(n.syncStatus.total=n.syncStatus.current),n.syncStatusDidChange(),o.next=34,regeneratorRuntime.awrap(n.writeItemsToLocalStorage(a,!1));case 34:return n.lastDirtyItemsSave=new Date,t.onPreSyncSave&&t.onPreSyncSave(),n.allRetreivedItems||(n.allRetreivedItems=[]),n.allSavedItems||(n.allSavedItems=[]),(y={}).limit=n.ServerItemDownloadLimit,t.performIntegrityCheck&&(y.compute_integrity=!0),o.prev=41,o.next=44,regeneratorRuntime.awrap(Promise.all(p.map((function(e){var n=new X(e,s.keys,s.auth_params);return n.additionalFields=t.additionalFields,n.paramsForSync()}))).then((function(e){y.items=e})));case 44:o.next=49;break;case 46:o.prev=46,o.t0=o.catch(41),n.notifyEvent("sync-exception",o.t0);case 49:for(h=!0,d=!1,v=void 0,o.prev=52,m=p[Symbol.iterator]();!(h=(g=m.next()).done);h=!0)g.value.dirtyCount=0;o.next=60;break;case 56:o.prev=56,o.t1=o.catch(52),d=!0,v=o.t1;case 60:o.prev=60,o.prev=61,h||null==m.return||m.return();case 63:if(o.prev=63,!d){o.next=66;break}throw v;case 66:return o.finish(63);case 67:return o.finish(60);case 68:return o.next=70,regeneratorRuntime.awrap(n.getSyncToken());case 70:return y.sync_token=o.sent,o.next=73,regeneratorRuntime.awrap(n.getCursorToken());case 73:return y.cursor_token=o.sent,y.api=zt.getApiVersion(),n.loggingEnabled&&console.log("Syncing with params",y),o.prev=76,o.t2=n.httpManager,o.next=80,regeneratorRuntime.awrap(n.getSyncURL());case 80:o.t3=o.sent,o.t4=y,o.t5=function(e){n.handleSyncSuccess(p,e,t).then((function(){r(e)})).catch((function(e){console.log("Caught sync success exception:",e),n.handleSyncError(e,null,i).then((function(t){n.notifyEvent("sync-exception",e),r(t)}))}))},o.t6=function(e,t){n.handleSyncError(e,t,i).then((function(e){r(e)}))},o.t2.postAuthenticatedAbsolute.call(o.t2,o.t3,o.t4,o.t5,o.t6),o.next=90;break;case 87:o.prev=87,o.t7=o.catch(76),console.log("Sync exception caught:",o.t7);case 90:case"end":return o.stop()}}),null,null,[[41,46],[52,56,60,68],[61,,63,67],[76,87]])})));case 5:case"end":return o.stop()}}),null,this)}},{key:"_awaitSleep",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return console.warn("Simulating high latency sync request",e),t.abrupt("return",new Promise((function(t,n){setTimeout((function(){t()}),e)})));case 2:case"end":return t.stop()}}))}},{key:"handleSyncSuccess",value:function(t,n,r){var o,i,a,s,u,c,l,f,p,y,h,d,v,m,g,b,x,S,k,w,_,R,I,C,A,D,M,j=this;return regeneratorRuntime.async((function(P){for(;;)switch(P.prev=P.next){case 0:if(!r.simulateHighLatency){P.next=4;break}return o=r.simulatedLatency||1e3,P.next=4,regeneratorRuntime.awrap(this._awaitSleep(o));case 4:for(this.syncStatus.error=null,this.loggingEnabled&&console.log("Sync response",n),i=this.allSavedItems.map((function(e){return e.uuid})),a=n.saved_items.map((function(e){return e.uuid})),s=[],n.retrieved_items=n.retrieved_items.filter((function(e){var t=i.includes(e.uuid),n=a.includes(e.uuid);if(t||n)return s.push(e),!1;var r=j.modelManager.findItem(e.uuid);return!r||!r.dirty||(s.push(e),!1)})),u=[],c=!0,l=!1,f=void 0,P.prev=14,p=t[Symbol.iterator]();!(c=(y=p.next()).done);c=!0)0==(h=y.value).dirtyCount&&u.push(h);P.next=22;break;case 18:P.prev=18,P.t0=P.catch(14),l=!0,f=P.t0;case 22:P.prev=22,P.prev=23,c||null==p.return||p.return();case 25:if(P.prev=25,!l){P.next=28;break}throw f;case 28:return P.finish(25);case 29:return P.finish(22);case 30:if(this.modelManager.clearDirtyItems(u),d=[],!(s.length>0)){P.next=72;break}return P.next=35,regeneratorRuntime.awrap(this.getActiveKeyInfo(e.KeyRequestLoadSaveAccount));case 35:return v=P.sent.keys,P.next=38,regeneratorRuntime.awrap(O.decryptMultipleItems(s,v));case 38:m=!0,g=!1,b=void 0,P.prev=41,x=s[Symbol.iterator]();case 43:if(m=(S=x.next()).done){P.next=58;break}if(k=S.value,w=this.modelManager.findItem(k.uuid),_=JSON.parse(k.content),w&&_){P.next=49;break}return P.abrupt("continue",55);case 49:if(!w||w.isContentEqualWithNonItemContent(_)){P.next=55;break}return P.next=52,regeneratorRuntime.awrap(this.modelManager.createDuplicateItemFromResponseItem(k));case 52:R=P.sent,this.modelManager.addDuplicatedItemAsConflict({duplicate:R,duplicateOf:w}),d.push(R);case 55:m=!0,P.next=43;break;case 58:P.next=64;break;case 60:P.prev=60,P.t1=P.catch(41),g=!0,b=P.t1;case 64:P.prev=64,P.prev=65,m||null==x.return||x.return();case 67:if(P.prev=67,!g){P.next=70;break}throw b;case 70:return P.finish(67);case 71:return P.finish(64);case 72:return P.next=74,regeneratorRuntime.awrap(this.handleItemsResponse(n.retrieved_items,null,Ct.MappingSourceRemoteRetrieved,e.KeyRequestLoadSaveAccount));case 74:return I=P.sent,this.allRetreivedItems=this.allRetreivedItems.concat(I),this.syncStatus.retrievedCount=this.allRetreivedItems.length,C=["content","auth_hash"],P.next=80,regeneratorRuntime.awrap(this.handleItemsResponse(n.saved_items,C,Ct.MappingSourceRemoteSaved,e.KeyRequestLoadSaveAccount));case 80:return A=P.sent,this.allSavedItems=this.allSavedItems.concat(A),D=n.unsaved,P.next=85,regeneratorRuntime.awrap(this.deprecated_handleUnsavedItemsResponse(D));case 85:return P.next=87,regeneratorRuntime.awrap(this.handleConflictsResponse(n.conflicts));case 87:if(P.t2=P.sent,P.t2){P.next=90;break}P.t2=[];case 90:if(M=P.t2,!((d=d.concat(M)).length>0)){P.next=95;break}return P.next=95,regeneratorRuntime.awrap(this.writeItemsToLocalStorage(d,!1));case 95:return P.next=97,regeneratorRuntime.awrap(this.writeItemsToLocalStorage(A,!1));case 97:return P.next=99,regeneratorRuntime.awrap(this.writeItemsToLocalStorage(I,!1));case 99:if(!n.integrity_hash||n.cursor_token){P.next=104;break}return P.next=102,regeneratorRuntime.awrap(this.handleServerIntegrityHash(n.integrity_hash));case 102:P.sent||this.syncDiscordance<this.MaxDiscordanceBeforeOutOfSync&&(this.performSyncAgainOnCompletion=!0);case 104:return this.syncStatus.syncOpInProgress=!1,this.syncStatus.current+=t.length,this.syncStatusDidChange(),this.setSyncToken(n.sync_token),this.setCursorToken(n.cursor_token),this.stopCheckingIfSyncIsTakingTooLong(),P.next=112,regeneratorRuntime.awrap(this.getCursorToken());case 112:if(!P.sent&&!this.syncStatus.needsMoreSync){P.next=117;break}return P.abrupt("return",new Promise((function(e,t){setTimeout(function(){this.sync(r).then(e)}.bind(j),10)})));case 117:if(!(d.length>0)){P.next=122;break}return this.performSyncAgainOnCompletion=!1,P.abrupt("return",new Promise((function(e,t){setTimeout((function(){j.sync(r).then(e)}),10)})));case 122:return this.syncStatus.retrievedCount=0,this.syncStatus.current=0,this.syncStatus.total=0,this.syncStatusDidChange(),(this.allRetreivedItems.length>=this.majorDataChangeThreshold||A.length>=this.majorDataChangeThreshold||D&&D.length>=this.majorDataChangeThreshold||d&&d.length>=this.majorDataChangeThreshold)&&this.notifyEvent("major-data-change"),this.callQueuedCallbacks(n),this.notifyEvent("sync:completed",{retrievedItems:this.allRetreivedItems,savedItems:this.allSavedItems}),this.allRetreivedItems=[],this.allSavedItems=[],this.performSyncAgainOnCompletion&&(this.performSyncAgainOnCompletion=!1,setTimeout((function(){j.sync(r)}),10)),P.abrupt("return",n);case 133:case"end":return P.stop()}}),null,this,[[14,18,22,30],[23,,25,29],[41,60,64,72],[65,,67,71]])}},{key:"handleSyncError",value:function(e,t,n){return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return console.log("Sync error: ",e),401==t&&this.notifyEvent("sync-session-invalid"),e?"string"==typeof e&&(e={error:{message:e}}):e={error:{message:"Could not connect to server."}},this.syncStatus.syncOpInProgress=!1,this.syncStatus.error=e.error,this.syncStatusDidChange(),this.writeItemsToLocalStorage(n,!1),this.modelManager.didSyncModelsOffline(n),this.stopCheckingIfSyncIsTakingTooLong(),this.notifyEvent("sync:error",e.error),this.callQueuedCallbacks({error:"Sync error"}),r.abrupt("return",e);case 12:case"end":return r.stop()}}),null,this)}},{key:"handleItemsResponse",value:function(e,t,n,r){var o,i,a;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap(this.getActiveKeyInfo(r));case 2:return o=s.sent.keys,s.next=5,regeneratorRuntime.awrap(O.decryptMultipleItems(e,o));case 5:return s.next=7,regeneratorRuntime.awrap(this.modelManager.mapResponseItemsToLocalModelsOmittingFields(e,t,n));case 7:return i=s.sent,(a=i.filter((function(e){var t=e.errorDecryptingValueChanged;return e.errorDecryptingValueChanged=!1,t}))).length>0&&this.writeItemsToLocalStorage(a,!1),s.abrupt("return",i);case 11:case"end":return s.stop()}}),null,this)}},{key:"refreshErroredItems",value:function(){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((t=this.modelManager.allNondummyItems.filter((function(e){return 1==e.errorDecrypting}))).length>0)){n.next=3;break}return n.abrupt("return",this.handleItemsResponse(t,null,Ct.MappingSourceLocalRetrieved,e.KeyRequestLoadSaveAccount));case 3:case"end":return n.stop()}}),null,this)}},{key:"handleConflictsResponse",value:function(t){var n,r,o,i,a,s,u,c,l,f,p,y,h,d,v,m,g,b,x,S,k,w,_,R,I,C,A,D,M,j,P;return regeneratorRuntime.async((function(T){for(;;)switch(T.prev=T.next){case 0:if(t&&0!=t.length){T.next=2;break}return T.abrupt("return");case 2:this.loggingEnabled&&console.log("Handle Conflicted Items:",t),n={},r=!0,o=!1,i=void 0,T.prev=7,a=t[Symbol.iterator]();case 9:if(r=(s=a.next()).done){T.next=21;break}if(u=s.value,c=u.server_item||u.unsaved_item,l=this.modelManager.findItem(c.uuid)){T.next=16;break}return n[c.uuid]={},T.abrupt("continue",18);case 16:f=l.getContentCopy(),n[c.uuid]={frozenCurrentContent:f,itemRef:l};case 18:r=!0,T.next=9;break;case 21:T.next=27;break;case 23:T.prev=23,T.t0=T.catch(7),o=!0,i=T.t0;case 27:T.prev=27,T.prev=28,r||null==a.return||a.return();case 30:if(T.prev=30,!o){T.next=33;break}throw i;case 33:return T.finish(30);case 34:return T.finish(27);case 35:p=[],y=!0,h=!1,d=void 0,T.prev=39,v=t[Symbol.iterator]();case 41:if(y=(m=v.next()).done){T.next=93;break}return g=m.value,b=g.server_item||g.unsaved_item,T.t1=regeneratorRuntime,T.t2=O,T.t3=[b],T.next=49,regeneratorRuntime.awrap(this.getActiveKeyInfo(e.KeyRequestLoadSaveAccount));case 49:return T.t4=T.sent.keys,T.t5=T.t2.decryptMultipleItems.call(T.t2,T.t3,T.t4),T.next=53,T.t1.awrap.call(T.t1,T.t5);case 53:if(x=n[b.uuid],S=x.frozenCurrentContent,k=x.itemRef){T.next=56;break}return T.abrupt("continue",90);case 56:if(p.push(k),"uuid_conflict"!==g.type){T.next=64;break}return T.next=60,regeneratorRuntime.awrap(this.modelManager.alternateUUIDForItem(k));case 60:w=T.sent,p.push(w),T.next=90;break;case 64:if("sync_conflict"!==g.type){T.next=88;break}return T.next=67,regeneratorRuntime.awrap(this.modelManager.createDuplicateItemFromResponseItem(b));case 67:if(_=T.sent,R=this.modelManager.duplicateItemWithCustomContent({content:S,duplicateOf:k}),I=!R.isItemContentEqualWith(_),C=!k.isItemContentEqualWith(_),A=!1,D=!1,M=!1,j=!1,b.deleted||k.deleted?j=!0:I?(new Date-k.client_updated_at)/1e3<20?(M=!0,D=!0):(A=!0,j=!0):C?!SFItem.AreItemContentsEqual({leftContent:k.content,rightContent:_.content,keysToIgnore:k.keysToIgnoreWhenCheckingContentEquality().concat(["references"]),appDataKeysToIgnore:k.appDataKeysToIgnoreWhenCheckingContentEquality()})?(A=!0,j=!0):M=!0:j=!0,!A){T.next=81;break}return T.next=79,regeneratorRuntime.awrap(this.modelManager.duplicateItemWithCustomContentAndAddAsConflict({content:S,duplicateOf:k}));case 79:P=T.sent,p.push(P);case 81:if(D&&(this.modelManager.addDuplicatedItemAsConflict({duplicate:_,duplicateOf:k}),p.push(_)),!j){T.next=85;break}return T.next=85,regeneratorRuntime.awrap(this.modelManager.mapResponseItemsToLocalModelsOmittingFields([b],null,Ct.MappingSourceRemoteRetrieved));case 85:M&&(k.updated_at=_.updated_at,k.setDirty(!0)),T.next=90;break;case 88:return console.error("Unsupported conflict type",g.type),T.abrupt("continue",90);case 90:y=!0,T.next=41;break;case 93:T.next=99;break;case 95:T.prev=95,T.t6=T.catch(39),h=!0,d=T.t6;case 99:T.prev=99,T.prev=100,y||null==v.return||v.return();case 102:if(T.prev=102,!h){T.next=105;break}throw d;case 105:return T.finish(102);case 106:return T.finish(99);case 107:return T.abrupt("return",p);case 108:case"end":return T.stop()}}),null,this,[[7,23,27,35],[28,,30,34],[39,95,99,107],[100,,102,106]])}},{key:"deprecated_handleUnsavedItemsResponse",value:function(t){var n,r,o,i,a,s,u,c,l,f;return regeneratorRuntime.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(t&&0!=t.length){p.next=2;break}return p.abrupt("return");case 2:this.loggingEnabled&&console.log("Handle Unsaved Items:",t),n=!0,r=!1,o=void 0,p.prev=6,i=t[Symbol.iterator]();case 8:if(n=(a=i.next()).done){p.next=37;break}return s=a.value,u=s.item,p.t0=regeneratorRuntime,p.t1=O,p.t2=[u],p.next=16,regeneratorRuntime.awrap(this.getActiveKeyInfo(e.KeyRequestLoadSaveAccount));case 16:return p.t3=p.sent.keys,p.t4=p.t1.decryptMultipleItems.call(p.t1,p.t2,p.t3),p.next=20,p.t0.awrap.call(p.t0,p.t4);case 20:if(c=this.modelManager.findItem(u.uuid)){p.next=23;break}return p.abrupt("continue",34);case 23:if("uuid_conflict"!==(l=s.error).tag){p.next=29;break}return p.next=27,regeneratorRuntime.awrap(this.modelManager.alternateUUIDForItem(c));case 27:p.next=34;break;case 29:if("sync_conflict"!==l.tag){p.next=34;break}return p.next=32,regeneratorRuntime.awrap(this.modelManager.createDuplicateItemFromResponseItem(u));case 32:f=p.sent,u.deleted||c.isItemContentEqualWith(f)||this.modelManager.addDuplicatedItemAsConflict({duplicate:f,duplicateOf:c});case 34:n=!0,p.next=8;break;case 37:p.next=43;break;case 39:p.prev=39,p.t5=p.catch(6),r=!0,o=p.t5;case 43:p.prev=43,p.prev=44,n||null==i.return||i.return();case 46:if(p.prev=46,!r){p.next=49;break}throw o;case 49:return p.finish(46);case 50:return p.finish(43);case 51:case"end":return p.stop()}}),null,this,[[6,39,43,51],[44,,46,50]])}},{key:"stateless_downloadAllItems",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(r,o){var i;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return i={limit:n.limit||500,sync_token:n.syncToken,cursor_token:n.cursorToken,content_type:n.contentType,event:n.event,api:zt.getApiVersion()},a.prev=1,a.t0=t.httpManager,a.next=5,regeneratorRuntime.awrap(t.getSyncURL());case 5:a.t1=a.sent,a.t2=i,a.t3=function(o){var i,a;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n.retrievedItems||(n.retrievedItems=[]),i=o.retrieved_items,s.next=4,regeneratorRuntime.awrap(t.getActiveKeyInfo(e.KeyRequestLoadSaveAccount));case 4:return a=s.sent.keys,s.next=7,regeneratorRuntime.awrap(O.decryptMultipleItems(i,a));case 7:n.retrievedItems=n.retrievedItems.concat(i.map((function(e){return t.modelManager.createItem(e)}))),n.syncToken=o.sync_token,n.cursorToken=o.cursor_token,n.cursorToken?t.stateless_downloadAllItems(n).then(r):r(n.retrievedItems);case 11:case"end":return s.stop()}}))},a.t4=function(e,t){o(e)},a.t0.postAuthenticatedAbsolute.call(a.t0,a.t1,a.t2,a.t3,a.t4),a.next=16;break;case 12:a.prev=12,a.t5=a.catch(1),console.log("Download all items exception caught:",a.t5),o(a.t5);case 16:case"end":return a.stop()}}),null,null,[[1,12]])}))}},{key:"resolveOutOfSync",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.stateless_downloadAllItems({event:"resolve-out-of-sync"}).then((function(t){var n,r,o,i,a,s,u,c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:n=[],r=!0,o=!1,i=void 0,l.prev=4,a=t[Symbol.iterator]();case 6:if(r=(s=a.next()).done){l.next=18;break}if(u=s.value,!(c=e.modelManager.findItem(u.uuid))){l.next=14;break}if(u.isItemContentEqualWith(c)){l.next=14;break}return l.next=14,regeneratorRuntime.awrap(e.modelManager.duplicateItemAndAddAsConflict(c));case 14:n.push(u);case 15:r=!0,l.next=6;break;case 18:l.next=24;break;case 20:l.prev=20,l.t0=l.catch(4),o=!0,i=l.t0;case 24:l.prev=24,l.prev=25,r||null==a.return||a.return();case 27:if(l.prev=27,!o){l.next=30;break}throw i;case 30:return l.finish(27);case 31:return l.finish(24);case 32:return l.next=34,regeneratorRuntime.awrap(e.modelManager.mapResponseItemsToLocalModelsWithOptions({items:n,source:Ct.MappingSourceRemoteRetrieved}));case 34:return l.next=36,regeneratorRuntime.awrap(e.writeItemsToLocalStorage(e.modelManager.allNondummyItems));case 36:return l.abrupt("return",e.sync({performIntegrityCheck:!0}));case 37:case"end":return l.stop()}}),null,null,[[4,20,24,32],[25,,27,31]])})));case 1:case"end":return t.stop()}}),null,this)}},{key:"handleSignout",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.outOfSync=!1,this.loadLocalDataPromise=null,this.performSyncAgainOnCompletion=!1,this.syncStatus.syncOpInProgress=!1,this._queuedCallbacks=[],this.syncStatus={},e.abrupt("return",this.clearSyncToken());case 7:case"end":return e.stop()}}),null,this)}},{key:"clearSyncToken",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this._syncToken=null,this._cursorToken=null,e.abrupt("return",this.storageManager.removeItem("syncToken"));case 3:case"end":return e.stop()}}),null,this)}},{key:"__setLocalDataNotLoaded",value:function(){this.loadLocalDataPromise=null,this._initialDataLoaded=!1}},{key:"queuedCallbacks",get:function(){return this._queuedCallbacks||(this._queuedCallbacks=[]),this._queuedCallbacks}}])&&Jt(t.prototype,n),r&&Jt(t,r),e}();function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"alert",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){window.alert(e.text),t()})));case 1:case"end":return t.stop()}}))}},{key:"confirm",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){window.confirm(e.text)?t():n()})));case 1:case"end":return t.stop()}}))}}])&&$t(t.prototype,n),r&&$t(t,r),e}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yt=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.DidSignOutEvent="DidSignOutEvent",e.WillSignInEvent="WillSignInEvent",e.DidSignInEvent="DidSignInEvent",this.httpManager=n,this.storageManager=t,this.alertManager=r||new Xt,this.$timeout=o||setTimeout.bind(window),this.eventHandlers=[]}var t,n,r;return t=e,(n=[{key:"getMinPasswordLength",value:function(){return 8}},{key:"addEventHandler",value:function(e){return this.eventHandlers.push(e),e}},{key:"removeEventHandler",value:function(e){Le()(this.eventHandlers,e)}},{key:"notifyEvent",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this.eventHandlers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)(0,i.value)(e,t||{})}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"saveKeys",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this._keys=e,t.next=3,regeneratorRuntime.awrap(this.storageManager.setItem("mk",e.mk));case 3:return t.next=5,regeneratorRuntime.awrap(this.storageManager.setItem("ak",e.ak));case 5:case"end":return t.stop()}}),null,this)}},{key:"signout",value:function(t){var n=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._keys=null,this._authParams=null,!t){r.next=6;break}return r.abrupt("return",this.storageManager.clearAllData().then((function(){n.notifyEvent(e.DidSignOutEvent)})));case 6:this.notifyEvent(e.DidSignOutEvent);case 7:case"end":return r.stop()}}),null,this)}},{key:"keys",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._keys){t.next=11;break}return t.next=3,regeneratorRuntime.awrap(this.storageManager.getItem("mk"));case 3:if(e=t.sent){t.next=6;break}return t.abrupt("return",null);case 6:return t.t0=e,t.next=9,regeneratorRuntime.awrap(this.storageManager.getItem("ak"));case 9:t.t1=t.sent,this._keys={mk:t.t0,ak:t.t1};case 11:return t.abrupt("return",this._keys);case 12:case"end":return t.stop()}}),null,this)}},{key:"getAuthParams",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._authParams){t.next=5;break}return t.next=3,regeneratorRuntime.awrap(this.storageManager.getItem("auth_params"));case 3:e=t.sent,this._authParams=JSON.parse(e);case 5:if(!this._authParams||this._authParams.version){t.next=9;break}return t.next=8,regeneratorRuntime.awrap(this.defaultProtocolVersion());case 8:this._authParams.version=t.sent;case 9:return t.abrupt("return",this._authParams);case 10:case"end":return t.stop()}}),null,this)}},{key:"defaultProtocolVersion",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.keys());case 2:if(!(e=t.sent)||!e.ak){t.next=7;break}return t.abrupt("return","002");case 7:return t.abrupt("return","001");case 8:case"end":return t.stop()}}),null,this)}},{key:"protocolVersion",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.getAuthParams());case 2:if(!(e=t.sent)||!e.version){t.next=5;break}return t.abrupt("return",e.version);case 5:return t.abrupt("return",this.defaultProtocolVersion());case 6:case"end":return t.stop()}}),null,this)}},{key:"getAuthParamsForEmail",value:function(e,t,n){var r,o=this;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return(r=q()({email:t},n)).api=zt.getApiVersion(),i.abrupt("return",new Promise((function(t,n){var i=e+"/auth/params";o.httpManager.getAbsolute(i,r,(function(e){t(e)}),(function(e){console.error("Error getting auth params",e),"object"!==Gt(e)&&(e={error:{message:"A server error occurred while trying to sign in. Please try again."}}),t(e)}))})));case 3:case"end":return i.stop()}}))}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"isLocked",value:function(){return 1==this.locked}},{key:"unlockAndResolve",value:function(e,t){this.unlock(),e(t)}},{key:"login",value:function(t,n,r,o,i){var a=this;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,u){var c,l,f,p,y,h,d,v,m,g;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,regeneratorRuntime.awrap(a.keys());case 2:if(null==u.sent){u.next=6;break}return s({error:{message:"Cannot log in because already signed in."}}),u.abrupt("return");case 6:if(!a.isLocked()){u.next=9;break}return s({error:{message:"Login already in progress."}}),u.abrupt("return");case 9:return a.lock(),a.notifyEvent(e.WillSignInEvent),u.next=13,regeneratorRuntime.awrap(a.getAuthParamsForEmail(t,n,i));case 13:if((c=u.sent).identifier=n,!c.error){u.next=18;break}return a.unlockAndResolve(s,c),u.abrupt("return");case 18:if(c&&c.pw_cost){u.next=21;break}return a.unlockAndResolve(s,{error:{message:"Invalid email or password."}}),u.abrupt("return");case 21:if(O.supportedVersions().includes(c.version)){u.next=25;break}return l=O.isVersionNewerThanLibraryVersion(c.version)?"This version of the application does not support your newer account type. Please upgrade to the latest version of Standard Notes to sign in.":"The protocol version associated with your account is outdated and no longer supported by this application. Please visit standardnotes.org/help/security for more information.",a.unlockAndResolve(s,{error:{message:l}}),u.abrupt("return");case 25:if(!O.isProtocolVersionOutdated(c.version)){u.next=32;break}return f="The encryption version for your account, ".concat(c.version,", is outdated and requires upgrade. You may proceed with login, but are advised to perform a security update using the web or desktop application. Please visit standardnotes.org/help/security for more information."),p=!1,u.next=30,regeneratorRuntime.awrap(a.alertManager.confirm({title:"Update Needed",text:f,confirmButtonText:"Sign In"}).catch((function(){a.unlockAndResolve(s,{error:{}}),p=!0})));case 30:if(!p){u.next=32;break}return u.abrupt("return");case 32:if(O.supportsPasswordDerivationCost(c.pw_cost)){u.next=36;break}return a.unlockAndResolve(s,{error:{message:"Your account was created on a platform with higher security capabilities than this browser supports. If we attempted to generate your login keys here, it would take hours. Please use a browser with more up to date security capabilities, like Google Chrome or Firefox, to log in."}}),u.abrupt("return");case 36:if(y=O.costMinimumForVersion(c.version),!(c.pw_cost<y)){u.next=41;break}return a.unlockAndResolve(s,{error:{message:"Unable to login due to insecure password parameters. Please visit standardnotes.org/help/security for more information."}}),u.abrupt("return");case 41:if(!o){u.next=47;break}if(h=O.version(),c.version===h){u.next=47;break}return d="Strict sign in refused server sign in parameters. The latest security version is ".concat(h,", but your account is reported to have version ").concat(c.version,". If you'd like to proceed with sign in anyway, please disable strict sign in and try again."),a.unlockAndResolve(s,{error:{message:d}}),u.abrupt("return");case 47:return u.next=49,regeneratorRuntime.awrap(O.computeEncryptionKeysForUser(r,c));case 49:v=u.sent,m=t+"/auth/sign_in",(g=q()({password:v.pw,email:n},i)).api=zt.getApiVersion(),a.httpManager.postAbsolute(m,g,(function(r){return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,regeneratorRuntime.awrap(a.handleAuthResponse(r,n,t,c,v));case 2:a.notifyEvent(e.DidSignInEvent),a.$timeout((function(){return a.unlockAndResolve(s,r)}));case 4:case"end":return o.stop()}}))}),(function(e){console.error("Error logging in",e),"object"!==Gt(e)&&(e={error:{message:"A server error occurred while trying to sign in. Please try again."}}),a.$timeout((function(){return a.unlockAndResolve(s,e)}))}));case 54:case"end":return u.stop()}}))})));case 1:case"end":return s.stop()}}))}},{key:"register",value:function(e,t,n){var r=this;return new Promise((function(o,i){var a,s,u,c,l,f;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!r.isLocked()){i.next=3;break}return o({error:{message:"Register already in progress."}}),i.abrupt("return");case 3:if(!(n.length<8)){i.next=7;break}return a="Your password must be at least ".concat(8," characters in length. For your security, please choose a longer password or, ideally, a passphrase, and try again."),o({error:{message:a}}),i.abrupt("return");case 7:return r.lock(),i.next=10,regeneratorRuntime.awrap(O.generateInitialKeysAndAuthParamsForUser(t,n));case 10:s=i.sent,u=s.keys,c=s.authParams,l=e+"/auth",(f=q()({password:u.pw,email:t},c)).api=zt.getApiVersion(),r.httpManager.postAbsolute(l,f,(function(n){return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(r.handleAuthResponse(n,t,e,c,u));case 2:r.unlockAndResolve(o,n);case 3:case"end":return i.stop()}}))}),(function(e){console.error("Registration error",e),"object"!==Gt(e)&&(e={error:{message:"A server error occurred while trying to register. Please try again."}}),r.unlockAndResolve(o,e)}));case 17:case"end":return i.stop()}}))}))}},{key:"changePassword",value:function(e,t,n,r,o){var i=this;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise((function(a,s){var u,c,l;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!i.isLocked()){s.next=3;break}return a({error:{message:"Change password already in progress."}}),s.abrupt("return");case 3:i.lock(),u=r.pw,c=e+"/auth/change_pw",(l=q()({new_password:u,current_password:n},o)).api=zt.getApiVersion(),i.httpManager.postAuthenticatedAbsolute(c,l,(function(e){return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(i.handleAuthResponse(e,t,null,o,r));case 2:i.unlockAndResolve(a,e);case 3:case"end":return n.stop()}}))}),(function(e){"object"!==Gt(e)&&(e={error:{message:"Something went wrong while changing your password. Your password was not changed. Please try again."}}),i.unlockAndResolve(a,e)}));case 9:case"end":return s.stop()}}))})));case 1:case"end":return a.stop()}}))}},{key:"handleAuthResponse",value:function(e,t,n,r,o){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=3;break}return t.next=3,regeneratorRuntime.awrap(this.storageManager.setItem("server",n));case 3:return this._authParams=r,t.next=6,regeneratorRuntime.awrap(this.storageManager.setItem("auth_params",JSON.stringify(r)));case 6:return t.next=8,regeneratorRuntime.awrap(this.storageManager.setItem("jwt",e.token));case 8:return t.abrupt("return",this.saveKeys(o));case 9:case"end":return t.stop()}}),null,this)}}])&&Qt(t.prototype,n),r&&Qt(t,r),e}();function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var en=function(){function e(t,n,r,o){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modelManager=t,this.syncManager=n,this.storageManager=r,this.completionHandlers=[],this.loadMigrations();var a=!1,s=o.addEventHandler((function(e){e==Yt.DidSignInEvent&&(a=!0)}));this.receivedLocalDataEvent=n.initialDataLoaded(),this.syncManager.addEventHandler((function(e,t){var n,r,u,c,l,f,p,y,h;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="sync:completed"==e,!(n="local-data-loaded"==e)&&!r){t.next=40;break}if(n?i.receivedLocalDataEvent=!0:r&&(i.receivedSyncCompletedEvent=!0),!i.receivedLocalDataEvent||!i.receivedSyncCompletedEvent){t.next=40;break}if(!a){t.next=39;break}return a=!1,o.removeEventHandler(s),t.next=10,regeneratorRuntime.awrap(i.getCompletedMigrations());case 10:u=t.sent.slice(),c=!0,l=!1,f=void 0,t.prev=14,p=u[Symbol.iterator]();case 16:if(c=(y=p.next()).done){t.next=25;break}return h=y.value,t.next=20,regeneratorRuntime.awrap(i.migrationForEncodedName(h));case 20:t.sent.runOnlyOnce||Le()(i._completed,h);case 22:c=!0,t.next=16;break;case 25:t.next=31;break;case 27:t.prev=27,t.t0=t.catch(14),l=!0,f=t.t0;case 31:t.prev=31,t.prev=32,c||null==p.return||p.return();case 34:if(t.prev=34,!l){t.next=37;break}throw f;case 37:return t.finish(34);case 38:return t.finish(31);case 39:i.runPendingMigrations();case 40:case"end":return t.stop()}}),null,null,[[14,27,31,39],[32,,34,38]])}))}var t,n,r;return t=e,(n=[{key:"addCompletionHandler",value:function(e){this.completionHandlers.push(e)}},{key:"removeCompletionHandler",value:function(e){Le()(this.completionHandlers,e)}},{key:"migrationForEncodedName",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.decode(e));case 2:return t=n.sent,n.abrupt("return",this.migrations.find((function(e){return e.name==t})));case 4:case"end":return n.stop()}}),null,this)}},{key:"loadMigrations",value:function(){this.migrations=this.registeredMigrations()}},{key:"registeredMigrations",value:function(){}},{key:"runPendingMigrations",value:function(){var e,t,n,r,o,i,a,s,u,c,l,f,p,y,h,d,v,m,g,b,x,S,k,w,_,R,I,O;return regeneratorRuntime.async((function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,regeneratorRuntime.awrap(this.getPendingMigrations());case 2:for(e=C.sent,t=!0,n=!1,r=void 0,C.prev=6,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)(a=i.value).items=[];C.next=14;break;case 10:C.prev=10,C.t0=C.catch(6),n=!0,r=C.t0;case 14:C.prev=14,C.prev=15,t||null==o.return||o.return();case 17:if(C.prev=17,!n){C.next=20;break}throw r;case 20:return C.finish(17);case 21:return C.finish(14);case 22:s=!0,u=!1,c=void 0,C.prev=25,l=this.modelManager.allNondummyItems[Symbol.iterator]();case 27:if(s=(f=l.next()).done){C.next=51;break}for(p=f.value,y=!0,h=!1,d=void 0,C.prev=32,v=e[Symbol.iterator]();!(y=(m=v.next()).done);y=!0)a=m.value,p.content_type==a.content_type&&a.items.push(p);C.next=40;break;case 36:C.prev=36,C.t1=C.catch(32),h=!0,d=C.t1;case 40:C.prev=40,C.prev=41,y||null==v.return||v.return();case 43:if(C.prev=43,!h){C.next=46;break}throw d;case 46:return C.finish(43);case 47:return C.finish(40);case 48:s=!0,C.next=27;break;case 51:C.next=57;break;case 53:C.prev=53,C.t2=C.catch(25),u=!0,c=C.t2;case 57:C.prev=57,C.prev=58,s||null==l.return||l.return();case 60:if(C.prev=60,!u){C.next=63;break}throw c;case 63:return C.finish(60);case 64:return C.finish(57);case 65:g=!0,b=!1,x=void 0,C.prev=68,S=e[Symbol.iterator]();case 70:if(g=(k=S.next()).done){C.next=81;break}if(!((a=k.value).items&&a.items.length>0||a.customHandler)){C.next=77;break}return C.next=75,regeneratorRuntime.awrap(this.runMigration(a,a.items));case 75:C.next=78;break;case 77:this.markMigrationCompleted(a);case 78:g=!0,C.next=70;break;case 81:C.next=87;break;case 83:C.prev=83,C.t3=C.catch(68),b=!0,x=C.t3;case 87:C.prev=87,C.prev=88,g||null==S.return||S.return();case 90:if(C.prev=90,!b){C.next=93;break}throw x;case 93:return C.finish(90);case 94:return C.finish(87);case 95:for(w=!0,_=!1,R=void 0,C.prev=98,I=this.completionHandlers[Symbol.iterator]();!(w=(O=I.next()).done);w=!0)(0,O.value)();C.next=106;break;case 102:C.prev=102,C.t4=C.catch(98),_=!0,R=C.t4;case 106:C.prev=106,C.prev=107,w||null==I.return||I.return();case 109:if(C.prev=109,!_){C.next=112;break}throw R;case 112:return C.finish(109);case 113:return C.finish(106);case 114:case"end":return C.stop()}}),null,this,[[6,10,14,22],[15,,17,21],[25,53,57,65],[32,36,40,48],[41,,43,47],[58,,60,64],[68,83,87,95],[88,,90,94],[98,102,106,114],[107,,109,113]])}},{key:"encode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",window.btoa(e));case 1:case"end":return t.stop()}}))}},{key:"decode",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",window.atob(e));case 1:case"end":return t.stop()}}))}},{key:"getCompletedMigrations",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._completed){t.next=5;break}return t.next=3,regeneratorRuntime.awrap(this.storageManager.getItem("migrations"));case 3:e=t.sent,this._completed=e?JSON.parse(e):[];case 5:return t.abrupt("return",this._completed);case 6:case"end":return t.stop()}}),null,this)}},{key:"getPendingMigrations",value:function(){var e,t,n,r,o,i,a,s;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,regeneratorRuntime.awrap(this.getCompletedMigrations());case 2:e=u.sent,t=[],n=!0,r=!1,o=void 0,u.prev=7,i=this.migrations[Symbol.iterator]();case 9:if(n=(a=i.next()).done){u.next=22;break}return s=a.value,u.t0=e,u.next=14,regeneratorRuntime.awrap(this.encode(s.name));case 14:if(u.t1=u.sent,u.t2=u.t0.indexOf.call(u.t0,u.t1),u.t3=-1,u.t2!=u.t3){u.next=19;break}t.push(s);case 19:n=!0,u.next=9;break;case 22:u.next=28;break;case 24:u.prev=24,u.t4=u.catch(7),r=!0,o=u.t4;case 28:u.prev=28,u.prev=29,n||null==i.return||i.return();case 31:if(u.prev=31,!r){u.next=34;break}throw o;case 34:return u.finish(31);case 35:return u.finish(28);case 36:return u.abrupt("return",t);case 37:case"end":return u.stop()}}),null,this,[[7,24,28,36],[29,,31,35]])}},{key:"markMigrationCompleted",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.getCompletedMigrations());case 2:return t=n.sent,n.t0=t,n.next=6,regeneratorRuntime.awrap(this.encode(e.name));case 6:n.t1=n.sent,n.t0.push.call(n.t0,n.t1),this.storageManager.setItem("migrations",JSON.stringify(t)),e.running=!1;case 10:case"end":return n.stop()}}),null,this)}},{key:"runMigration",value:function(e,t){var n=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.running){r.next=2;break}return r.abrupt("return");case 2:if(console.log("Running migration:",e.name),e.running=!0,!e.customHandler){r.next=8;break}return r.abrupt("return",e.customHandler().then((function(){n.markMigrationCompleted(e)})));case 8:return r.abrupt("return",e.handler(t).then((function(){n.markMigrationCompleted(e)})));case 9:case"end":return r.stop()}}))}}])&&Zt(t.prototype,n),r&&Zt(t,r),e}();function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nn=function(){function e(t,n,r,o,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modelManager=t,this.storageManager=n,this.$timeout=i||setTimeout.bind(window),this.keyRequestHandler=r,this.loadFromDisk().then((function(){a.modelManager.addItemSyncObserver("session-history",o,(function(e,t,n,r,o){if(r!==Ct.MappingSourceLocalDirtied){var i=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;try{a.addHistoryEntryForItem(f)}catch(e){console.log("Caught exception while trying to add item history entry",e)}}}catch(e){s=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(s)throw u}}}}))}))}var t,n,r;return t=e,(n=[{key:"encryptionParams",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.keyRequestHandler());case 1:case"end":return e.stop()}}),null,this)}},{key:"addHistoryEntryForItem",value:function(e){var t=this,n={uuid:e.uuid,content_type:e.content_type,updated_at:e.updated_at,content:e.getContentCopy()},r=this.historySession.addEntryForItem(n);this.autoOptimize&&this.historySession.optimizeHistoryForItem(e),r&&this.diskEnabled&&(this.diskTimeout&&(this.$timeout.hasOwnProperty("cancel")?this.$timeout.cancel(this.diskTimeout):clearTimeout(this.diskTimeout)),this.diskTimeout=this.$timeout((function(){t.saveToDisk()}),2e3))}},{key:"historyForItem",value:function(e){return this.historySession.historyForItem(e)}},{key:"clearHistoryForItem",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.historySession.clearItemHistory(e),t.abrupt("return",this.saveToDisk());case 2:case"end":return t.stop()}}),null,this)}},{key:"clearAllHistory",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.historySession.clearAllHistory(),e.abrupt("return",this.storageManager.removeItem("sessionHistory_revisions"));case 2:case"end":return e.stop()}}),null,this)}},{key:"toggleDiskSaving",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.diskEnabled=!this.diskEnabled,!this.diskEnabled){e.next=6;break}this.storageManager.setItem("sessionHistory_persist",JSON.stringify(!0)),this.saveToDisk(),e.next=8;break;case 6:return this.storageManager.setItem("sessionHistory_persist",JSON.stringify(!1)),e.abrupt("return",this.storageManager.removeItem("sessionHistory_revisions"));case 8:case"end":return e.stop()}}),null,this)}},{key:"saveToDisk",value:function(){var e,t=this;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.diskEnabled){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,regeneratorRuntime.awrap(this.encryptionParams());case 4:e=n.sent,new X(this.historySession,e.keys,e.auth_params).paramsForSync().then((function(e){t.storageManager.setItem("sessionHistory_revisions",JSON.stringify(e))}));case 7:case"end":return n.stop()}}),null,this)}},{key:"loadFromDisk",value:function(){var e,t,n,r,o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(this.storageManager.getItem("sessionHistory_persist"));case 2:return(e=i.sent)&&(this.diskEnabled=JSON.parse(e)),i.next=6,regeneratorRuntime.awrap(this.storageManager.getItem("sessionHistory_revisions"));case 6:if(!(t=i.sent)){i.next=18;break}return t=JSON.parse(t),i.next=11,regeneratorRuntime.awrap(this.encryptionParams());case 11:return n=i.sent,i.next=14,regeneratorRuntime.awrap(O.decryptItem(t,n.keys));case 14:r=new Nt(t),this.historySession=r,i.next=19;break;case 18:this.historySession=new Nt;case 19:return i.next=21,regeneratorRuntime.awrap(this.storageManager.getItem("sessionHistory_autoOptimize"));case 21:o=i.sent,this.autoOptimize=!o||JSON.parse(o);case 23:case"end":return i.stop()}}),null,this)}},{key:"toggleAutoOptimize",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:this.autoOptimize=!this.autoOptimize,this.autoOptimize?this.storageManager.setItem("sessionHistory_autoOptimize",JSON.stringify(!0)):this.storageManager.setItem("sessionHistory_autoOptimize",JSON.stringify(!1));case 2:case"end":return e.stop()}}),null,this)}}])&&tn(t.prototype,n),r&&tn(t,r),e}();function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var on=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modelManager=t,this.syncManager=n,this.singletonManager=r,this.loadPrivileges(),e.CredentialAccountPassword="CredentialAccountPassword",e.CredentialLocalPasscode="CredentialLocalPasscode",e.ActionManageExtensions="ActionManageExtensions",e.ActionManageBackups="ActionManageBackups",e.ActionViewProtectedNotes="ActionViewProtectedNotes",e.ActionManagePrivileges="ActionManagePrivileges",e.ActionManagePasscode="ActionManagePasscode",e.ActionDeleteNote="ActionDeleteNote",e.SessionExpiresAtKey="SessionExpiresAtKey",e.SessionLengthKey="SessionLengthKey",e.SessionLengthNone=0,e.SessionLengthFiveMinutes=300,e.SessionLengthOneHour=3600,e.SessionLengthOneWeek=604800,this.availableActions=[e.ActionViewProtectedNotes,e.ActionDeleteNote,e.ActionManagePasscode,e.ActionManageBackups,e.ActionManageExtensions,e.ActionManagePrivileges],this.availableCredentials=[e.CredentialAccountPassword,e.CredentialLocalPasscode],this.sessionLengths=[e.SessionLengthNone,e.SessionLengthFiveMinutes,e.SessionLengthOneHour,e.SessionLengthOneWeek,e.SessionLengthIndefinite]}var t,n,r;return t=e,(n=[{key:"setDelegate",value:function(e){this.delegate=e}},{key:"getAvailableActions",value:function(){return this.availableActions}},{key:"getAvailableCredentials",value:function(){return this.availableCredentials}},{key:"netCredentialsForAction",value:function(t){var n,r,o,i,a,s,u,c;return regeneratorRuntime.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,regeneratorRuntime.awrap(this.getPrivileges());case 2:l.t0=t,n=l.sent.getCredentialsForAction(l.t0),r=[],o=!0,i=!1,a=void 0,l.prev=8,s=n[Symbol.iterator]();case 10:if(o=(u=s.next()).done){l.next=27;break}if((c=u.value)!=e.CredentialAccountPassword){l.next=19;break}return l.next=15,regeneratorRuntime.awrap(this.delegate.isOffline());case 15:l.sent||r.push(c),l.next=24;break;case 19:if(c!=e.CredentialLocalPasscode){l.next=24;break}return l.next=22,regeneratorRuntime.awrap(this.delegate.hasLocalPasscode());case 22:l.sent&&r.push(c);case 24:o=!0,l.next=10;break;case 27:l.next=33;break;case 29:l.prev=29,l.t1=l.catch(8),i=!0,a=l.t1;case 33:l.prev=33,l.prev=34,o||null==s.return||s.return();case 36:if(l.prev=36,!i){l.next=39;break}throw a;case 39:return l.finish(36);case 40:return l.finish(33);case 41:return l.abrupt("return",r);case 42:case"end":return l.stop()}}),null,this,[[8,29,33,41],[34,,36,40]])}},{key:"loadPrivileges",value:function(){var e=this;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loadPromise){t.next=2;break}return t.abrupt("return",this.loadPromise);case 2:return this.loadPromise=new Promise((function(t,n){var r=Rt.contentType(),o=new H("content_type","=",r);e.singletonManager.registerSingleton([o],(function(n){e.privileges=n,t(n)}),(function(n){var o;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=new Rt({content_type:r}),!Object(_.c)()&&O.crypto.generateUUIDSync){i.next=4;break}return i.next=4,regeneratorRuntime.awrap(o.initUUID());case 4:e.modelManager.addItem(o),e.modelManager.setItemDirty(o,!0),e.syncManager.sync(),n(o),t(o);case 9:case"end":return i.stop()}}))}))})),t.abrupt("return",this.loadPromise);case 4:case"end":return t.stop()}}),null,this)}},{key:"getPrivileges",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.privileges){e.next=4;break}return e.abrupt("return",this.privileges);case 4:return e.abrupt("return",this.loadPrivileges());case 5:case"end":return e.stop()}}),null,this)}},{key:"displayInfoForCredential",value:function(t){var n={};return n[e.CredentialAccountPassword]={label:"Account Password",prompt:"Please enter your account password."},n[e.CredentialLocalPasscode]={label:"Local Passcode",prompt:"Please enter your local passcode."},n[t]}},{key:"displayInfoForAction",value:function(t){var n={};return n[e.ActionManageExtensions]={label:"Manage Extensions"},n[e.ActionManageBackups]={label:"Download/Import Backups"},n[e.ActionViewProtectedNotes]={label:"View Protected Notes"},n[e.ActionManagePrivileges]={label:"Manage Privileges"},n[e.ActionManagePasscode]={label:"Manage Passcode"},n[e.ActionDeleteNote]={label:"Delete Notes"},n[t]}},{key:"getSessionLengthOptions",value:function(){return[{value:e.SessionLengthNone,label:"Don't Remember"},{value:e.SessionLengthFiveMinutes,label:"5 Minutes"},{value:e.SessionLengthOneHour,label:"1 Hour"},{value:e.SessionLengthOneWeek,label:"1 Week"}]}},{key:"setSessionLength",value:function(t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t,i=void 0,(i=new Date).setSeconds(i.getSeconds()+o),n=i,r.abrupt("return",Promise.all([this.delegate.saveToStorage(e.SessionExpiresAtKey,JSON.stringify(n)),this.delegate.saveToStorage(e.SessionLengthKey,JSON.stringify(t))]));case 3:case"end":return r.stop()}var o,i}),null,this)}},{key:"clearSession",value:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.setSessionLength(e.SessionLengthNone));case 1:case"end":return t.stop()}}),null,this)}},{key:"getSelectedSessionLength",value:function(){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.delegate.getFromStorage(e.SessionLengthKey));case 2:if(!(t=n.sent)){n.next=7;break}return n.abrupt("return",JSON.parse(t));case 7:return n.abrupt("return",e.SessionLengthNone);case 8:case"end":return n.stop()}}),null,this)}},{key:"getSessionExpirey",value:function(){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.delegate.getFromStorage(e.SessionExpiresAtKey));case 2:if(!(t=n.sent)){n.next=7;break}return n.abrupt("return",new Date(JSON.parse(t)));case 7:return n.abrupt("return",new Date);case 8:case"end":return n.stop()}}),null,this)}},{key:"actionHasPrivilegesConfigured",value:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.netCredentialsForAction(e));case 2:return t.t0=t.sent.length,t.abrupt("return",t.t0>0);case 4:case"end":return t.stop()}}),null,this)}},{key:"actionRequiresPrivilege",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.getSessionExpirey());case 2:if(!(n.sent>new Date)){n.next=5;break}return n.abrupt("return",!1);case 5:return n.next=7,regeneratorRuntime.awrap(this.netCredentialsForAction(e));case 7:return t=n.sent,n.abrupt("return",t.length>0);case 9:case"end":return n.stop()}}),null,this)}},{key:"savePrivileges",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.getPrivileges());case 2:e=t.sent,this.modelManager.setItemDirty(e,!0),this.syncManager.sync();case 5:case"end":return t.stop()}}),null,this)}},{key:"authenticateAction",value:function(e,t){var n,r,o,i,a,s,u,c,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,regeneratorRuntime.awrap(this.netCredentialsForAction(e));case 2:n=f.sent,r=[],o=[],i=!0,a=!1,s=void 0,f.prev=7,u=n[Symbol.iterator]();case 9:if(i=(c=u.next()).done){f.next=18;break}return l=c.value,f.next=13,regeneratorRuntime.awrap(this._verifyAuthenticationParameters(l,t[l]));case 13:f.sent?r.push(l):o.push(l);case 15:i=!0,f.next=9;break;case 18:f.next=24;break;case 20:f.prev=20,f.t0=f.catch(7),a=!0,s=f.t0;case 24:f.prev=24,f.prev=25,i||null==u.return||u.return();case 27:if(f.prev=27,!a){f.next=30;break}throw s;case 30:return f.finish(27);case 31:return f.finish(24);case 32:return f.abrupt("return",{success:0==o.length,successfulCredentials:r,failedCredentials:o});case 33:case"end":return f.stop()}}),null,this,[[7,20,24,32],[25,,27,31]])}},{key:"_verifyAuthenticationParameters",value:function(t,n){var r,o,i=this;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.delegate.verifyAccountPassword(e));case 1:case"end":return t.stop()}}))},o=function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.delegate.verifyLocalPasscode(e));case 1:case"end":return t.stop()}}))},t!=e.CredentialAccountPassword){a.next=6;break}return a.abrupt("return",r(n));case 6:if(t!=e.CredentialLocalPasscode){a.next=8;break}return a.abrupt("return",o(n));case 8:case"end":return a.stop()}}))}}])&&rn(t.prototype,n),r&&rn(t,r),e}();function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sn=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncManager=n,this.modelManager=t,this.singletonHandlers=[],t.addItemSyncObserverWithPriority({id:"sf-singleton-manager",types:"*",priority:-1,callback:function(e,n,o,i,a){i!==Ct.MappingSourceLocalDirtied&&r.resolveSingletons(t.allNondummyItems,!0)}}),n.addEventHandler((function(e,n){if("local-data-loaded"==e)r.resolveSingletons(t.allNondummyItems,!0),r.initialDataLoaded=!0;else if("sync:completed"==e){if(!r.initialDataLoaded)return;r.resolveSingletons(n.retrievedItems)}})),t.addModelUuidChangeObserver("singleton-manager",(function(e,t){var n=!0,o=!1,i=void 0;try{for(var a,s=r.singletonHandlers[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;u.singleton&&H.ItemSatisfiesPredicates(t,u.predicates)&&(u.singleton=null,r.resolveSingletons([t]))}}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}}))}var t,n,r;return t=e,(n=[{key:"registerSingleton",value:function(e,t,n){this.singletonHandlers.push({predicates:e,resolutionCallback:t,createBlock:n})}},{key:"resolveSingletons",value:function(e,t){var n=this;e=e||[];var r=!0,o=!1,i=void 0;try{for(var a,s=function(){var r=a.value,o=r.predicates.slice(),i=function(){r.createBlock&&(r.pendingCreateBlockCallback=!0,r.createBlock((function(e){r.singleton=e,r.pendingCreateBlockCallback=!1,r.resolutionCallback&&r.resolutionCallback(e)})))};if(n.modelManager.filterItemsWithPredicates(e,o).length>0){var s=n.modelManager.itemsMatchingPredicates(o);if(s.length>=2){var u=s.sort((function(e,t){return e.errorDecrypting?1:t.errorDecrypting?-1:e.created_at<t.created_at?-1:1})),c=u[0],l=u.slice(1,u.length),f=!0,p=!1,y=void 0;try{for(var h,d=l[Symbol.iterator]();!(f=(h=d.next()).done);f=!0){var v=h.value;n.modelManager.setItemToBeDeleted(v)}}catch(e){p=!0,y=e}finally{try{f||null==d.return||d.return()}finally{if(p)throw y}}n.syncManager.sync(),r.singleton=c,r.resolutionCallback&&r.resolutionCallback(c)}else if(1==s.length){var m=s[0];m.errorDecrypting?(n.modelManager.setItemToBeDeleted(m),i()):r.singleton&&r.singleton===m||(r.singleton=m,r.resolutionCallback&&r.resolutionCallback(m))}}else r.singleton||t||r.pendingCreateBlockCallback||i()},u=this.singletonHandlers[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)s()}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}}}])&&an(t.prototype,n),r&&an(t,r),e}();n.d(t,"SNProtocolManager",(function(){return I})),n.d(t,"protocolManager",(function(){return O})),n.d(t,"SFItem",(function(){return U})),n.d(t,"SFItemParams",(function(){return X})),n.d(t,"SFPredicate",(function(){return H})),n.d(t,"SNNote",(function(){return ce})),n.d(t,"SNTag",(function(){return ne})),n.d(t,"SNSmartTag",(function(){return de})),n.d(t,"SNMfa",(function(){return Se})),n.d(t,"SNServerExtension",(function(){return Ce})),n.d(t,"SNComponent",(function(){return Ee})),n.d(t,"SNEditor",(function(){return Je})),n.d(t,"SNExtension",(function(){return tt})),n.d(t,"Action",(function(){return et})),n.d(t,"SNTheme",(function(){return st})),n.d(t,"SNEncryptedStorage",(function(){return ht})),n.d(t,"SNComponentManager",(function(){return Dt})),n.d(t,"SFHistorySession",(function(){return Nt})),n.d(t,"SFItemHistory",(function(){return Tt})),n.d(t,"SFItemHistoryEntry",(function(){return jt})),n.d(t,"SFPrivileges",(function(){return Rt})),n.d(t,"SNWebCrypto",(function(){return r.SNWebCrypto})),n.d(t,"SNCryptoJS",(function(){return r.SNCryptoJS})),n.d(t,"SNReactNativeCrypto",(function(){return r.SNReactNativeCrypto})),n.d(t,"findInArray",(function(){return _.a})),n.d(t,"SFModelManager",(function(){return Ct})),n.d(t,"SFHttpManager",(function(){return zt})),n.d(t,"SFStorageManager",(function(){return qt})),n.d(t,"SFSyncManager",(function(){return Vt})),n.d(t,"SFAuthManager",(function(){return Yt})),n.d(t,"SFMigrationManager",(function(){return en})),n.d(t,"SFAlertManager",(function(){return Xt})),n.d(t,"SFSessionHistoryManager",(function(){return nn})),n.d(t,"SFPrivilegesManager",(function(){return on})),n.d(t,"SFSingletonManager",(function(){return sn}))}])}));
//# sourceMappingURL=snjs.min.js.map